% Generated by Sphinx.
\def\sphinxdocclass{report}
\newif\ifsphinxKeepOldNames \sphinxKeepOldNamestrue
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\usepackage{iftex}

\ifPDFTeX
  \usepackage[utf8]{inputenc}
\fi
\ifdefined\DeclareUnicodeCharacter
  \DeclareUnicodeCharacter{00A0}{\nobreakspace}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage{longtable}
\usepackage{sphinx}
\usepackage{multirow}
\usepackage{eqparbox}


\addto\captionsenglish{\renewcommand{\figurename}{Fig.\@ }}
\addto\captionsenglish{\renewcommand{\tablename}{Table }}
\SetupFloatingEnvironment{literal-block}{name=Listing }

\addto\extrasenglish{\def\pageautorefname{page}}

\setcounter{tocdepth}{1}


\title{Soprano Documentation}
\date{Apr 17, 2018}
\release{beta (Boggess)}
\author{Simone Sturniolo}
\newcommand{\sphinxlogo}{}
\renewcommand{\releasename}{Release}
\makeindex

\makeatletter
\def\PYG@reset{\let\PYG@it=\relax \let\PYG@bf=\relax%
    \let\PYG@ul=\relax \let\PYG@tc=\relax%
    \let\PYG@bc=\relax \let\PYG@ff=\relax}
\def\PYG@tok#1{\csname PYG@tok@#1\endcsname}
\def\PYG@toks#1+{\ifx\relax#1\empty\else%
    \PYG@tok{#1}\expandafter\PYG@toks\fi}
\def\PYG@do#1{\PYG@bc{\PYG@tc{\PYG@ul{%
    \PYG@it{\PYG@bf{\PYG@ff{#1}}}}}}}
\def\PYG#1#2{\PYG@reset\PYG@toks#1+\relax+\PYG@do{#2}}

\expandafter\def\csname PYG@tok@gd\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PYG@tok@gu\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PYG@tok@gt\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PYG@tok@gs\endcsname{\let\PYG@bf=\textbf}
\expandafter\def\csname PYG@tok@gr\endcsname{\def\PYG@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PYG@tok@cm\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@vg\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@vi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@vm\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@mh\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@cs\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}\def\PYG@bc##1{\setlength{\fboxsep}{0pt}\colorbox[rgb]{1.00,0.94,0.94}{\strut ##1}}}
\expandafter\def\csname PYG@tok@ge\endcsname{\let\PYG@it=\textit}
\expandafter\def\csname PYG@tok@vc\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@il\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@go\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.20,0.20,0.20}{##1}}}
\expandafter\def\csname PYG@tok@cp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@gi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PYG@tok@gh\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PYG@tok@ni\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.84,0.33,0.22}{##1}}}
\expandafter\def\csname PYG@tok@nl\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.13,0.44}{##1}}}
\expandafter\def\csname PYG@tok@nn\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.05,0.52,0.71}{##1}}}
\expandafter\def\csname PYG@tok@no\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.38,0.68,0.84}{##1}}}
\expandafter\def\csname PYG@tok@na\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@nb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@nc\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.05,0.52,0.71}{##1}}}
\expandafter\def\csname PYG@tok@nd\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.33,0.33,0.33}{##1}}}
\expandafter\def\csname PYG@tok@ne\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@nf\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.02,0.16,0.49}{##1}}}
\expandafter\def\csname PYG@tok@si\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.44,0.63,0.82}{##1}}}
\expandafter\def\csname PYG@tok@s2\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@nt\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.02,0.16,0.45}{##1}}}
\expandafter\def\csname PYG@tok@nv\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@s1\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@dl\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@ch\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@m\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@gp\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.78,0.36,0.04}{##1}}}
\expandafter\def\csname PYG@tok@sh\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@ow\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@sx\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.78,0.36,0.04}{##1}}}
\expandafter\def\csname PYG@tok@bp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@c1\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@fm\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.02,0.16,0.49}{##1}}}
\expandafter\def\csname PYG@tok@o\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PYG@tok@kc\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@c\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@mf\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@err\endcsname{\def\PYG@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PYG@tok@mb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@ss\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.32,0.47,0.09}{##1}}}
\expandafter\def\csname PYG@tok@sr\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.14,0.33,0.53}{##1}}}
\expandafter\def\csname PYG@tok@mo\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@kd\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@mi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@kn\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@cpf\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@kr\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@s\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@kp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@w\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PYG@tok@kt\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.56,0.13,0.00}{##1}}}
\expandafter\def\csname PYG@tok@sc\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@sb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@sa\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@k\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@se\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@sd\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}

\def\PYGZbs{\char`\\}
\def\PYGZus{\char`\_}
\def\PYGZob{\char`\{}
\def\PYGZcb{\char`\}}
\def\PYGZca{\char`\^}
\def\PYGZam{\char`\&}
\def\PYGZlt{\char`\<}
\def\PYGZgt{\char`\>}
\def\PYGZsh{\char`\#}
\def\PYGZpc{\char`\%}
\def\PYGZdl{\char`\$}
\def\PYGZhy{\char`\-}
\def\PYGZsq{\char`\'}
\def\PYGZdq{\char`\"}
\def\PYGZti{\char`\~}
% for compatibility with earlier versions
\def\PYGZat{@}
\def\PYGZlb{[}
\def\PYGZrb{]}
\makeatother

\renewcommand\PYGZsq{\textquotesingle}

\begin{document}

\maketitle
\tableofcontents
\phantomsection\label{index::doc}


Contents:


\chapter{soprano}
\label{doctree/modules:welcome-to-soprano-s-documentation-release-release}\label{doctree/modules:soprano}\label{doctree/modules::doc}

\section{soprano package}
\label{doctree/soprano:module-soprano}\label{doctree/soprano::doc}\label{doctree/soprano:soprano-package}\index{soprano (module)}
Soprano 0.7.1

A Python library to crack crystals
by Simone Sturniolo

Copyright (C) 2016 - Science and Technology Facility Council

Soprano is free software: you can redistribute it and/or modify
it under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

Soprano is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public License
along with this program.  If not, see \textless{}\url{http://www.gnu.org/licenses/}\textgreater{}.


\subsection{Subpackages}
\label{doctree/soprano:subpackages}

\subsubsection{soprano.analyse package}
\label{doctree/soprano.analyse:module-soprano.analyse}\label{doctree/soprano.analyse:soprano-analyse-package}\label{doctree/soprano.analyse::doc}\index{soprano.analyse (module)}
Contains all modules, classes and functions relevant
to analysing collections after calculations have been performed.


\paragraph{Subpackages}
\label{doctree/soprano.analyse:subpackages}

\subparagraph{soprano.analyse.phylogen package}
\label{doctree/soprano.analyse.phylogen::doc}\label{doctree/soprano.analyse.phylogen:soprano-analyse-phylogen-package}\label{doctree/soprano.analyse.phylogen:module-soprano.analyse.phylogen}\index{soprano.analyse.phylogen (module)}
Module containing functions and classes for phylogenetic clustering of
collections.


\subparagraph{Submodules}
\label{doctree/soprano.analyse.phylogen:submodules}

\subparagraph{soprano.analyse.phylogen.genes module}
\label{doctree/soprano.analyse.phylogen.genes:soprano-analyse-phylogen-genes-module}\label{doctree/soprano.analyse.phylogen.genes:module-soprano.analyse.phylogen.genes}\label{doctree/soprano.analyse.phylogen.genes::doc}\index{soprano.analyse.phylogen.genes (module)}
Definitions for the various genes used by PhylogenCluster
\index{Gene (class in soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.Gene}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{Gene}}{\emph{name}, \emph{weight=1.0}, \emph{params=\{\}}, \emph{parser=None}, \emph{pair=False}}{}
Bases: \sphinxcode{object}

A description of a property, a `gene', characterizing a structure, to be
used with a PhylogenCluster. A number of default genes is provided, but
custom ones can be created as well by passing a parser. Only default genes
can be used in a .genefile with the phylogen.py script though.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): name of the gene. Must be one of the existing ones or a
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] custom one (in which case a parser must be provided as
\item[] well). Custom names can't conflict with existing ones
\end{DUlineblock}
\item[] weight (float): weight of the gene to be applied, default is 1.0
\item[] params (dict): additional parameters to be passed to the gene parser
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] function; when not specified, defaults will be used
\end{DUlineblock}
\item[] parser (function\textless{}AtomsCollection, **kwargs\textgreater{}
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] =\textgreater{} np.array): parser function to be used when defining custom
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] genes. Must return a two-dimensional Numpy array
\item[] (axis 0 for the elements of the collection,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] axis 1 for the values of the gene)
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\item[] is\_pair (bool): False if the gene returns a multi dimensional point
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] for each structure, True if it only returns pair
\item[] distances. Default is False
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\index{evaluate() (soprano.analyse.phylogen.genes.Gene method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.Gene.evaluate}\pysiglinewithargsret{\sphinxbfcode{evaluate}}{\emph{c}}{}
Evaluate the gene on a given AtomsCollection

\end{fulllineitems}

\index{is\_pair (soprano.analyse.phylogen.genes.Gene attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.Gene.is_pair}\pysigline{\sphinxbfcode{is\_pair}}
Whether the gene can only compare a pair of structures or can also
give an absolute value for each structure individually (required for
k-means clustering)

\end{fulllineitems}


\end{fulllineitems}

\index{GeneDictionary (class in soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.GeneDictionary}\pysigline{\sphinxstrong{class }\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{GeneDictionary}}
Bases: \sphinxcode{object}

Container class holding gene definitions
\index{get\_gene() (soprano.analyse.phylogen.genes.GeneDictionary class method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.GeneDictionary.get_gene}\pysiglinewithargsret{\sphinxstrong{classmethod }\sphinxbfcode{get\_gene}}{\emph{g}}{}
Get the definition for a given gene

\end{fulllineitems}

\index{help() (soprano.analyse.phylogen.genes.GeneDictionary class method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.GeneDictionary.help}\pysiglinewithargsret{\sphinxstrong{classmethod }\sphinxbfcode{help}}{\emph{g=None}}{}
Get an help string for a given gene

\end{fulllineitems}


\end{fulllineitems}

\index{GeneError}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.GeneError}\pysigline{\sphinxstrong{exception }\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{GeneError}}
Bases: \sphinxcode{exceptions.Exception}

\end{fulllineitems}

\index{load\_genefile() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.load_genefile}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{load\_genefile}}{\emph{gfile}}{}
Load a gene file and return the (validated) list of genes contained
within.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] gfile (file or str): file to parse
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] genelist: a list of genes parsed from the given file, ready to be
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] passed to a PhylogenCluster
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{parsegene\_bond\_order() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_bond_order}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_bond\_order}}{\emph{c}, \emph{s1=None}, \emph{s2=None}, \emph{channels=10}, \emph{cutoff\_radius=2.0}, \emph{cutoff\_width=0.05}, \emph{mode=u'Q'}}{}
\end{fulllineitems}

\index{parsegene\_coord\_histogram() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_coord_histogram}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_coord\_histogram}}{\emph{c}, \emph{s1=u'C'}, \emph{s2=u'H'}, \emph{max\_coord=6}}{}
\end{fulllineitems}

\index{parsegene\_energy() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_energy}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_energy}}{\emph{c}}{}
\end{fulllineitems}

\index{parsegene\_hbonds\_angle() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_hbonds_angle}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_hbonds\_angle}}{\emph{c}}{}
\end{fulllineitems}

\index{parsegene\_hbonds\_fprint() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_hbonds_fprint}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_hbonds\_fprint}}{\emph{c}}{}
\end{fulllineitems}

\index{parsegene\_hbonds\_length() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_hbonds_length}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_hbonds\_length}}{\emph{c}}{}
\end{fulllineitems}

\index{parsegene\_hbonds\_site\_compare() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_hbonds_site_compare}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_hbonds\_site\_compare}}{\emph{c}}{}
\end{fulllineitems}

\index{parsegene\_hbonds\_site\_reference() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_hbonds_site_reference}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_hbonds\_site\_reference}}{\emph{c}, \emph{ref=None}}{}
\end{fulllineitems}

\index{parsegene\_hbonds\_totn() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_hbonds_totn}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_hbonds\_totn}}{\emph{c}}{}
\end{fulllineitems}

\index{parsegene\_latt\_abc() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_latt_abc}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_latt\_abc}}{\emph{c}}{}
\end{fulllineitems}

\index{parsegene\_latt\_ang() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_latt_ang}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_latt\_ang}}{\emph{c}}{}
\end{fulllineitems}

\index{parsegene\_latt\_cart() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_latt_cart}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_latt\_cart}}{\emph{c}}{}
\end{fulllineitems}

\index{parsegene\_linkage\_list() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_linkage_list}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_linkage\_list}}{\emph{c}, \emph{size=0}}{}
\end{fulllineitems}

\index{parsegene\_mol\_com() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_mol_com}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_mol\_com}}{\emph{c}, \emph{Z=0}}{}
\end{fulllineitems}

\index{parsegene\_mol\_m() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_mol_m}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_mol\_m}}{\emph{c}, \emph{Z=0}}{}
\end{fulllineitems}

\index{parsegene\_mol\_num() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_mol_num}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_mol\_num}}{\emph{c}}{}
\end{fulllineitems}

\index{parsegene\_mol\_rot() (in module soprano.analyse.phylogen.genes)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.genes:soprano.analyse.phylogen.genes.parsegene_mol_rot}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.genes.}\sphinxbfcode{parsegene\_mol\_rot}}{\emph{c}, \emph{Z=0}, \emph{twist\_axis=None}, \emph{swing\_plane=None}}{}
\end{fulllineitems}



\subparagraph{soprano.analyse.phylogen.mapping module}
\label{doctree/soprano.analyse.phylogen.mapping:soprano-analyse-phylogen-mapping-module}\label{doctree/soprano.analyse.phylogen.mapping:module-soprano.analyse.phylogen.mapping}\label{doctree/soprano.analyse.phylogen.mapping::doc}\index{soprano.analyse.phylogen.mapping (module)}
2D mapping algorithms
\index{classcond\_principal\_component() (in module soprano.analyse.phylogen.mapping)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.mapping:soprano.analyse.phylogen.mapping.classcond_principal_component}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.mapping.}\sphinxbfcode{classcond\_principal\_component}}{\emph{p}}{}
\end{fulllineitems}

\index{optimal\_discriminant\_plane() (in module soprano.analyse.phylogen.mapping)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.mapping:soprano.analyse.phylogen.mapping.optimal_discriminant_plane}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.mapping.}\sphinxbfcode{optimal\_discriminant\_plane}}{\emph{p}}{}
\end{fulllineitems}

\index{standard\_classcond\_component() (in module soprano.analyse.phylogen.mapping)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.mapping:soprano.analyse.phylogen.mapping.standard_classcond_component}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.mapping.}\sphinxbfcode{standard\_classcond\_component}}{\emph{p}}{}
\end{fulllineitems}

\index{total\_principal\_component() (in module soprano.analyse.phylogen.mapping)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.mapping:soprano.analyse.phylogen.mapping.total_principal_component}\pysiglinewithargsret{\sphinxcode{soprano.analyse.phylogen.mapping.}\sphinxbfcode{total\_principal\_component}}{\emph{p}}{}
\end{fulllineitems}



\subparagraph{soprano.analyse.phylogen.phylogenclust module}
\label{doctree/soprano.analyse.phylogen.phylogenclust:module-soprano.analyse.phylogen.phylogenclust}\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano-analyse-phylogen-phylogenclust-module}\label{doctree/soprano.analyse.phylogen.phylogenclust::doc}\index{soprano.analyse.phylogen.phylogenclust (module)}
Phylogenetic clustering class definitions
\index{PhylogenCluster (class in soprano.analyse.phylogen.phylogenclust)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.analyse.phylogen.phylogenclust.}\sphinxbfcode{PhylogenCluster}}{\emph{coll}, \emph{genes=None}, \emph{norm\_range=(0.0}, \emph{1.0)}, \emph{norm\_dist=1.0}}{}
Bases: \sphinxcode{object}

An object that, given an AtomsCollection and a series of ``genes'' and
weights, will build clusters out of the structures in the collection based
on their reciprocal positions as points in a multi-dimensional space
defined by those ``genes''.

Initialize the PhylogenCluster object.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] coll (AtomsCollection): an AtomsCollection containing the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] structures that should be classified.
\item[] This will be copied and frozen for the
\item[] entirety of the life of this instance;
\item[] in order to operate on a modified
\item[] collection, a new PhylogenCluster should
\item[] be created.
\end{DUlineblock}
\item[] genes (list{[}tuple{]}, str, file): list of the genes that should be
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] loaded immediately; each gene
\item[] comes in the form of a tuple
\item[] (name (str), weight (float),
\item[] params (dict)). A path or open
\item[] file can also be passed for a
\item[] .gene file, from which the values
\item[] will be loaded.
\end{DUlineblock}
\item[] norm\_range (list{[}float?{]}): ranges to constrain the values of
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] single genes in between. Default is
\item[] (0, 1). A value of ``None'' in either
\item[] place can be used to indicate no
\item[] normalization on one or both sides.
\end{DUlineblock}
\item[] norm\_dist (float?): value to normalize distance genes to. These
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] are the genes that only make sense on pairs of
\item[] structures. Their minimum value is always 0.
\item[] This number would become their maximum value,
\item[] or can be set to None to avoid normalization.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\index{create\_mapping() (soprano.analyse.phylogen.phylogenclust.PhylogenCluster method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster.create_mapping}\pysiglinewithargsret{\sphinxbfcode{create\_mapping}}{\emph{method=u'total-principal'}}{}
Return an array of 2-dimensional points representing a reduced
dimensionality mapping of the given genes using the algorithm of
choice. All algorithms are described in {[}W. Siedlecki et al., Patt.
Recog. vol. 21, num. 5, pp. 411 429 (1988){]}.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] method (str): can be one of the following algorithms:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] - total\_principal (default)
\item[] - clafic
\item[] - fukunaga-koontz
\item[] - optimal-discriminant
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{get\_distmat() (soprano.analyse.phylogen.phylogenclust.PhylogenCluster method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster.get_distmat}\pysiglinewithargsret{\sphinxbfcode{get\_distmat}}{}{}
Get the distance matrix between structures in the collection,
based on the genes currently in use.

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] distmat (np.ndarray): a (collection.length, collection.length)
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] array, containing the overall distance
\item[] (the norm of all individual gene distances)
\item[] between all pairs of structures.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{get\_genome\_matrices() (soprano.analyse.phylogen.phylogenclust.PhylogenCluster method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster.get_genome_matrices}\pysiglinewithargsret{\sphinxbfcode{get\_genome\_matrices}}{}{}
Return the genome matrices in raw form (not normalized).
The matrices refer to genes that only allow to define a distance
between structures. The element at i,j represents the distance
between said structures. The matrix is symmetric and has
null diagonal.

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] genome\_matrix (np.ndarray): a (collection.length,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] collection.length, gene.length)
\item[] array, containing the distances for
\item[] each gene and pair of structures in
\item[] row and column
\end{DUlineblock}
\item[] genome\_legend (list{[}tuple{]}): a list of tuples containing (name,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] length) of the gene fragments in the
\item[] array
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{get\_genome\_matrices\_norm() (soprano.analyse.phylogen.phylogenclust.PhylogenCluster method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster.get_genome_matrices_norm}\pysiglinewithargsret{\sphinxbfcode{get\_genome\_matrices\_norm}}{}{}
Return the genome matrices in normalized and weighted form.
The matrices refer to genes that only allow to define a distance
between structures. The element at i,j represents the distance
between said structures. The matrix is symmetric and has
null diagonal.

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] genome\_matrix (np.ndarray): a (collection.length,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] collection.length, gene.length)
\item[] array, containing the distances for
\item[] each gene and pair of structures in
\item[] row and column
\end{DUlineblock}
\item[] genome\_legend (list{[}tuple{]}): a list of tuples containing (name,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] length) of the gene fragments in the
\item[] array
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{get\_genome\_vectors() (soprano.analyse.phylogen.phylogenclust.PhylogenCluster method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster.get_genome_vectors}\pysiglinewithargsret{\sphinxbfcode{get\_genome\_vectors}}{}{}
Return the genome vectors in raw form (not normalized).
The vectors refer to genes that allow to define a specific point for
each structure.

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] genome\_vectors (np.ndarray): a (collection.length, gene.length)
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] array, containing the whole extent
\item[] of the gene values for each structure
\item[] in the collection on each row
\end{DUlineblock}
\item[] genome\_legend (list{[}tuple{]}): a list of tuples containing (name,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] length) of the gene fragments in the
\item[] array
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{get\_genome\_vectors\_norm() (soprano.analyse.phylogen.phylogenclust.PhylogenCluster method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster.get_genome_vectors_norm}\pysiglinewithargsret{\sphinxbfcode{get\_genome\_vectors\_norm}}{}{}
Return the genome vectors in normalized and weighted form.
The vectors refer to genes that allow to define a specific point for
each structure.

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] genome\_vectors (np.ndarray): a (collection.length, gene.length)
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] array, containing the whole extent
\item[] of the gene values for each structure
\item[] in the collection on each row
\end{DUlineblock}
\item[] genome\_legend (list{[}tuple{]}): a list of tuples containing (name,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] length) of the gene fragments in the
\item[] array
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{get\_hier\_clusters() (soprano.analyse.phylogen.phylogenclust.PhylogenCluster method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster.get_hier_clusters}\pysiglinewithargsret{\sphinxbfcode{get\_hier\_clusters}}{\emph{t}, \emph{method=u'single'}}{}
Get multiple clusters (in the form of a list of collections) based
on the hierarchical clustering methods and the currently set genes.

Calls scipy.cluster.hierarchy.fcluster

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] t (float): minimum distance of separation required to consider
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] two clusters separate. This controls the number of
\item[] clusters: a smaller value will produce more fine
\item[] grained clustering. At the limit, a value smaller than
\item[] the distance between the two closest structures will
\item[] return a cluster for each structure. Remember that the
\item[] `distances' in this case refer to distances between the
\item[] `gene' values attributed to each structure. In other
\item[] words they are a function of the chosen genes,
\item[] normalization conditions and weights employed.
\item[] In addition, the way they are calculated depends on the
\item[] choice of method.
\end{DUlineblock}
\item[] method (str): clustering method to employ. Valid entries are
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] `single', `complete', `weighted' and `average'.
\item[] Refer to Scipy documentation for further details.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] clusters (tuple(list{[}int{]},
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] list{[}slices{]})): list of cluster index for each
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] structure (counting from 1) and
\item[] list of slices defining the
\item[] clusters as formed by hierarchical
\item[] algorithm.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{get\_hier\_tree() (soprano.analyse.phylogen.phylogenclust.PhylogenCluster method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster.get_hier_tree}\pysiglinewithargsret{\sphinxbfcode{get\_hier\_tree}}{\emph{method=u'single'}}{}
Get a tree data structure describing the clustering order of based
on the hierarchical clustering methods and the currently set genes.

Calls scipy.cluster.hierarchy.to\_tree

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] method (str): clustering method to employ. Valid entries are
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] `single', `complete', `weighted' and `average'.
\item[] Refer to Scipy documentation for further details.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] root\_node (ClusterNode): the root node of the tree. Access child
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] members with .left and .right, while .id
\item[] holds the number of the corresponding
\item[] cluster. Refer to Scipy documentation for
\item[] further details.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{get\_kmeans\_clusters() (soprano.analyse.phylogen.phylogenclust.PhylogenCluster method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster.get_kmeans_clusters}\pysiglinewithargsret{\sphinxbfcode{get\_kmeans\_clusters}}{\emph{n}}{}
Get a given number of clusters (in the form of a list of
collections) based on the k-means clustering methods
and the currently set genes.
Warning: this method only works if there are no genes that work only
with pairs of structures - as specific points, and not just distances
between them, are required for this algorithm.

Calls scipy.cluster.vq.kmeans

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] n (int):    the desired number of clusters.
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] clusters (tuple(list{[}int{]},
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] list{[}slices{]})): list of cluster index for each
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] structure (counting from 1) and
\item[] list of slices defining the
\item[] clusters as formed by k-means
\item[] algorithm.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{get\_linkage() (soprano.analyse.phylogen.phylogenclust.PhylogenCluster method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster.get_linkage}\pysiglinewithargsret{\sphinxbfcode{get\_linkage}}{\emph{method=u'single'}}{}
Get the linkage matrix between structures in the collection,
based on the genes currently in use. Only used in hierarchical
clustering.

Calls scipy.cluster.hierarchy.linkage.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] method (str): clustering method to employ. Valid entries are
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] `single', `complete', `weighted' and `average'.
\item[] Refer to Scipy documentation for further details.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Z (np.ndarray): linkage matrix for the structures in the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] collection. Refer to Scipy documentation for
\item[] details about the method
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{get\_max\_cluster\_dist() (soprano.analyse.phylogen.phylogenclust.PhylogenCluster method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster.get_max_cluster_dist}\pysiglinewithargsret{\sphinxbfcode{get\_max\_cluster\_dist}}{}{}
Return the maximum possible distance between two clusters

\end{fulllineitems}

\index{get\_sklearn\_clusters() (soprano.analyse.phylogen.phylogenclust.PhylogenCluster method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster.get_sklearn_clusters}\pysiglinewithargsret{\sphinxbfcode{get\_sklearn\_clusters}}{\emph{method}, \emph{params=\{\}}}{}
Get clusters applying any of the methods provided by the library
scikit-learn (requires a separate installation).
Warning: this method only works if there are no genes that work only
with pairs of structures - as use of pairwise clustering methods is
not implemented yet.

Uses the sklearn.cluster.\textless{}method\textgreater{} class

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] method (str): name of the clustering class from sklearn.clusters
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] to use. For reference check the documentation at
\item[] \url{http://scikit-learn.org/stable/modules/clustering.html}
\end{DUlineblock}
\item[] params (dict): parameters to be passed to the class when
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] initialising it. Change depending on the desired
\item[] method. Check the documentation for the specific
\item[] class.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] clusters (tuple(list{[}int{]},
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] list{[}slices{]})): list of cluster index for each
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] structure (counting from 1) and
\item[] list of slices defining the
\item[] clusters as formed by the
\item[] requested algorithm.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{load() (soprano.analyse.phylogen.phylogenclust.PhylogenCluster static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster.load}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{load}}{\emph{filename}}{}
Load a pickled copy from a given file path

\end{fulllineitems}

\index{save() (soprano.analyse.phylogen.phylogenclust.PhylogenCluster method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster.save}\pysiglinewithargsret{\sphinxbfcode{save}}{\emph{filename}}{}
Simply save a pickled copy to a given file path

\end{fulllineitems}

\index{save\_collection() (soprano.analyse.phylogen.phylogenclust.PhylogenCluster method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster.save_collection}\pysiglinewithargsret{\sphinxbfcode{save\_collection}}{\emph{filename}}{}
Save as pickle the collection bound to this PhylogenCluster.
The calculated genes are also stored in it as arrays for future use.

\end{fulllineitems}

\index{set\_genes() (soprano.analyse.phylogen.phylogenclust.PhylogenCluster method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.analyse.phylogen.phylogenclust:soprano.analyse.phylogen.phylogenclust.PhylogenCluster.set_genes}\pysiglinewithargsret{\sphinxbfcode{set\_genes}}{\emph{genes}, \emph{load\_arrays=False}}{}
Calculate, store and set a list of genes as used for clustering.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] genes (list{[}soprano.analyse.phylogen.Gene{]},
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] file, str): a list of Genes to calculate and store. A path
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] or open file can also be passed for a .gene
\item[] file, from which the values will be loaded.
\end{DUlineblock}
\end{DUlineblock}
\item[] load\_arrays (bool): try loading the genes as arrays from the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] collection before generating them. Warning:
\item[] if there are arrays named like genes but with
\item[] different contents this can lead to
\item[] unpredictable results.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}


\end{fulllineitems}



\subsubsection{soprano.calculate package}
\label{doctree/soprano.calculate:module-soprano.calculate}\label{doctree/soprano.calculate::doc}\label{doctree/soprano.calculate:soprano-calculate-package}\index{soprano.calculate (module)}
Contains all modules, classes and functions relevant
to calculating properties of existing structures and collections,
from basic ones to energetic and spectroscopic properties.


\paragraph{Subpackages}
\label{doctree/soprano.calculate:subpackages}

\subparagraph{soprano.calculate.gulp package}
\label{doctree/soprano.calculate.gulp:module-soprano.calculate.gulp}\label{doctree/soprano.calculate.gulp::doc}\label{doctree/soprano.calculate.gulp:soprano-calculate-gulp-package}\index{soprano.calculate.gulp (module)}
Classes and functions to carry out calculations using the bindings to GULP
(General Utility Lattice Program), a software providing a lot of useful
calculations with empirical force fields, partial charge calculations, Ewald
summation of Coulombic interactions and more. GULP can be found at:

\url{http://nanochemistry.curtin.edu.au/gulp/}

It needs to be installed on your system to use any of the functionality
provided here.


\subparagraph{Submodules}
\label{doctree/soprano.calculate.gulp:submodules}

\subparagraph{soprano.calculate.gulp.charges module}
\label{doctree/soprano.calculate.gulp.charges:soprano-calculate-gulp-charges-module}\label{doctree/soprano.calculate.gulp.charges:module-soprano.calculate.gulp.charges}\label{doctree/soprano.calculate.gulp.charges::doc}\index{soprano.calculate.gulp.charges (module)}
Get charges using GULP
\index{get\_gulp\_charges() (in module soprano.calculate.gulp.charges)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.gulp.charges:soprano.calculate.gulp.charges.get_gulp_charges}\pysiglinewithargsret{\sphinxcode{soprano.calculate.gulp.charges.}\sphinxbfcode{get\_gulp\_charges}}{\emph{s}, \emph{charge\_method=u'eem'}, \emph{save\_charges=True}, \emph{gulp\_command=u'gulp'}, \emph{gulp\_path=None}}{}
Calculate the atomic partial charges using GULP.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] s (ase.Atoms): the structure to calculate the energy of
\item[] charge\_method (Optional{[}str{]}): which method to use for atomic partial
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] charge calculation. Can be any of
\item[] `eem', `qeq' and `pacha'.
\item[] Default is `eem'.
\end{DUlineblock}
\item[] save\_charges (Optional{[}bool{]}): whether to save or not the charges in
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] the given ase.Atoms object. Default is
\item[] True.
\end{DUlineblock}
\item[] gulp\_command (Optional{[}str{]}): command required to call the GULP
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] executable.
\end{DUlineblock}
\item[] gulp\_path (Optional{[}str{]}): path where the GULP executable can be
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] found. If not present, the GULP command
\item[] will be invoked directly (assuming the
\item[] executable is in the system PATH).
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] charges(np.array(float)): per-atom partial charges
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}



\subparagraph{soprano.calculate.gulp.w99 module}
\label{doctree/soprano.calculate.gulp.w99:soprano-calculate-gulp-w99-module}\label{doctree/soprano.calculate.gulp.w99:module-soprano.calculate.gulp.w99}\label{doctree/soprano.calculate.gulp.w99::doc}\index{soprano.calculate.gulp.w99 (module)}
Classes and functions for using the W99 force field in GULP.
This force field only applies to organic molecules. More information can be
found in the original paper by Donald E. Williams:

D.E. Williams,
\emph{Improved Intermolecular Force Field for Molecules Containing H, C, N, and O
Atoms, with Application to Nucleoside and Peptide Crystals}  - Journal
of Computational Chemistry, Vol. 22, No. 11, 1154-1166 (2001)
\index{W99Error}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.gulp.w99:soprano.calculate.gulp.w99.W99Error}\pysigline{\sphinxstrong{exception }\sphinxcode{soprano.calculate.gulp.w99.}\sphinxbfcode{W99Error}}
Bases: \sphinxcode{exceptions.Exception}

\end{fulllineitems}

\index{find\_w99\_atomtypes() (in module soprano.calculate.gulp.w99)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.gulp.w99:soprano.calculate.gulp.w99.find_w99_atomtypes}\pysiglinewithargsret{\sphinxcode{soprano.calculate.gulp.w99.}\sphinxbfcode{find\_w99\_atomtypes}}{\emph{s}, \emph{force\_recalc=False}}{}
Calculate the W99 force field atom types for a given structure.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] s (ase.Atoms): the structure to calculate the atomtypes on
\item[] force\_recalc (bool): whether to recalculate the molecules even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present. Default is False.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{get\_w99\_energy() (in module soprano.calculate.gulp.w99)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.gulp.w99:soprano.calculate.gulp.w99.get_w99_energy}\pysiglinewithargsret{\sphinxcode{soprano.calculate.gulp.w99.}\sphinxbfcode{get\_w99\_energy}}{\emph{s}, \emph{charge\_method=u'eem'}, \emph{Etol=1e-06}, \emph{gulp\_command=u'gulp'}, \emph{gulp\_path=None}, \emph{save\_charges=False}}{}
Calculate the W99 force field energy using GULP.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] s (ase.Atoms): the structure to calculate the energy of
\item[] charge\_method (Optional{[}str{]}): which method to use for atomic partial
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] charge calculation. Can be any of
\item[] `eem', `qeq' and `pacha'.
\item[] Default is `eem'.
\end{DUlineblock}
\item[] Etol (Optional{[}float{]}): tolerance on energy for intermolecular
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] potential cutoffs (relative to single
\item[] interaction energy). Default is 1e-6 eV.
\end{DUlineblock}
\item[] gulp\_command (Optional{[}str{]}): command required to call the GULP
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] executable.
\end{DUlineblock}
\item[] gulp\_path (Optional{[}str{]}): path where the GULP executable can be
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] found. If not present, the GULP command
\item[] will be invoked directly (assuming the
\item[] executable is in the system PATH).
\end{DUlineblock}
\item[] save\_charges (Optional{[}bool{]}): whether to retrieve also the charges
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] and save them in the Atoms object.
\item[] False by default.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] energy (float): the calculated energy
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}



\subparagraph{soprano.calculate.nmr package}
\label{doctree/soprano.calculate.nmr:module-soprano.calculate.nmr}\label{doctree/soprano.calculate.nmr::doc}\label{doctree/soprano.calculate.nmr:soprano-calculate-nmr-package}\index{soprano.calculate.nmr (module)}
Classes and functions for simulating NMR spectroscopic results from
structures with simplified algorithms.


\subparagraph{Submodules}
\label{doctree/soprano.calculate.nmr:submodules}

\subparagraph{soprano.calculate.nmr.nmr module}
\label{doctree/soprano.calculate.nmr.nmr:module-soprano.calculate.nmr.nmr}\label{doctree/soprano.calculate.nmr.nmr:soprano-calculate-nmr-nmr-module}\label{doctree/soprano.calculate.nmr.nmr::doc}\index{soprano.calculate.nmr.nmr (module)}
Classes and functions for simulating approximated NMR spectroscopic results
from structures.
\index{NMRCalculator (class in soprano.calculate.nmr.nmr)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.nmr:soprano.calculate.nmr.nmr.NMRCalculator}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.calculate.nmr.nmr.}\sphinxbfcode{NMRCalculator}}{\emph{sample}, \emph{larmor\_frequency=400}, \emph{larmor\_units=u'MHz'}}{}
Bases: \sphinxcode{object}

An object providing an interface to produce basic simulated NMR spectra
from .magres files. It should be kept in mind that this is \emph{not} a proper
spin simulation tool, but merely provides a `guide for the eye' kind of
spectrum to compare to experimental results. What it can simulate:
\begin{itemize}
\item {} 
chemical shift of NMR peaks

\item {} 
quadrupolar shifts of NMR peaks up to second order corrections

\item {} 
effects of crystal orientation (single crystal)

\item {} 
powder average (policrystalline/powder)

\item {} 
ultrafast MAS limit spectra

\end{itemize}

What it can NOT simulate:
\begin{itemize}
\item {} 
finite speed MAS spectra

\item {} 
J couplings

\item {} 
dipolar interactions

\item {} 
complex NMR experiments

\end{itemize}

A list of the currently available NMRFlags to be used in conjunction with
methods that require a list of effects of interest:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{n}{NMRFlags}\PYG{o}{.}\PYG{n}{CS\PYGZus{}ISO}     \PYG{o}{=}\PYG{o}{\PYGZgt{}} \PYG{n}{chemical} \PYG{n}{shielding}\PYG{p}{,} \PYG{n}{isotropic} \PYG{n}{effect}
        \PYG{o}{.}\PYG{n}{CS\PYGZus{}ORIENT}  \PYG{o}{=}\PYG{o}{\PYGZgt{}} \PYG{n}{chemical} \PYG{n}{shielding}\PYG{p}{,} \PYG{n}{orientation} \PYG{n}{dependent}
                       \PYG{n}{effects}
        \PYG{o}{.}\PYG{n}{CS}         \PYG{o}{=}\PYG{o}{\PYGZgt{}} \PYG{n}{chemical} \PYG{n}{shielding}\PYG{p}{,} \PYG{n}{everything}
        \PYG{o}{.}\PYG{n}{Q\PYGZus{}1\PYGZus{}ORIENT} \PYG{o}{=}\PYG{o}{\PYGZgt{}} \PYG{n}{quadrupolar}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{n}{st} \PYG{n}{order}\PYG{p}{,} \PYG{n}{orientation} \PYG{n}{dependent}
                       \PYG{n}{effects}
        \PYG{o}{.}\PYG{n}{Q\PYGZus{}2\PYGZus{}SHIFT}  \PYG{o}{=}\PYG{o}{\PYGZgt{}} \PYG{n}{quadrupolar}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{n}{nd} \PYG{n}{order}\PYG{p}{,} \PYG{n}{isotropic} \PYG{n}{shift}
        \PYG{o}{.}\PYG{n}{Q\PYGZus{}2\PYGZus{}ORIENT\PYGZus{}STATIC} \PYG{o}{=}\PYG{o}{\PYGZgt{}} \PYG{n}{quadrupolar}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{n}{nd} \PYG{n}{order}\PYG{p}{,} \PYG{n}{orientation}
                              \PYG{n}{dependent} \PYG{n}{effects}\PYG{p}{;} \PYG{n}{static} \PYG{n}{limit}
        \PYG{o}{.}\PYG{n}{Q\PYGZus{}2\PYGZus{}ORIENT\PYGZus{}MAS} \PYG{o}{=}\PYG{o}{\PYGZgt{}} \PYG{n}{quadrupolar}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{n}{nd} \PYG{n}{order}\PYG{p}{,} \PYG{n}{orientation}
                              \PYG{n}{dependent} \PYG{n}{effects}\PYG{p}{;} \PYG{n}{ultrafast} \PYG{n}{MAS} \PYG{n}{limit}
        \PYG{o}{.}\PYG{n}{Q\PYGZus{}2\PYGZus{}STATIC} \PYG{o}{=}\PYG{o}{\PYGZgt{}} \PYG{n}{quadrupolar}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{n}{nd} \PYG{n}{order}\PYG{p}{,} \PYG{n+nb}{all} \PYG{n}{static} \PYG{n}{effects}
        \PYG{o}{.}\PYG{n}{Q\PYGZus{}2\PYGZus{}MAS}    \PYG{o}{=}\PYG{o}{\PYGZgt{}} \PYG{n}{quadrupolar}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{n}{nd} \PYG{n}{order}\PYG{p}{,} \PYG{n+nb}{all} \PYG{n}{ultrafast} \PYG{n}{MAS}
                       \PYG{n}{effects}
        \PYG{o}{.}\PYG{n}{Q\PYGZus{}STATIC}   \PYG{o}{=}\PYG{o}{\PYGZgt{}} \PYG{n}{quadrupolar}\PYG{p}{,} \PYG{n+nb}{all} \PYG{n}{static} \PYG{n}{effects}
        \PYG{o}{.}\PYG{n}{Q\PYGZus{}MAS}      \PYG{o}{=}\PYG{o}{\PYGZgt{}} \PYG{n}{quadrupolar}\PYG{p}{,} \PYG{n+nb}{all} \PYG{n}{ultrafast} \PYG{n}{MAS} \PYG{n}{effects}
        \PYG{o}{.}\PYG{n}{STATIC}     \PYG{o}{=}\PYG{o}{\PYGZgt{}} \PYG{n+nb}{all} \PYG{n}{static} \PYG{n}{effects}
        \PYG{o}{.}\PYG{n}{MAS}        \PYG{o}{=}\PYG{o}{\PYGZgt{}} \PYG{n+nb}{all} \PYG{n}{ultrafast} \PYG{n}{MAS} \PYG{n}{effects}
\end{Verbatim}

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] sample (ase.Atoms): an Atoms object describing the system to simulate
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] on. Should be loaded with ASE from a .magres file
\item[] if data on shieldings and EFGs is necessary. It
\item[] can also have an optional `isotopes' array. If it
\item[] does, it will be used in the set\_isotopes method
\item[] and interpreted as described in its documentation.
\end{DUlineblock}
\item[] larmor\_frequency (float): larmor frequency of the virtual spectrometer
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] (referenced to Hydrogen). Default is 400.
\end{DUlineblock}
\item[] larmor\_units (str): units in which the larmor frequency is expressed.
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Default are MHz.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\index{B (soprano.calculate.nmr.nmr.NMRCalculator attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.nmr:soprano.calculate.nmr.nmr.NMRCalculator.B}\pysigline{\sphinxbfcode{B}}
Static magnetic field, in Tesla

\end{fulllineitems}

\index{get\_larmor\_frequency() (soprano.calculate.nmr.nmr.NMRCalculator method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.nmr:soprano.calculate.nmr.nmr.NMRCalculator.get_larmor_frequency}\pysiglinewithargsret{\sphinxbfcode{get\_larmor\_frequency}}{\emph{element}}{}
Get the Larmor frequency of the virtual spectrometer for the desired
element in MHz.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] element (str): element and isotope whose frequency we require.
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Should be in the form \textless{}isotope\textgreater{}\textless{}element\textgreater{}. Isotope
\item[] is optional, if absent the most abundant NMR active
\item[] one will be used. Default is 1H.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] larmor (float): Larmor frequency in MHz
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{set\_element\_isotope() (soprano.calculate.nmr.nmr.NMRCalculator method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.nmr:soprano.calculate.nmr.nmr.NMRCalculator.set_element_isotope}\pysiglinewithargsret{\sphinxbfcode{set\_element\_isotope}}{\emph{element}, \emph{isotope}}{}
Set the isotope for all occurrences of a given element.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] element (str): chemical symbol of the element for which to set the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] isotope.
\end{DUlineblock}
\item[] isotope (int or str): isotope to set for the given element. The
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] same conventions as described for the array
\item[] passed to set\_isotopes apply.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{set\_isotopes() (soprano.calculate.nmr.nmr.NMRCalculator method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.nmr:soprano.calculate.nmr.nmr.NMRCalculator.set_isotopes}\pysiglinewithargsret{\sphinxbfcode{set\_isotopes}}{\emph{isotopes}}{}
Set the isotopes for each atom in sample.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] isotopes (list): list of isotopes for each atom in sample.
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Isotopes can be given as an array of integers or
\item[] of symbols in the form \textless{}isotope\textgreater{}\textless{}element\textgreater{}.
\item[] Their order must match the one of the atoms in
\item[] the original sample ase.Atoms object.
\item[] If an element of the list is None, the most
\item[] common NMR-active isotope is used. If an element
\item[] is the string `Q', the most common quadrupolar
\item[] active isotope for that nucleus (if known) will
\item[] be used.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{set\_larmor\_frequency() (soprano.calculate.nmr.nmr.NMRCalculator method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.nmr:soprano.calculate.nmr.nmr.NMRCalculator.set_larmor_frequency}\pysiglinewithargsret{\sphinxbfcode{set\_larmor\_frequency}}{\emph{larmor\_frequency=400}, \emph{larmor\_units=u'MHz'}, \emph{element=u`1H'}}{}
Set the Larmor frequency of the virtual spectrometer with the desired
units and reference element.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] larmor\_frequency (float): larmor frequency of the virtual
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] spectrometer. Default is 400.
\end{DUlineblock}
\item[] larmor\_units (str): units in which the larmor frequency is
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] expressed. Can be MHz or T. Default are MHz.
\end{DUlineblock}
\item[] element (str): element and isotope to reference the frequency to.
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Should be in the form \textless{}isotope\textgreater{}\textless{}element\textgreater{}. Isotope
\item[] is optional, if absent the most abundant NMR active
\item[] one will be used. Default is 1H.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{set\_powder() (soprano.calculate.nmr.nmr.NMRCalculator method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.nmr:soprano.calculate.nmr.nmr.NMRCalculator.set_powder}\pysiglinewithargsret{\sphinxbfcode{set\_powder}}{\emph{N=8}, \emph{mode=u'hemisphere'}}{}
Set the orientation of the sample as a powder average.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] N (int): the number of subdivisions used to generate orientations
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] within the POWDER algorithm. Higher values make for
\item[] better but more expensive averages.
\end{DUlineblock}
\item[] mode (str): which part of the solid angle to cover with the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] orientations. Can be `octant', `hemisphere' or
\item[] `sphere'. The latter should not be necessary for any
\item[] NMR interaction. Default is `hemisphere'.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{set\_reference() (soprano.calculate.nmr.nmr.NMRCalculator method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.nmr:soprano.calculate.nmr.nmr.NMRCalculator.set_reference}\pysiglinewithargsret{\sphinxbfcode{set\_reference}}{\emph{ref}, \emph{element}}{}
Set the chemical shift reference (in ppm) for a given element. If not
provided it will be assumed to be zero.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ref (float): reference shielding value in ppm. Chemical shift will
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] be calculated as this minus the atom's ms.
\end{DUlineblock}
\item[] element (str): element and isotope whose reference is set.
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Should be in the form \textless{}isotope\textgreater{}\textless{}element\textgreater{}. Isotope
\item[] is optional, if absent the most abundant NMR active
\item[] one will be used.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{set\_single\_crystal() (soprano.calculate.nmr.nmr.NMRCalculator method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.nmr:soprano.calculate.nmr.nmr.NMRCalculator.set_single_crystal}\pysiglinewithargsret{\sphinxbfcode{set\_single\_crystal}}{\emph{theta}, \emph{phi}}{}
Set the orientation of the sample as a single crystallite.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] theta (float): zenithal angle for the crystallite
\item[] phi (float): azimuthal angle for the crystallite
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{spectrum\_1d() (soprano.calculate.nmr.nmr.NMRCalculator method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.nmr:soprano.calculate.nmr.nmr.NMRCalculator.spectrum_1d}\pysiglinewithargsret{\sphinxbfcode{spectrum\_1d}}{\emph{element}, \emph{min\_freq=-50}, \emph{max\_freq=50}, \emph{bins=100}, \emph{freq\_broad=None}, \emph{freq\_units=u'ppm'}, \emph{effects=1}}{}
Return a simulated spectrum for the given sample and element.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] element (str): element and isotope to get the spectrum of.
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Should be in the form \textless{}isotope\textgreater{}\textless{}element\textgreater{}. Isotope
\item[] is optional, if absent the most abundant NMR active
\item[] one will be used.
\end{DUlineblock}
\item[] min\_freq (float): lower bound of the frequency range
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] (default is -50)
\end{DUlineblock}
\item[] min\_freq (float): upper bound of the frequency range
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] (default is 50)
\end{DUlineblock}
\item[] bins (int): number of bins in which to separate the frequency range
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] (default is 500)
\end{DUlineblock}
\item[] freq\_broad (float): Gaussian broadening width to apply to the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] final spectrum (default is None)
\end{DUlineblock}
\item[] freq\_units (str): units used for frequency, can be ppm or MHz
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] (default is ppm).
\end{DUlineblock}
\item[] effects (NMRFlags): a flag, or bitwise-joined set of flags, from
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] this module's NMRFlags tuple, describing which
\item[] effects should be included and accounted for
\item[] in the calculation. For a list of available
\item[] flags check the docstring for NMRCalculator.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] spec (np.ndarray): array of length `bins' containing the spectral
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] intensities
\end{DUlineblock}
\item[] freq (np.ndarray): array of length `bins' containing the frequency
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] axis
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}


\end{fulllineitems}



\subparagraph{soprano.calculate.nmr.powder module}
\label{doctree/soprano.calculate.nmr.powder:soprano-calculate-nmr-powder-module}\label{doctree/soprano.calculate.nmr.powder::doc}\label{doctree/soprano.calculate.nmr.powder:module-soprano.calculate.nmr.powder}\index{soprano.calculate.nmr.powder (module)}
Functions for use of the POWDER averaging algorithm for NMR spectra,
as described in:

D. W. Alderman, Mark S. Solum, and David M. Grant
Methods for analyzing spectroscopic line shapes. NMR solid powder patterns
{[}J. Chern. Phys. 84 (7), 1 April 1986{]}
\index{gen\_pwd\_ang() (in module soprano.calculate.nmr.powder)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.powder:soprano.calculate.nmr.powder.gen_pwd_ang}\pysiglinewithargsret{\sphinxcode{soprano.calculate.nmr.powder.}\sphinxbfcode{gen\_pwd\_ang}}{\emph{N}, \emph{mode=u'sphere'}}{}
Generate and return the POWDER angles (in the form of direction cosines),
weights, and triangles.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] N (int): number of divisions on each side of the octahedron used to
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] generate angles. Higher numbers lead to greater precision.
\end{DUlineblock}
\item[] mode (str): whether the angles should be distributed over the whole
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] `sphere', over an `hemisphere' or only on an `octant'.
\item[] Default is `sphere'.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] points, weights, tris (np.ndarray): arrays containing respectively the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] direction cosines for each
\item[] orientation, the weights, and the
\item[] triangles (in form of triplets of
\item[] indices of the first array)
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{pwd\_avg() (in module soprano.calculate.nmr.powder)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.powder:soprano.calculate.nmr.powder.pwd_avg}\pysiglinewithargsret{\sphinxcode{soprano.calculate.nmr.powder.}\sphinxbfcode{pwd\_avg}}{\emph{x}, \emph{freqs}, \emph{weights}, \emph{tris}}{}
\end{fulllineitems}



\subparagraph{soprano.calculate.nmr.simpson module}
\label{doctree/soprano.calculate.nmr.simpson:soprano-calculate-nmr-simpson-module}\label{doctree/soprano.calculate.nmr.simpson::doc}\label{doctree/soprano.calculate.nmr.simpson:module-soprano.calculate.nmr.simpson}\index{soprano.calculate.nmr.simpson (module)}
Classes and functions for interfacing with the SIMPSON spin dynamics software.
\index{SimpsonSequence (class in soprano.calculate.nmr.simpson)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.simpson:soprano.calculate.nmr.simpson.SimpsonSequence}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.calculate.nmr.simpson.}\sphinxbfcode{SimpsonSequence}}{\emph{spinsys\_source}}{}
A class storing parameters and scripts for the production of a SIMPSON
input file. The parameters of the simulation are stored in a dictionary
member accessible as .pars and can be set at will.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] spinsys\_source (str): path of the .spinsys file to use in the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] simulation
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\index{apply\_custom\_template() (soprano.calculate.nmr.simpson.SimpsonSequence method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.simpson:soprano.calculate.nmr.simpson.SimpsonSequence.apply_custom_template}\pysiglinewithargsret{\sphinxbfcode{apply\_custom\_template}}{\emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}

\index{apply\_template() (soprano.calculate.nmr.simpson.SimpsonSequence method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.simpson:soprano.calculate.nmr.simpson.SimpsonSequence.apply_template}\pysiglinewithargsret{\sphinxbfcode{apply\_template}}{\emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}

\index{set\_parameters() (soprano.calculate.nmr.simpson.SimpsonSequence method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.simpson:soprano.calculate.nmr.simpson.SimpsonSequence.set_parameters}\pysiglinewithargsret{\sphinxbfcode{set\_parameters}}{\emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}

\index{write\_input() (soprano.calculate.nmr.simpson.SimpsonSequence method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.simpson:soprano.calculate.nmr.simpson.SimpsonSequence.write_input}\pysiglinewithargsret{\sphinxbfcode{write\_input}}{\emph{path=None}}{}
Print out the .in file.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] path (str): path to save the newly created file to. If not provided,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] the contents will be simply returned as a string.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}


\end{fulllineitems}

\index{load\_simpson\_dat() (in module soprano.calculate.nmr.simpson)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.simpson:soprano.calculate.nmr.simpson.load_simpson_dat}\pysiglinewithargsret{\sphinxcode{soprano.calculate.nmr.simpson.}\sphinxbfcode{load\_simpson\_dat}}{\emph{filename}}{}
Load a SIMPSON output .dat file and return it as a numpy array.

\end{fulllineitems}

\index{write\_spinsys() (in module soprano.calculate.nmr.simpson)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.nmr.simpson:soprano.calculate.nmr.simpson.write_spinsys}\pysiglinewithargsret{\sphinxcode{soprano.calculate.nmr.simpson.}\sphinxbfcode{write\_spinsys}}{\emph{s}, \emph{isotope\_list=None}, \emph{use\_ms=False}, \emph{ms\_iso=False}, \emph{q\_order=0}, \emph{dip\_sel=None}, \emph{path=None}}{}
Write a .spinsys input file for use with SIMPSON, given the details of a
system. This is meant to be a low-level function, used by other higher
level interfaces in NMRCalculator.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] s (ase.Atoms): atomic structure containing the desired spins. All
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] atoms will be included - if that is not the desired
\item[] result, this should be accomplished by making this a
\item[] subset of the full structure.
\end{DUlineblock}
\item[] isotope\_list ({[}int{]}): list of isotopes for each element in the system.
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] If left to None, default NMR-active isotopes
\item[] will be used.
\end{DUlineblock}
\item[] use\_ms (bool): if True, include shift interactions from magnetic
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] shieldings.
\end{DUlineblock}
\item[] ms\_iso (bool): if True, all magnetic shieldings will be made
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] isotropic.
\end{DUlineblock}
\item[] q\_order(int): if greater than 0, include quadrupolar interactions from
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Electric Field Gradients at the given order (1 or 2).
\end{DUlineblock}
\item[] dip\_sel (AtomSelection): if not None, include dipolar couplings
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] between atoms belonging to this set.
\end{DUlineblock}
\item[] path (str): path to save the newly created file to. If not provided,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] the contents will be simply returned as a string.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] file\_contents (str): spinsys file in string format. Only returned if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] no save path is provided.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}



\subparagraph{soprano.calculate.xrd package}
\label{doctree/soprano.calculate.xrd:soprano-calculate-xrd-package}\label{doctree/soprano.calculate.xrd::doc}\label{doctree/soprano.calculate.xrd:module-soprano.calculate.xrd}\index{soprano.calculate.xrd (module)}
Classes and functions for simulating X-ray diffraction
spectroscopic results from structures.


\subparagraph{Submodules}
\label{doctree/soprano.calculate.xrd:submodules}

\subparagraph{soprano.calculate.xrd.sel\_rules module}
\label{doctree/soprano.calculate.xrd.sel_rules::doc}\label{doctree/soprano.calculate.xrd.sel_rules:module-soprano.calculate.xrd.sel_rules}\label{doctree/soprano.calculate.xrd.sel_rules:soprano-calculate-xrd-sel-rules-module}\index{soprano.calculate.xrd.sel\_rules (module)}
Providing an interface to selection rules for XRD peaks and various
spacegroups.
\index{get\_sel\_rule\_from\_hall() (in module soprano.calculate.xrd.sel\_rules)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.sel_rules:soprano.calculate.xrd.sel_rules.get_sel_rule_from_hall}\pysiglinewithargsret{\sphinxcode{soprano.calculate.xrd.sel\_rules.}\sphinxbfcode{get\_sel\_rule\_from\_hall}}{\emph{h}}{}
Generate a function object that acts as a selection rule for XRD lines
for the given symmetry group expressed in Hall number notation

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] h (int): Hall number of the required spacegroup
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] rule\_func (function\textless{} list\textless{}int\textgreater{} \textgreater{}
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] =\textgreater{} \textless{}bool\textgreater{}): a function that can be used to test triples of
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Miller indices h,k,l to verify whether the
\item[] related plane gives rise or not to a peak
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Raises:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] RuntimeError: if the database of XRD selection rules or that of
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Hall numbers was not properly loaded
\end{DUlineblock}
\item[] ValueError: if the passed argument is invalid
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{get\_sel\_rule\_from\_international() (in module soprano.calculate.xrd.sel\_rules)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.sel_rules:soprano.calculate.xrd.sel_rules.get_sel_rule_from_international}\pysiglinewithargsret{\sphinxcode{soprano.calculate.xrd.sel\_rules.}\sphinxbfcode{get\_sel\_rule\_from\_international}}{\emph{n}, \emph{o=u'all'}}{}
Generate a function object that acts as a selection rule for XRD lines
for the given symmetry group expressed in international number notation

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] n (int): International number of the required spacegroup
\item[] o (Optional{[}int{]}): Sub-option of the required spacegroup
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] rule\_func (function\textless{} list\textless{}int\textgreater{} \textgreater{}
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] =\textgreater{} \textless{}bool\textgreater{}): a function that can be used to test triples of
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Miller indices h,k,l to verify whether the
\item[] related plane gives rise or not to a peak
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Raises:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] RuntimeError: if the database of XRD selection rules was not properly
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] loaded
\end{DUlineblock}
\item[] ValueError: if some of the passed arguments are invalid
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}



\subparagraph{soprano.calculate.xrd.xrd module}
\label{doctree/soprano.calculate.xrd.xrd:module-soprano.calculate.xrd.xrd}\label{doctree/soprano.calculate.xrd.xrd::doc}\label{doctree/soprano.calculate.xrd.xrd:soprano-calculate-xrd-xrd-module}\index{soprano.calculate.xrd.xrd (module)}
Classes and functions for simulating X-ray diffraction
spectroscopic results from structures.
\index{XRDCalculator (class in soprano.calculate.xrd.xrd)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XRDCalculator}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.calculate.xrd.xrd.}\sphinxbfcode{XRDCalculator}}{\emph{lambdax=1.54056}, \emph{theta2\_digits=6}, \emph{baseline=0.0}, \emph{peak\_func=None}, \emph{peak\_f\_args=None}}{}
Bases: \sphinxcode{object}

A class implementing methods for XRD simulations, comparisons and
fittings.

Initialize the XDRCalculator object's main parameters

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] lambdax (Optional{[}float{]}): X-ray wavelength in Angstroms
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] (default is 1.54056 Ang)
\end{DUlineblock}
\item[] theta2\_digits (Optional{[}int{]}): Rounding within which
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] two theta angles (in degrees)
\item[] are considered to be equivalent
\item[] (default is 6 digits) when
\item[] calculating theoretical peaks
\end{DUlineblock}
\end{DUlineblock}
\item[] baseline (Optional{[}float{]}): baseline to use as starting point for
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] simulated spectra
\end{DUlineblock}
\item[] peak\_func (Optional{[}function\textless{}float, float, *kargs\textgreater{}
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] =\textgreater{} \textless{}np.ndarray\textgreater{}{]}): the function used to
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] simulate peaks. Should take
\item[] th2 as its first argument,
\item[] peak centre as its second,
\item[] and any number of optional
\item[] arguments. Returns a numpy
\item[] array containing the peak
\item[] shape. Should be able to
\item[] work with numpy arrays as
\item[] input
\end{DUlineblock}
\end{DUlineblock}
\item[] peak\_f\_args (Optional{[}list\textless{}float\textgreater{}{]}): optional arguments for
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] peak\_func. If no peak\_func
\item[] has been supplied by the
\item[] user, the first value will
\item[] be used as the Gaussian width
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\index{dataset\_range() (soprano.calculate.xrd.xrd.XRDCalculator method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XRDCalculator.dataset_range}\pysiglinewithargsret{\sphinxbfcode{dataset\_range}}{\emph{xpeaks}, \emph{theta2\_range=(None}, \emph{None)}}{}~\begin{description}
\item[{Restrict the given dataset (XraySpectrum or XraySpectrumData) to}] \leavevmode
only the values that lie within a certain theta2 range.

\end{description}

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] xpeaks (XraySpectrum or XraySpectrumData): the dataset to modify
\item[] theta2\_range (tuple\textless{}int\textgreater{}): a tuple indicating minimum and maximum
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] of the desired theta2 range (degrees).
\item[] A value of None means no boundary
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] xpeaks\_restrict (XraySpectrum or XraySpectrumData): the restricted
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] dataset
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Raises:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ValueError: if some of the values passed are invalid
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{exp\_dataset() (soprano.calculate.xrd.xrd.XRDCalculator method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XRDCalculator.exp_dataset}\pysiglinewithargsret{\sphinxbfcode{exp\_dataset}}{\emph{th2\_axis}, \emph{int\_axis}}{}
Build an experimental dataset as an XraySpectrumData object.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] th2\_axis (np.ndarray): array containing the values for 2*theta
\item[] int\_axis (np.ndarray): array containing the values for intensity
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] exp\_spec (XraySpectrumData): named tuple containing the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] experimental dataset
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Raises:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ValueError: if some of the values passed are invalid
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{lebail\_fit() (soprano.calculate.xrd.xrd.XRDCalculator method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XRDCalculator.lebail_fit}\pysiglinewithargsret{\sphinxbfcode{lebail\_fit}}{\emph{xpeaks}, \emph{exp\_spec}, \emph{rwp\_tol=0.01}, \emph{max\_iter=100}}{}
Perform a refining on an XraySpectrum object's intensities based on
experimental data with leBail's method.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] xpeaks (XraySpectrum): object containing the details of the XRD
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] peaks
\end{DUlineblock}
\item[] exp\_spec (XraySpectrumData): experimental data, dataset built
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] using xrd\_exp\_dataset
\end{DUlineblock}
\item[] rwp\_tol (Optional{[}float{]}): tolerance on the Rwp error value
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] between two iterations that stops the
\item[] calculation. Default is 1e-2
\end{DUlineblock}
\item[] max\_iter (Optional{[}int{]}): maximum number of iterations to perform
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] xpeaks\_scaled (XraySpectrum): a new XraySpectrum object, with
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] intensities properly scaled to match
\item[] the experimental data
\end{DUlineblock}
\item[] simul\_spec (np.ndarray): final simulated XRD spectrum
\item[] simul\_peaks (np.ndarray): final simulated spectrum broken by peak
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] contribution along axis 1
\end{DUlineblock}
\item[] rwp (float): the final value of Rwp (fitness of simulated to
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] experimental data)
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Raises:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ValueError: if some of the arguments are invalid
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{peak\_f\_args (soprano.calculate.xrd.xrd.XRDCalculator attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XRDCalculator.peak_f_args}\pysigline{\sphinxbfcode{peak\_f\_args}}
Additional arguments to be passed to peak\_func

\end{fulllineitems}

\index{peak\_func (soprano.calculate.xrd.xrd.XRDCalculator attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XRDCalculator.peak_func}\pysigline{\sphinxbfcode{peak\_func}}
The function used to build peaks in simulated spectra

Should be of form peak\_func(theta2, peak\_position, *peak\_f\_args)

\end{fulllineitems}

\index{powder\_peaks() (soprano.calculate.xrd.xrd.XRDCalculator method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XRDCalculator.powder_peaks}\pysiglinewithargsret{\sphinxbfcode{powder\_peaks}}{\emph{atoms=None}, \emph{latt\_abc=None}, \emph{n=1}, \emph{o=u'all'}}{}
Calculate the peaks (without intensities) of a powder
XRD spectrum given either an Atoms object or the lattice in ABC form
and the spacegroup indices to apply the selection rules

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] atoms (Optional{[}soprano.Atoms{]}): atoms object to gather lattice
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] and spacegroup information from
\end{DUlineblock}
\item[] latt\_abc (Optional{[}np.ndarray{]}): periodic lattice in ABC form,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Angstroms and radians
\end{DUlineblock}
\end{DUlineblock}
\item[] n (Optional{[}int{]}): International number of the required spacegroup
\item[] o (Optional{[}int{]}): Sub-option of the required spacegroup
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] xpeaks (XraySpectrum): a named tuple containing the peaks
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] with theta2, corresponding hkl indices,
\item[] a unique hkl tuple for each peak,
\item[] inverse reciprocal lattice distances,
\item[] intensities and wavelength
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Raises:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ValueError: if some of the arguments are invalid
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{set\_peak\_func() (soprano.calculate.xrd.xrd.XRDCalculator method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XRDCalculator.set_peak_func}\pysiglinewithargsret{\sphinxbfcode{set\_peak\_func}}{\emph{peak\_func=None}, \emph{peak\_f\_args=None}}{}
Set a new peak\_func for this XDRCalculator. If no new function is
passed, reset the default Gaussian function.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] peak\_func (Optional{[}function\textless{}float, float, *kargs\textgreater{}
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] =\textgreater{} \textless{}np.ndarray\textgreater{}{]}): the function used to
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] simulate peaks. Should
\item[] take th2 as its first
\item[] argument, peak centre as
\item[] its second, and any
\item[] number of optional
\item[] arguments. Returns a
\item[] numpy array containing
\item[] the peak shape. Should
\item[] be able to work with
\item[] numpy arrays as input
\end{DUlineblock}
\end{DUlineblock}
\item[] peak\_f\_args (Optional{[}list\textless{}float\textgreater{}{]}): optional arguments for
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] peak\_func. If no peak\_func
\item[] has been supplied by the
\item[] user, the first value will
\item[] be used as the Gaussian
\item[] width
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{spec\_simul() (soprano.calculate.xrd.xrd.XRDCalculator method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XRDCalculator.spec_simul}\pysiglinewithargsret{\sphinxbfcode{spec\_simul}}{\emph{xpeaks}, \emph{th2\_axis}}{}
Simulate an XRD spectrum given positions of peaks, intensities,
baseline, and a peak function (a Gaussian by default).

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] xpeaks (XraySpectrum): object containing the details of the XRD
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] peaks
\end{DUlineblock}
\item[] th2\_axis (np.ndarray): theta2 axis points on which the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] spectrum should be simulated
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] simul\_spec (XraySpectrumData): simulated XRD spectrum
\item[] simul\_peaks (np.ndarray): simulated spectrum intensities broken by
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] peak contribution along axis 1
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Raises:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ValueError: if some of the arguments are invalid
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}


\end{fulllineitems}

\index{XraySpectrum (class in soprano.calculate.xrd.xrd)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XraySpectrum}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.calculate.xrd.xrd.}\sphinxbfcode{XraySpectrum}}{\emph{theta2}, \emph{hkl}, \emph{hkl\_unique}, \emph{invd}, \emph{intensity}, \emph{lambdax}}{}
Bases: \sphinxcode{tuple}

Create new instance of XraySpectrum(theta2, hkl, hkl\_unique, invd, intensity, lambdax)
\index{hkl (soprano.calculate.xrd.xrd.XraySpectrum attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XraySpectrum.hkl}\pysigline{\sphinxbfcode{hkl}}
Alias for field number 1

\end{fulllineitems}

\index{hkl\_unique (soprano.calculate.xrd.xrd.XraySpectrum attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XraySpectrum.hkl_unique}\pysigline{\sphinxbfcode{hkl\_unique}}
Alias for field number 2

\end{fulllineitems}

\index{intensity (soprano.calculate.xrd.xrd.XraySpectrum attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XraySpectrum.intensity}\pysigline{\sphinxbfcode{intensity}}
Alias for field number 4

\end{fulllineitems}

\index{invd (soprano.calculate.xrd.xrd.XraySpectrum attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XraySpectrum.invd}\pysigline{\sphinxbfcode{invd}}
Alias for field number 3

\end{fulllineitems}

\index{lambdax (soprano.calculate.xrd.xrd.XraySpectrum attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XraySpectrum.lambdax}\pysigline{\sphinxbfcode{lambdax}}
Alias for field number 5

\end{fulllineitems}

\index{theta2 (soprano.calculate.xrd.xrd.XraySpectrum attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XraySpectrum.theta2}\pysigline{\sphinxbfcode{theta2}}
Alias for field number 0

\end{fulllineitems}


\end{fulllineitems}

\index{XraySpectrumData (class in soprano.calculate.xrd.xrd)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XraySpectrumData}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.calculate.xrd.xrd.}\sphinxbfcode{XraySpectrumData}}{\emph{theta2}, \emph{intensity}}{}
Bases: \sphinxcode{tuple}

Create new instance of XraySpectrumData(theta2, intensity)
\index{intensity (soprano.calculate.xrd.xrd.XraySpectrumData attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XraySpectrumData.intensity}\pysigline{\sphinxbfcode{intensity}}
Alias for field number 1

\end{fulllineitems}

\index{theta2 (soprano.calculate.xrd.xrd.XraySpectrumData attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.calculate.xrd.xrd:soprano.calculate.xrd.xrd.XraySpectrumData.theta2}\pysigline{\sphinxbfcode{theta2}}
Alias for field number 0

\end{fulllineitems}


\end{fulllineitems}



\subsubsection{soprano.collection package}
\label{doctree/soprano.collection:soprano-collection-package}\label{doctree/soprano.collection::doc}\label{doctree/soprano.collection:module-soprano.collection}\index{soprano.collection (module)}
Contains all modules, classes and functions relevant
to handling, loading or randomly generating
collections of structures.


\paragraph{Subpackages}
\label{doctree/soprano.collection:subpackages}

\subparagraph{soprano.collection.generate package}
\label{doctree/soprano.collection.generate:module-soprano.collection.generate}\label{doctree/soprano.collection.generate:soprano-collection-generate-package}\label{doctree/soprano.collection.generate::doc}\index{soprano.collection.generate (module)}
This module contains generators meant to produce AtomsCollections based
on different criteria.


\subparagraph{Submodules}
\label{doctree/soprano.collection.generate:submodules}

\subparagraph{soprano.collection.generate.airss module}
\label{doctree/soprano.collection.generate.airss::doc}\label{doctree/soprano.collection.generate.airss:module-soprano.collection.generate.airss}\label{doctree/soprano.collection.generate.airss:soprano-collection-generate-airss-module}\index{soprano.collection.generate.airss (module)}
Bindings for AIRSS Buildcell program for random structure generation
\index{airssGen() (in module soprano.collection.generate.airss)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.generate.airss:soprano.collection.generate.airss.airssGen}\pysiglinewithargsret{\sphinxcode{soprano.collection.generate.airss.}\sphinxbfcode{airssGen}}{\emph{input\_file}, \emph{n=100}, \emph{buildcell\_command=u'buildcell'}, \emph{buildcell\_path=None}, \emph{clone\_calc=True}}{}
Generator function binding to AIRSS' Buildcell.

This function searches for a buildcell executable and uses it to
generate multiple new Atoms structures for a collection.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] input\_file (str or file): the .cell file with appropriate comments
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] specifying the details of buildcell's
\item[] construction work.
\end{DUlineblock}
\item[] n (int): number of structures to generate. If set to None the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] generator goes on indefinitely.
\end{DUlineblock}
\item[] buildcell\_command (str): command required to call the buildcell
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] executable.
\end{DUlineblock}
\item[] buildcell\_path (str): path where the buildcell executable can be
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] found. If not present, the buildcell command
\item[] will be invoked directly (assuming the
\item[] executable is in the system PATH).
\end{DUlineblock}
\item[] clone\_calc (bool): if True, the CASTEP calculator in the input file
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] will be copied and attached to the new structures.
\item[] This means that for example any additional CASTEP
\item[] keywords/blocks in the input file will be carried
\item[] on to the new structures. Default is True.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] airssGenerator (generator): an iterable object that yields structures
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] created by buildcell.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}



\subparagraph{soprano.collection.generate.defect module}
\label{doctree/soprano.collection.generate.defect:module-soprano.collection.generate.defect}\label{doctree/soprano.collection.generate.defect::doc}\label{doctree/soprano.collection.generate.defect:soprano-collection-generate-defect-module}\index{soprano.collection.generate.defect (module)}
Generator producing structures with a randomly positioned point defect
\index{additionGen() (in module soprano.collection.generate.defect)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.generate.defect:soprano.collection.generate.defect.additionGen}\pysiglinewithargsret{\sphinxcode{soprano.collection.generate.defect.}\sphinxbfcode{additionGen}}{\emph{struct}, \emph{add}, \emph{to\_addition=None}, \emph{n=1}, \emph{add\_r=1.2}, \emph{accept=None}}{}
Generator function to create multiple structures with an atom of a
given element added in the existing cell. The atoms will be attached to 
the atoms passed in the to\_addition selection. If none is passed,
all atoms will be additioned in turn. Multiple defects can be included, in
which case all permutations will be generated. The algorithm will try
adding the atom in the direction that seems most compatible with all the
already existing bonds. If multiple directions satisfy the condition, they
will all be tested.
It is also possible to reject some configurations based on the output of a
filter function.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] struct (ase.Atoms): the starting structure. All atoms will be added
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] to it.
\end{DUlineblock}
\item[] add (str): element symbol of the atom to add.
\item[] to\_replace (AtomSelection): if present, only atoms belonging to this
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] selection will be substituted.
\end{DUlineblock}
\item[] n (int): number of new atoms to include in each structure. Default
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] is 1.
\end{DUlineblock}
\item[] add\_r (float): distance, in Angstroms, at which to add the atoms.
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Default is 1.2 Ang
\end{DUlineblock}
\item[] accept (function): a function that determines whether a generated
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] structure should be accepted or rejected. Takes as
\item[] input the generated structure and a tuple of
\item[] the indices of the atoms to which the new atoms
\item[] were added, and must return a bool. The newly added
\item[] atoms will always be the last n of the structure.
\item[] If False, the structure will be rejected.
\end{DUlineblock}
\end{DUlineblock}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] defectGenerator (generator): an iterator object that yields
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] structures with all possible additions.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{defectGen() (in module soprano.collection.generate.defect)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.generate.defect:soprano.collection.generate.defect.defectGen}\pysiglinewithargsret{\sphinxcode{soprano.collection.generate.defect.}\sphinxbfcode{defectGen}}{\emph{struct}, \emph{defect}, \emph{poisson\_r=None}, \emph{avoid\_atoms=True}, \emph{vdw\_set=u'jmol'}, \emph{vdw\_scale=1}, \emph{max\_attempts=30}}{}
Generator function to create multiple structures with a defect of a
given element randomly added to the existing cell. The defects can be
distributed following a random uniform distribution or a Poisson-sphere
distribution which guarantees that no two defects are created closer than
a certain distance. These are created using a variation on Bridson's
algorithm. For that reason the defects will be created contiguously and
added in succession. A full cover of all the empty space will be provided
only by extracting structures until StopIteration is raised.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] struct (ase.Atoms): the starting structure. All defects will be added
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] to it.
\end{DUlineblock}
\item[] defect (str): element symbol of the defect to add.
\item[] poisson\_r (float): if this argument is present, the Poisson sphere
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] distribution rather than random uniform will be
\item[] used, and this will be the minimum distance in
\item[] Angstroms between the generated defects.
\end{DUlineblock}
\item[] avoid\_atoms (bool): if True, defects too close to the existing atoms
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] in the cell will be rejected. The cutoff distance
\item[] will be estimated based on the Van der Waals radii
\item[] set of choice. Default is True.
\end{DUlineblock}
\item[] vdw\_set(\{ase, jmol\}): set of Van der Waals radii to use. Only relevant
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] if avoid\_atoms is True. Default is the one
\item[] extracted from JMol.
\end{DUlineblock}
\item[] vdw\_scale (float): scaling factor to apply to the base Van der Waals
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] radii values. Only relevant if avoid\_atoms is True.
\item[] Values bigger than one make for larger empty
\item[] volumes around existing atoms.
\end{DUlineblock}
\item[] max\_attempts(int): maximum number of attempts used to generate a
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] random point. When using a uniform distribution,
\item[] this is the maximum number of attempts that will be
\item[] done to avoid existing atoms (if avoid\_atoms is
\item[] False, no attempts are needed). When using a Poisson
\item[] sphere distribution, this is a parameter of the
\item[] Bridson-like algorithm and will include also
\item[] avoiding previously generated defects. Default
\item[] is 30.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] defectGenerator (generator): an iterator object that yields
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] structures with randomly distributed
\item[] defects.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{substitutionGen() (in module soprano.collection.generate.defect)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.generate.defect:soprano.collection.generate.defect.substitutionGen}\pysiglinewithargsret{\sphinxcode{soprano.collection.generate.defect.}\sphinxbfcode{substitutionGen}}{\emph{struct}, \emph{subst}, \emph{to\_replace=None}, \emph{n=1}, \emph{accept=None}}{}
Generator function to create multiple structures with a defect of a
given element substituted in the existing cell. The defects will be put in
place of the atoms passed in the to\_replace selection. If none is passed,
all atoms will be replaced in turn. Multiple defects can be included, in
which case all permutations will be generated.
It is also possible to reject some configurations based on the output of a
filter function.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] struct (ase.Atoms): the starting structure. All defects will be added
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] to it.
\end{DUlineblock}
\item[] subst (str): element symbol of the defect to add.
\item[] to\_replace (AtomSelection): if present, only atoms belonging to this
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] selection will be substituted.
\end{DUlineblock}
\item[] n (int): number of defects to include in each structure. Default is 1.
\item[] accept (function): a function that determines whether a generated
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] structure should be accepted or rejected. Takes as
\item[] input the generated structure and a tuple of the
\item[] indices of the substituted atoms, and must return a
\item[] bool. If False, the structure will be rejected.
\end{DUlineblock}
\end{DUlineblock}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] defectGenerator (generator): an iterator object that yields
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] structures with all possible
\item[] substitutions.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}



\subparagraph{soprano.collection.generate.linspace module}
\label{doctree/soprano.collection.generate.linspace::doc}\label{doctree/soprano.collection.generate.linspace:soprano-collection-generate-linspace-module}\label{doctree/soprano.collection.generate.linspace:module-soprano.collection.generate.linspace}\index{soprano.collection.generate.linspace (module)}
Generator producing structures interpolated between two extremes
\index{linspaceGen() (in module soprano.collection.generate.linspace)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.generate.linspace:soprano.collection.generate.linspace.linspaceGen}\pysiglinewithargsret{\sphinxcode{soprano.collection.generate.linspace.}\sphinxbfcode{linspaceGen}}{\emph{struct\_0}, \emph{struct\_1}, \emph{steps=10}, \emph{periodic=False}}{}
Generator function to create multiple structures with positions
interpolated linearly between two extremes.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] struct\_0 (ase.Atoms): the starting structure
\item[] struct\_1 (ase.Atoms): the final structure. The atoms should be in the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] same order as the ones in struct\_0
\end{DUlineblock}
\item[] steps (Optional{[}int{]}): number of interpolated steps to produce
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] (extremes included). Default is 10
\end{DUlineblock}
\item[] periodic (Optional{[}bool{]}): if True the interpolation will take into
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] account periodic boundaries and interpolate
\item[] between positions in struct\_0 and the
\item[] closest periodic copy of positions in
\item[] struct\_1. By default set to False
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] linspaceGenerator (generator): an iterator object that yields
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] structures created by linear
\item[] interpolation.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}



\subparagraph{soprano.collection.generate.rattle module}
\label{doctree/soprano.collection.generate.rattle::doc}\label{doctree/soprano.collection.generate.rattle:soprano-collection-generate-rattle-module}\label{doctree/soprano.collection.generate.rattle:module-soprano.collection.generate.rattle}\index{soprano.collection.generate.rattle (module)}
Generator producing structures rattled of a given amount
\index{rattleGen() (in module soprano.collection.generate.rattle)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.generate.rattle:soprano.collection.generate.rattle.rattleGen}\pysiglinewithargsret{\sphinxcode{soprano.collection.generate.rattle.}\sphinxbfcode{rattleGen}}{\emph{struct}, \emph{amplitude=0.01}, \emph{n=100}, \emph{method=u'uniform'}}{}
Generator function to create multiple structures by randomly displacing
atoms of a given amount.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] struct (ase.Atoms): the starting structure to randomize
\item[] amplitude (float or np.ndarray): the amplitude of the random
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] displacement. Can be a single float
\item[] for all atoms, a 1D numpy array of
\item[] length N (N being the number of
\item[] atoms, one value each) or a 2D numpy
\item[] array of shape (N,3) (one value for
\item[] each dimension).
\item[] These values are used as interval for
\item[] uniform random numbers and as stdev
\item[] for normal random numbers
\end{DUlineblock}
\item[] n (int): maximum number of structures to generate. If set to None will
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] generate infinite structures
\end{DUlineblock}
\item[] method (str): must be either `uniform' or `normal'. In the first case
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] the rattling will be a uniform random number between
\item[] +amplitude and -amplitude. In the second case it will be
\item[] a gaussian random number with +amplitude standard
\item[] deviation.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] rattleGenerator (generator): an iterator that yields copies of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] base structure with randomly displaced
\item[] atoms.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}



\subparagraph{soprano.collection.generate.transform module}
\label{doctree/soprano.collection.generate.transform:module-soprano.collection.generate.transform}\label{doctree/soprano.collection.generate.transform:soprano-collection-generate-transform-module}\label{doctree/soprano.collection.generate.transform::doc}\index{soprano.collection.generate.transform (module)}
Generator producing structures by repeatedly applying a transform
\index{transformGen() (in module soprano.collection.generate.transform)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.generate.transform:soprano.collection.generate.transform.transformGen}\pysiglinewithargsret{\sphinxcode{soprano.collection.generate.transform.}\sphinxbfcode{transformGen}}{\emph{struct\_0}, \emph{transform}, \emph{steps=10}}{}
Generator function to create multiple structures with positions
interpolated linearly between two extremes.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] struct\_0 (ase.Atoms): the starting structure
\item[] transform (function): the transform to apply on the given structure.
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Must accept and return a structure as only
\item[] arguments. Instances of all transforms from the
\item[] soprano.properties.transform module satisfy
\item[] these conditions.
\end{DUlineblock}
\item[] steps (Optional{[}int{]}): number of times to apply the transform.
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Default is 10
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] linspaceGenerator (generator): an iterator object that yields
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] structures created by linear
\item[] interpolation.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}



\paragraph{Submodules}
\label{doctree/soprano.collection:submodules}

\subparagraph{soprano.collection.collection module}
\label{doctree/soprano.collection.collection:module-soprano.collection.collection}\label{doctree/soprano.collection.collection::doc}\label{doctree/soprano.collection.collection:soprano-collection-collection-module}\index{soprano.collection.collection (module)}
Definition of the Collection class.

It handles multiple Atoms ASE objects and mirrors in this sense the structure
of the Atoms object itself.
\index{AtomsCollection (class in soprano.collection.collection)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.collection:soprano.collection.collection.AtomsCollection}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.collection.collection.}\sphinxbfcode{AtomsCollection}}{\emph{structures={[}{]}}, \emph{info=\{\}}, \emph{cell\_reduce=False}, \emph{progress=False}, \emph{suppress\_ase\_warnings=True}}{}
Bases: \sphinxcode{object}

AtomsCollection object.

An AtomsCollection represents a group of ASE Atoms objects.
It handles them together, can perform mass operations on them, and stores
arrays of informations related to them.

Initialize the AtomsCollection

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] structures (list{[}str{]} or list{[}ase.Atoms{]}): list of file names or
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Atoms that will form
\item[] the collection
\end{DUlineblock}
\item[] info (dict): dictionary of general information to attach
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] to this collection
\end{DUlineblock}
\item[] cell\_reduce (bool): if True, perform a Niggli cell reduction on
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] all loaded structures
\end{DUlineblock}
\item[] progress (bool): visualize a progress bar for the loading process
\item[] suppress\_ase\_warnings (bool): suppress annoying ASE warnings when
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] loading files (default is True)
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\index{all (soprano.collection.collection.AtomsCollection attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.collection:soprano.collection.collection.AtomsCollection.all}\pysigline{\sphinxbfcode{all}}
\end{fulllineitems}

\index{chunkify() (soprano.collection.collection.AtomsCollection method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.collection:soprano.collection.collection.AtomsCollection.chunkify}\pysiglinewithargsret{\sphinxbfcode{chunkify}}{\emph{chunk\_size=None}, \emph{chunk\_n=None}}{}
Split this collection into multiple collections based on either
size or number of chunks.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] chunk\_size (Optional{[}int{]}): maximum size of a generated chunk
\item[] chunk\_n (Optional{[}int{]}): number of chunks to generate
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] chunks (list{[}AtomsCollection{]}): a list of the generated chunks
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{filter() (soprano.collection.collection.AtomsCollection method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.collection:soprano.collection.collection.AtomsCollection.filter}\pysiglinewithargsret{\sphinxbfcode{filter}}{\emph{filter\_func}}{}
Return a collection composed only of the elements for which a given
filter function returns True.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] filter\_func (function\textless{}Atoms\textgreater{}
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] =\textgreater{} bool): filter function. Should take an
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Atoms object and return a boolean
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] filtered (AtomsCollection): the filtered version of the collection
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{get\_array() (soprano.collection.collection.AtomsCollection method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.collection:soprano.collection.collection.AtomsCollection.get_array}\pysiglinewithargsret{\sphinxbfcode{get\_array}}{\emph{name}, \emph{copy=True}}{}
Get a copy of an array of given name (or a reference if copy=False)

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): name of the array to retrieve.
\item[] copy (bool): if the array should be copied or a reference should
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] be returned instead.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] array (np.ndarray): the requested array
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{has() (soprano.collection.collection.AtomsCollection method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.collection:soprano.collection.collection.AtomsCollection.has}\pysiglinewithargsret{\sphinxbfcode{has}}{\emph{name}}{}
Check if array of given name exists

\end{fulllineitems}

\index{length (soprano.collection.collection.AtomsCollection attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.collection:soprano.collection.collection.AtomsCollection.length}\pysigline{\sphinxbfcode{length}}
\end{fulllineitems}

\index{load() (soprano.collection.collection.AtomsCollection static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.collection:soprano.collection.collection.AtomsCollection.load}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{load}}{\emph{filename}}{}
Load a pickled copy from a given file path

\end{fulllineitems}

\index{run\_calculators() (soprano.collection.collection.AtomsCollection method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.collection:soprano.collection.collection.AtomsCollection.run_calculators}\pysiglinewithargsret{\sphinxbfcode{run\_calculators}}{\emph{properties=None}, \emph{system\_changes=None}}{}
Run all previously set ASE calculators.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] properties (list{[}str{]}): list of properties to calculate (depends
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] on type of Calculator used)
\end{DUlineblock}
\item[] system\_changes (list{[}str{]}): list of changes to the structure
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] since the last calculation. Can be
\item[] any combination of these five:
\item[] `positions', `numbers', `cell',
\item[] `pbc', `initial\_charges' and
\item[] `initial\_magmoms'.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{save() (soprano.collection.collection.AtomsCollection method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.collection:soprano.collection.collection.AtomsCollection.save}\pysiglinewithargsret{\sphinxbfcode{save}}{\emph{filename}}{}
Simply save a pickled copy to a given file path

\end{fulllineitems}

\index{set\_array() (soprano.collection.collection.AtomsCollection method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.collection:soprano.collection.collection.AtomsCollection.set_array}\pysiglinewithargsret{\sphinxbfcode{set\_array}}{\emph{name}, \emph{a}, \emph{dtype=None}, \emph{shape=None}, \emph{args=\{\}}}{}
Add or modify an array of data related to the Atoms objects
in this collection.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): name of the array to operate on.
\item[] a (np.ndarray or function\textless{}Atoms, **kwargs\textgreater{}
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] =\textgreater{} Any): the data to assign to the array (must
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] be same length as the collection) or
\item[] a function that takes an Atoms object
\item[] as the first argument and returns a
\item[] value. This will be mapped over the
\item[] structures to create the array.
\end{DUlineblock}
\end{DUlineblock}
\item[] dtype (type): type to cast the values of the array to.
\item[] shape (tuple {[}int{]}): shape of each entry of the array. Will be
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] checked if provided.
\end{DUlineblock}
\item[] args (dict): named arguments to pass to the function provided
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] as a. Will be ignored if an array is passed instead.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{set\_calculators() (soprano.collection.collection.AtomsCollection method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.collection:soprano.collection.collection.AtomsCollection.set_calculators}\pysiglinewithargsret{\sphinxbfcode{set\_calculators}}{\emph{calctype}, \emph{labels=None}, \emph{params=\{\}}}{}
Set an ASE calculator on each structure in the collection,
and set said calculator's parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] calctype (ASE Calculator type): the type of calculator
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] to instantiate.
\end{DUlineblock}
\item[] labels (Optional{[}list{[}str{]}{]}): names to use for the calculators'
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] files. If not present, random
\item[] generated names are used.
\end{DUlineblock}
\item[] params (Optional{[}dict{]}): parameters of the calculator to set.
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{sorted\_byarray() (soprano.collection.collection.AtomsCollection method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.collection.collection:soprano.collection.collection.AtomsCollection.sorted_byarray}\pysiglinewithargsret{\sphinxbfcode{sorted\_byarray}}{\emph{name}, \emph{reverse=False}}{}
Return a copy of this collection sorted by a given array.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): name of the array to use for the sorting
\item[] reverse (Optional{[}bool{]}): reverse order of sorting (max to min)
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] sorted (AtomsCollection): a sorted copy of the collection
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}


\end{fulllineitems}



\subsubsection{soprano.hpc package}
\label{doctree/soprano.hpc:module-soprano.hpc}\label{doctree/soprano.hpc:soprano-hpc-package}\label{doctree/soprano.hpc::doc}\index{soprano.hpc (module)}
Classes and functions useful to run calculations on huge cluster systems
(High Performance Computation). To be used with care - these are liable to
fail if some specific architecture has quirks that are not accounted for!


\paragraph{Subpackages}
\label{doctree/soprano.hpc:subpackages}

\subparagraph{soprano.hpc.submitter package}
\label{doctree/soprano.hpc.submitter:soprano-hpc-submitter-package}\label{doctree/soprano.hpc.submitter::doc}\label{doctree/soprano.hpc.submitter:module-soprano.hpc.submitter}\index{soprano.hpc.submitter (module)}
Classes and functions required for processes that automatically submit jobs
to a queueing system working in the background.

These can be launched interactively from the command line. In order to do
that:
\begin{enumerate}
\item {} 
write your own implementation of a submitter class by inheriting from
soprano.hpc.submitter.Submitter or use one of the provided ones;

\item {} 
write an input file in which you simply create an instance of said class
and set up its parameters (ideally by calling the set\_parameters method);

\item {} 
launch that submitter from the command line with the following command:
\begin{quote}

\sphinxcode{python -m soprano.hpc.submitter start \textless{}filename\textgreater{}}
\end{quote}

\end{enumerate}

You can have multiple submitter instances, even of different types, defined
in the same file: in that case you will need to use the -n option to specify
which one you want to launch (the name you need to use is the name of the
\emph{variable} you stored the instance in). If you are working on remote login and
you want to prevent the submitter from being terminated upon exiting your
session use the -nohup option.
To list which submitters from a given file are running, and how long have they
been running for, just use:
\begin{quote}

\sphinxcode{python -m soprano.hpc.submitter list \textless{}filename\textgreater{}}
\end{quote}

Similarly, you can stop a running submitter with:
\begin{quote}

\sphinxcode{python -m soprano.hpc.submitter stop \textless{}filename\textgreater{}}
\end{quote}

Submitters have a `name' property and will save a \textless{}name\textgreater{}.log file in which any
output from their run can be stored.


\subparagraph{Subpackages}
\label{doctree/soprano.hpc.submitter:subpackages}

\subparagraph{soprano.hpc.submitter.debug package}
\label{doctree/soprano.hpc.submitter.debug:module-soprano.hpc.submitter.debug}\label{doctree/soprano.hpc.submitter.debug:soprano-hpc-submitter-debug-package}\label{doctree/soprano.hpc.submitter.debug::doc}\index{soprano.hpc.submitter.debug (module)}
Functions useful for debugging QueueInterface and Submitters. These
provide a `fake' queue that executes basic jobs with artificial delays
in order to simulate an environment similar to what can be found on an HPC
machine.


\subparagraph{Submodules}
\label{doctree/soprano.hpc.submitter.debug:submodules}

\subparagraph{soprano.hpc.submitter.debug.debugqueue module}
\label{doctree/soprano.hpc.submitter.debug.debugqueue:soprano-hpc-submitter-debug-debugqueue-module}\label{doctree/soprano.hpc.submitter.debug.debugqueue::doc}\label{doctree/soprano.hpc.submitter.debug.debugqueue:module-soprano.hpc.submitter.debug.debugqueue}\index{soprano.hpc.submitter.debug.debugqueue (module)}
Definition of a fake QueueInterface class, useful for debugging Submitters.
\index{DebugQueueInterface (class in soprano.hpc.submitter.debug.debugqueue)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.debug.debugqueue:soprano.hpc.submitter.debug.debugqueue.DebugQueueInterface}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.hpc.submitter.debug.debugqueue.}\sphinxbfcode{DebugQueueInterface}}{\emph{dt=0.1}}{}
Bases: {\hyperref[doctree/soprano.hpc.submitter.queues:soprano.hpc.submitter.queues.QueueInterface]{\sphinxcrossref{\sphinxcode{soprano.hpc.submitter.queues.QueueInterface}}}}

DebugQueueInterface object

A class meant to emulate a QueueInterface while doing absolutely nothing
of what it does. Jobs are simply stored locally, there's a fixed waiting
time, and are then executed. Ideally they should be simple, quick stuff
(like an echo command). No guarantees for actually long jobs.

In the submitted script a syntax for additional variables is allowed,
similar to real queue systems. These follow the convention of many engines
of having to start with \#\$. For example

\#\$ WAIT 10

means the job will be put in a ``wait'' state for 10 seconds. The currently
available variables are:

WAIT - specify how long the job has to stay in a ``wait'' state. If two
values are provided, these are considered bounds for a random number
RUN - same as above, but for the running state. This has no bearing on the
\emph{actual} running time (it's suggested that it's something very quick)

Initialize the DebugQueueInterface.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] dt (float): frequency with which the queue status is updated
\end{DUlineblock}
\end{DUlineblock}
\index{kill() (soprano.hpc.submitter.debug.debugqueue.DebugQueueInterface method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.debug.debugqueue:soprano.hpc.submitter.debug.debugqueue.DebugQueueInterface.kill}\pysiglinewithargsret{\sphinxbfcode{kill}}{\emph{job\_id}}{}
Kill the job with the given ID

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] job\_id (str): ID of the job to kill
\item[] 
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{list() (soprano.hpc.submitter.debug.debugqueue.DebugQueueInterface method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.debug.debugqueue:soprano.hpc.submitter.debug.debugqueue.DebugQueueInterface.list}\pysiglinewithargsret{\sphinxbfcode{list}}{}{}
List all jobs found in the queue

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] jobs (dict): a dict of jobs classified by ID containing all info
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] that can be matched through list\_outre
\item[] 
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{submit() (soprano.hpc.submitter.debug.debugqueue.DebugQueueInterface method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.debug.debugqueue:soprano.hpc.submitter.debug.debugqueue.DebugQueueInterface.submit}\pysiglinewithargsret{\sphinxbfcode{submit}}{\emph{script}, \emph{cwd=None}}{}
Submit a job to the queue.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] script (str): content of the submission script
\item[] cwd (Optional{[}str{]}): path to the desired working directory
\item[] 
\end{DUlineblock}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] job\_id (str): the job ID assigned by the queue system and parsed
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] with sub\_outre
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}


\end{fulllineitems}



\subparagraph{Submodules}
\label{doctree/soprano.hpc.submitter:submodules}

\subparagraph{soprano.hpc.submitter.castep module}
\label{doctree/soprano.hpc.submitter.castep:module-soprano.hpc.submitter.castep}\label{doctree/soprano.hpc.submitter.castep::doc}\label{doctree/soprano.hpc.submitter.castep:soprano-hpc-submitter-castep-module}\index{soprano.hpc.submitter.castep (module)}
Definition of CastepSubmitter class.

A basic ``rolling'' submitter for Castep calculations, grabbing from one folder
and depositing results in another.
\index{CastepSubmitter (class in soprano.hpc.submitter.castep)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.castep:soprano.hpc.submitter.castep.CastepSubmitter}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.hpc.submitter.castep.}\sphinxbfcode{CastepSubmitter}}{\emph{name, queue, submit\_script, max\_jobs=4, check\_time=10, max\_time=3600, temp\_folder=None, remote\_workdir=None, remote\_getfiles={[}u'*.*'{]}, ssh\_timeout=1.0, continuation=False}}{}
Bases: {\hyperref[doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter]{\sphinxcrossref{\sphinxcode{soprano.hpc.submitter.submit.Submitter}}}}

Initialize the Submitter object

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): name to be used for this Submitter (two Submitters
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] with the same name can't be launched in the same
\item[] working directory)
\end{DUlineblock}
\item[] queue (QueueInterface): object describing the properties of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] interface to the queue system in use
\end{DUlineblock}
\item[] submit\_script (str): text of the script to use when submitting a
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] job to the queue. All tags of the form \textless{}name\textgreater{}
\item[] will be replaced with the job's name, and all
\item[] similar tags of the form \textless{}{[}arg{]}\textgreater{} will be
\item[] replaced if the argument name is present in
\item[] the job's args dictionary
\end{DUlineblock}
\item[] max\_jobs (Optional{[}int{]}): maximum number of jobs to submit at a
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] given time. Default is 4
\end{DUlineblock}
\item[] check\_time (Optional{[}float{]}): time in seconds between consecutive
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] checks for the queue status and
\item[] attempts to submit new jobs. Default
\item[] is 10
\end{DUlineblock}
\item[] max\_time (Optional{[}float{]}): time in seconds the Submitter will run
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] for before shutting down. If set to
\item[] zero the thread won't stop until
\item[] killed with Submitter.stop.
\end{DUlineblock}
\item[] temp\_folder (Optional{[}str{]}): where to store the temporary folders
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] for the calculations. By default it's
\item[] the current folder.
\end{DUlineblock}
\item[] remote\_workdir (Optional{[}str{]}): if present, uses a directory on a
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] remote machine by logging in via
\item[] SSH. Must be in the format
\item[] \textless{}host\textgreater{}:\textless{}path/to/directory\textgreater{}.
\item[] Host must be defined in the user's
\item[] \textasciitilde{}/.ssh/config file - check the
\item[] docs for RemoteTarget for more
\item[] information. It is possible to
\item[] omit the colon and directory, that
\item[] will use the home directory of the
\item[] given folder; that is HEAVILY
\item[] DISCOURAGED though. Best practice
\item[] would be to create an empty
\item[] directory on the remote machine
\item[] and use that, to avoid accidental
\item[] overwriting/deleting of important
\item[] files.
\end{DUlineblock}
\item[] remote\_getfiles (Optional{[}list(str){]}): list of files to be
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] downloaded from the remote
\item[] copy of the job's temporary
\item[] directory. By default, all
\item[] of them. Can be a list
\item[] using specific names,
\item[] wildcards etc. Filenames
\item[] can also use the
\item[] placeholder \{name\} to
\item[] signify the job name, as
\item[] well as any other element
\item[] from the arguments.
\end{DUlineblock}
\item[] ssh\_timeout (Optional{[}float{]}): connection timeout in seconds
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] (default is 1 second)
\end{DUlineblock}
\item[] continuation (Optional{[}bool{]}): if True, when the Submitter is
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] stopped it will not terminate the
\item[] current jobs; rather, it will store
\item[] the list in a pickle file.
\item[] If the submitter is ran from the
\item[] same folder then it will ``pick up
\item[] from where it left'' and try
\item[] recovering those jobs, then
\item[] restart. If one wishes for
\item[] additional values to be saved and
\item[] restored, the save\_state and
\item[] load\_state methods need to be
\item[] defined.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\index{finish\_job() (soprano.hpc.submitter.castep.CastepSubmitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.castep:soprano.hpc.submitter.castep.CastepSubmitter.finish_job}\pysiglinewithargsret{\sphinxbfcode{finish\_job}}{\emph{name}, \emph{args}, \emph{folder}}{}
Save required output files to the output folder

\end{fulllineitems}

\index{finish\_run() (soprano.hpc.submitter.castep.CastepSubmitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.castep:soprano.hpc.submitter.castep.CastepSubmitter.finish_run}\pysiglinewithargsret{\sphinxbfcode{finish\_run}}{}{}
Try removing the temporary keywords directory

\end{fulllineitems}

\index{next\_job() (soprano.hpc.submitter.castep.CastepSubmitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.castep:soprano.hpc.submitter.castep.CastepSubmitter.next_job}\pysiglinewithargsret{\sphinxbfcode{next\_job}}{}{}
Grab the next job from folder\_in

\end{fulllineitems}

\index{set\_parameters() (soprano.hpc.submitter.castep.CastepSubmitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.castep:soprano.hpc.submitter.castep.CastepSubmitter.set_parameters}\pysiglinewithargsret{\sphinxbfcode{set\_parameters}}{\emph{folder\_in, folder\_out, castep\_command, castep\_path=None, copy\_extensions={[}u'.castep'{]}, pspot\_files={[}{]}, dryrun\_test=False}}{}
Set the parameters of the CASTEP Submitter

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] folder\_in (str): path of the folder to extract cell files from
\item[] folder\_out (str): path of the folder where the results will be
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] saved
\end{DUlineblock}
\item[] castep\_command (str): command used to call the CASTEP executable
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] on this system
\end{DUlineblock}
\item[] castep\_path (Optional{[}str{]}): folder where the CASTEP executable is
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] located (if not part of the system
\item[] PATH)
\end{DUlineblock}
\item[] pspot\_files (Optional{[}list{[}str{]}{]}): additional pseudopotential
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] files to be copied in the input
\item[] temporary folders
\end{DUlineblock}
\item[] copy\_extensions (Optional{[}list{[}str{]}{]}): extensions of output files
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] to copy to the output
\item[] folder (by default only
\item[] .castep file)
\end{DUlineblock}
\item[] dryrun\_test (Optional{[}bool{]}): run a dryrun test on files before
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] actually running the calculation.
\item[] Off by default.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{setup\_job() (soprano.hpc.submitter.castep.CastepSubmitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.castep:soprano.hpc.submitter.castep.CastepSubmitter.setup_job}\pysiglinewithargsret{\sphinxbfcode{setup\_job}}{\emph{name}, \emph{args}, \emph{folder}}{}
Copy files to temporary folder to prepare for execution

\end{fulllineitems}

\index{start\_run() (soprano.hpc.submitter.castep.CastepSubmitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.castep:soprano.hpc.submitter.castep.CastepSubmitter.start_run}\pysiglinewithargsret{\sphinxbfcode{start\_run}}{}{}
\end{fulllineitems}


\end{fulllineitems}



\subparagraph{soprano.hpc.submitter.queues module}
\label{doctree/soprano.hpc.submitter.queues::doc}\label{doctree/soprano.hpc.submitter.queues:module-soprano.hpc.submitter.queues}\label{doctree/soprano.hpc.submitter.queues:soprano-hpc-submitter-queues-module}\index{soprano.hpc.submitter.queues (module)}
Definition of QueueInterface class.
\index{QueueInterface (class in soprano.hpc.submitter.queues)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.queues:soprano.hpc.submitter.queues.QueueInterface}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.hpc.submitter.queues.}\sphinxbfcode{QueueInterface}}{\emph{sub\_cmd}, \emph{list\_cmd}, \emph{kill\_cmd}, \emph{sub\_outre}, \emph{list\_outre}, \emph{list\_user\_opt=None}}{}
Bases: \sphinxcode{object}

QueueInterface object

A class meant to simplify interfacing in a basic way
with a Queue system. Contains commands to submit to the queue, list the
job IDs, and kill them if necessary. Will contain Regexps to parse for IDs
and additional information as returned upon submission and listing.
It is important that the regular expressions used employ NAMED GROUPS to
parse the various fields. In particular, a job\_id group must ALWAYS be
present.
The class also provides some static variables implementing standard
interfaces for common queueing systems. These can be retrieved by using
QueueInterface.\textless{}NAME\textgreater{}. The currently implemented names are the following:
\begin{itemize}
\item {} 
LSF (IBM's managing system, using the command bsub)

\item {} \begin{description}
\item[{GridEngine (Sun's managing system, also available in an open version,}] \leavevmode
using the command qsub)

\end{description}

\item {} 
PBS (another managing system using qsub)

\end{itemize}

Initialize the QueueInterface.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] sub\_cmd (str): command used to submit a script to the queue
\item[] list\_cmd (str): command used to list all queued jobs for the user
\item[] kill\_cmd (str): command used to kill a job given its id
\item[] sub\_outre (str): regular expression used to parse the output of
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] sub\_cmd. Must contain at least a job\_id named
\item[] group
\end{DUlineblock}
\item[] list\_outre (str): regular expression used to parse the output of
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] list\_cmd. Must contain at least a job\_id named
\item[] group
\end{DUlineblock}
\item[] list\_user\_opt (Optional{[}str{]}): name of the option for passing a
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] specific user name when listing
\item[] jobs. For example, on LSF this is
\item[] -u. By default it's None, and the
\item[] default of the queueing system is
\item[] used.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\index{GridEngine() (soprano.hpc.submitter.queues.QueueInterface class method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.queues:soprano.hpc.submitter.queues.QueueInterface.GridEngine}\pysiglinewithargsret{\sphinxstrong{classmethod }\sphinxbfcode{GridEngine}}{}{}
\end{fulllineitems}

\index{LSF() (soprano.hpc.submitter.queues.QueueInterface class method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.queues:soprano.hpc.submitter.queues.QueueInterface.LSF}\pysiglinewithargsret{\sphinxstrong{classmethod }\sphinxbfcode{LSF}}{}{}
\end{fulllineitems}

\index{PBS() (soprano.hpc.submitter.queues.QueueInterface class method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.queues:soprano.hpc.submitter.queues.QueueInterface.PBS}\pysiglinewithargsret{\sphinxstrong{classmethod }\sphinxbfcode{PBS}}{}{}
\end{fulllineitems}

\index{kill() (soprano.hpc.submitter.queues.QueueInterface method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.queues:soprano.hpc.submitter.queues.QueueInterface.kill}\pysiglinewithargsret{\sphinxbfcode{kill}}{\emph{job\_id}}{}
Kill the job with the given ID

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] job\_id (str): ID of the job to kill
\item[] 
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{list() (soprano.hpc.submitter.queues.QueueInterface method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.queues:soprano.hpc.submitter.queues.QueueInterface.list}\pysiglinewithargsret{\sphinxbfcode{list}}{\emph{user=u'\$USER'}}{}
List all jobs found in the queue

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] jobs (dict): a dict of jobs classified by ID containing all info
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] that can be matched through list\_outre
\end{DUlineblock}
\item[] user (Optional{[}str{]}): user for whom jobs should be listed. Will
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] not have any effect if list\_user\_opt has not
\item[] been specified. Default is \$USER.
\item[] 
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{remote\_target (soprano.hpc.submitter.queues.QueueInterface attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.queues:soprano.hpc.submitter.queues.QueueInterface.remote_target}\pysigline{\sphinxbfcode{remote\_target}}
RemoteTarget if a remote Host is set

\end{fulllineitems}

\index{set\_remote\_host() (soprano.hpc.submitter.queues.QueueInterface method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.queues:soprano.hpc.submitter.queues.QueueInterface.set_remote_host}\pysiglinewithargsret{\sphinxbfcode{set\_remote\_host}}{\emph{host=None}, \emph{timeout=1.0}}{}
Set a remote host for use by this QueueInterface

If a remote host is set, this Interface will try using the Paramiko
library to connect to it via SSH. Check the docstring of
soprano.hpc.submitter.utils.RemoteTarget to see what the limitations
are for this usage.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] host (Optional{[}str{]}): host name of the remote machine to connect
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] to. Further information must be contained in
\item[] the user's \textasciitilde{}/.ssh/config file. If left empty
\item[] the remote host is UNSET and therefore the
\item[] interface goes back to local use.
\end{DUlineblock}
\item[] timeout (Optional{[}float{]}): connection timeout in seconds (default
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] is 1 second)
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{submit() (soprano.hpc.submitter.queues.QueueInterface method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.queues:soprano.hpc.submitter.queues.QueueInterface.submit}\pysiglinewithargsret{\sphinxbfcode{submit}}{\emph{script}, \emph{cwd=None}}{}
Submit a job to the queue.x

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] script (str): content of the submission script
\item[] cwd (Optional{[}str{]}): path to the desired working directory
\item[] 
\end{DUlineblock}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] job\_id (str): the job ID assigned by the queue system and parsed
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] with sub\_outre
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}


\end{fulllineitems}



\subparagraph{soprano.hpc.submitter.submit module}
\label{doctree/soprano.hpc.submitter.submit:soprano-hpc-submitter-submit-module}\label{doctree/soprano.hpc.submitter.submit::doc}\label{doctree/soprano.hpc.submitter.submit:module-soprano.hpc.submitter.submit}\index{soprano.hpc.submitter.submit (module)}
Definition of Submitter class

Base class for all Submitters to inherit from.
\index{Submitter (class in soprano.hpc.submitter.submit)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.hpc.submitter.submit.}\sphinxbfcode{Submitter}}{\emph{name, queue, submit\_script, max\_jobs=4, check\_time=10, max\_time=3600, temp\_folder=None, remote\_workdir=None, remote\_getfiles={[}u'*.*'{]}, ssh\_timeout=1.0, continuation=False}}{}
Bases: \sphinxcode{object}

Submitter object

Template to derive all specialised Submitters. These are meant to generate,
submit and post-process any number of jobs on a queueing system in the form
of a background process running on a head node. It implements
methods that should be mostly overridden by the child classes.
The following methods define its core behaviour:
\begin{enumerate}
\item {} 
next\_job is the function that outputs the specification for each new job
to submit. The specification should be a dict with two members, `name'
(a string) and `args' (ideally a dict). If no more jobs are available
it should return None;

\item {} 
setup\_job takes as arguments name, args and folder (a temporary one
created independently) and is supposed to generate the input files
for the job before submission. It returns a boolean, confirming that
the setup went well; if False, the job will be skipped;

\item {} 
check\_job takes as arguments job ID, name, args and folder and should
return a bool confirmation of whether the job has finished or not. By
default it simply checks whether the job is still listed in the queue,
however other checks can be implemented in its place;

\item {} 
finish\_job takes as arguments name, args and folder and takes care of
the post processing once a job is complete. Here meaningful data should
be extracted and useful files copied to permament locations, as the
temporary folder will be deleted immediately afterwards. It returns
nothing;

\item {} 
start\_run takes no arguments, executes at the beginning of a run;

\item {} 
finish\_run takes no arguments, executes at the end of a run.

\item {} 
save\_state takes no arguments, returns a dict. It is executed when
continuation=True is used and a run terminates. It will allow the user
to add class-specific data to the dictionary that is stored in the
pickle file (in addition to the default, namely the list and info on
currently running jobs). This should be used for example to store state
information that is necessary for job generation. It should be composed
of serialisable objects.

\item {} 
load\_state takes as arguments the loaded data in dictionary form. It
should perform the reverse operation of save\_state, grabbing the info
and restoring the Submitter's state to its previous condition.

\end{enumerate}

In addition, the Submitter takes a template launching script which can
be tagged with keywords, mainly \textless{}name\textgreater{} for the job name or any other
arguments present in args. These will be replaced with the appropriate
values when the script is submitted.

Initialize the Submitter object

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): name to be used for this Submitter (two Submitters
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] with the same name can't be launched in the same
\item[] working directory)
\end{DUlineblock}
\item[] queue (QueueInterface): object describing the properties of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] interface to the queue system in use
\end{DUlineblock}
\item[] submit\_script (str): text of the script to use when submitting a
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] job to the queue. All tags of the form \textless{}name\textgreater{}
\item[] will be replaced with the job's name, and all
\item[] similar tags of the form \textless{}{[}arg{]}\textgreater{} will be
\item[] replaced if the argument name is present in
\item[] the job's args dictionary
\end{DUlineblock}
\item[] max\_jobs (Optional{[}int{]}): maximum number of jobs to submit at a
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] given time. Default is 4
\end{DUlineblock}
\item[] check\_time (Optional{[}float{]}): time in seconds between consecutive
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] checks for the queue status and
\item[] attempts to submit new jobs. Default
\item[] is 10
\end{DUlineblock}
\item[] max\_time (Optional{[}float{]}): time in seconds the Submitter will run
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] for before shutting down. If set to
\item[] zero the thread won't stop until
\item[] killed with Submitter.stop.
\end{DUlineblock}
\item[] temp\_folder (Optional{[}str{]}): where to store the temporary folders
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] for the calculations. By default it's
\item[] the current folder.
\end{DUlineblock}
\item[] remote\_workdir (Optional{[}str{]}): if present, uses a directory on a
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] remote machine by logging in via
\item[] SSH. Must be in the format
\item[] \textless{}host\textgreater{}:\textless{}path/to/directory\textgreater{}.
\item[] Host must be defined in the user's
\item[] \textasciitilde{}/.ssh/config file - check the
\item[] docs for RemoteTarget for more
\item[] information. It is possible to
\item[] omit the colon and directory, that
\item[] will use the home directory of the
\item[] given folder; that is HEAVILY
\item[] DISCOURAGED though. Best practice
\item[] would be to create an empty
\item[] directory on the remote machine
\item[] and use that, to avoid accidental
\item[] overwriting/deleting of important
\item[] files.
\end{DUlineblock}
\item[] remote\_getfiles (Optional{[}list(str){]}): list of files to be
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] downloaded from the remote
\item[] copy of the job's temporary
\item[] directory. By default, all
\item[] of them. Can be a list
\item[] using specific names,
\item[] wildcards etc. Filenames
\item[] can also use the
\item[] placeholder \{name\} to
\item[] signify the job name, as
\item[] well as any other element
\item[] from the arguments.
\end{DUlineblock}
\item[] ssh\_timeout (Optional{[}float{]}): connection timeout in seconds
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] (default is 1 second)
\end{DUlineblock}
\item[] continuation (Optional{[}bool{]}): if True, when the Submitter is
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] stopped it will not terminate the
\item[] current jobs; rather, it will store
\item[] the list in a pickle file.
\item[] If the submitter is ran from the
\item[] same folder then it will ``pick up
\item[] from where it left'' and try
\item[] recovering those jobs, then
\item[] restart. If one wishes for
\item[] additional values to be saved and
\item[] restored, the save\_state and
\item[] load\_state methods need to be
\item[] defined.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\index{add\_signal() (soprano.hpc.submitter.submit.Submitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter.add_signal}\pysiglinewithargsret{\sphinxbfcode{add\_signal}}{\emph{command}, \emph{callback}}{}
Add a signal listener to this submitter. Unix systems only allow
for up to TWO user-defined signals to be specified.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] command (str): command that should be used to call this signal.
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] This would be used as:
\item[] python -m soprano.hpc.submitter \textless{}command\textgreater{} \textless{}file\textgreater{}
\item[] and will trigger the callback's execution
\end{DUlineblock}
\item[] callback (function\textless{}self\textgreater{} =\textgreater{} None): method of the user defined
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Submitter class to use as a callback when the
\item[] given signal is sent. Should accept and return
\item[] nothing.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{check\_job() (soprano.hpc.submitter.submit.Submitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter.check_job}\pysiglinewithargsret{\sphinxbfcode{check\_job}}{\emph{job\_id}, \emph{name}, \emph{args}, \emph{folder}}{}
Checks if given job is complete or not

\end{fulllineitems}

\index{finish\_job() (soprano.hpc.submitter.submit.Submitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter.finish_job}\pysiglinewithargsret{\sphinxbfcode{finish\_job}}{\emph{name}, \emph{args}, \emph{folder}}{}
Performs completion operations on the job. At this point any
relevant output files should be copied from `folder' to their final
destination as the temporary folder itself will be deleted immediately
after

\end{fulllineitems}

\index{finish\_run() (soprano.hpc.submitter.submit.Submitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter.finish_run}\pysiglinewithargsret{\sphinxbfcode{finish\_run}}{}{}
Operations to perform after the daemon thread stops running

\end{fulllineitems}

\index{list() (soprano.hpc.submitter.submit.Submitter static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter.list}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{list}}{}{}
\end{fulllineitems}

\index{load\_state() (soprano.hpc.submitter.submit.Submitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter.load_state}\pysiglinewithargsret{\sphinxbfcode{load\_state}}{\emph{loaded}}{}
Replace attributes from loaded data in dictionary form

\end{fulllineitems}

\index{log() (soprano.hpc.submitter.submit.Submitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter.log}\pysiglinewithargsret{\sphinxbfcode{log}}{\emph{logtxt}}{}
\end{fulllineitems}

\index{next\_job() (soprano.hpc.submitter.submit.Submitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter.next_job}\pysiglinewithargsret{\sphinxbfcode{next\_job}}{}{}
Return a dictionary definition of the next job in line

\end{fulllineitems}

\index{remove\_signal() (soprano.hpc.submitter.submit.Submitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter.remove_signal}\pysiglinewithargsret{\sphinxbfcode{remove\_signal}}{\emph{command}}{}
Remove a previously defined custom signal by its assigned command.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] command (str): command assigned to the signal handler to remove.
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{save\_state() (soprano.hpc.submitter.submit.Submitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter.save_state}\pysiglinewithargsret{\sphinxbfcode{save\_state}}{}{}
Return a dictionary containing serialisable data to be saved from
one run to the next

\end{fulllineitems}

\index{set\_parameters() (soprano.hpc.submitter.submit.Submitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter.set_parameters}\pysiglinewithargsret{\sphinxbfcode{set\_parameters}}{}{}
Set additional parameters. In this generic example class it has
no arguments, but in specific implementations it will be used to
add more variables without overriding \_\_init\_\_.

\end{fulllineitems}

\index{setup\_job() (soprano.hpc.submitter.submit.Submitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter.setup_job}\pysiglinewithargsret{\sphinxbfcode{setup\_job}}{\emph{name}, \emph{args}, \emph{folder}}{}
Perform preparatory operations on the job

\end{fulllineitems}

\index{start() (soprano.hpc.submitter.submit.Submitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter.start}\pysiglinewithargsret{\sphinxbfcode{start}}{}{}
\end{fulllineitems}

\index{start\_run() (soprano.hpc.submitter.submit.Submitter method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter.start_run}\pysiglinewithargsret{\sphinxbfcode{start\_run}}{}{}
Operations to perform when the daemon thread starts running

\end{fulllineitems}

\index{stop() (soprano.hpc.submitter.submit.Submitter static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.submit:soprano.hpc.submitter.submit.Submitter.stop}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{stop}}{\emph{fname}, \emph{subname}}{}
Stop Submitter process from filename and name,
return False if failed

\end{fulllineitems}


\end{fulllineitems}



\subparagraph{soprano.hpc.submitter.utils module}
\label{doctree/soprano.hpc.submitter.utils:soprano-hpc-submitter-utils-module}\label{doctree/soprano.hpc.submitter.utils:module-soprano.hpc.submitter.utils}\label{doctree/soprano.hpc.submitter.utils::doc}\index{soprano.hpc.submitter.utils (module)}
Utilities for remote submission, especially using Paramiko for SSH
\index{RemoteTarget (class in soprano.hpc.submitter.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.utils:soprano.hpc.submitter.utils.RemoteTarget}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.hpc.submitter.utils.}\sphinxbfcode{RemoteTarget}}{\emph{host}, \emph{timeout=1.0}}{}
Bases: \sphinxcode{object}

RemoteTarget object

Uses Paramiko to embed into one single object all we need to connect
and send orders to some remote machine. It will accept a single host name
as an argument and requires it to be present in the \textasciitilde{}/.ssh/config file
with all relevant parameters. It also must have an ssh key configurated
for access (passwords are NOT accepted as they can't be stored and passed
safely) and must have already been added to known\_hosts (in other words,
you must already have connected to it from the shell).

Initialize the RemoteTarget

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] host (str): the name of the target to connect to, as present
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] in the \textasciitilde{}/.ssh/config file
\end{DUlineblock}
\item[] timeout (Optional{[}float{]}): connection timeout in seconds (default
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] is 1 second)
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\index{context (soprano.hpc.submitter.utils.RemoteTarget attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.utils:soprano.hpc.submitter.utils.RemoteTarget.context}\pysigline{\sphinxbfcode{context}}
Returns a context using this RemoteTarget to connect.
This is done this way so that we only need to instantiate the Target
once to avoid pointless overhead but still can handle the connection
securely by making sure it's closed no matter what.

\end{fulllineitems}


\end{fulllineitems}

\index{RemoteTargetContext (class in soprano.hpc.submitter.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.utils:soprano.hpc.submitter.utils.RemoteTargetContext}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.hpc.submitter.utils.}\sphinxbfcode{RemoteTargetContext}}{\emph{rT}}{}
Bases: \sphinxcode{object}

RemoteTargetContext object

Works as a context to be used with the `with' statement. Should usually
just be created by a RemoteTarget through the appropriate property.
\index{get\_files() (soprano.hpc.submitter.utils.RemoteTargetContext method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.utils:soprano.hpc.submitter.utils.RemoteTargetContext.get_files}\pysiglinewithargsret{\sphinxbfcode{get\_files}}{\emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}

\index{put\_files() (soprano.hpc.submitter.utils.RemoteTargetContext method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.utils:soprano.hpc.submitter.utils.RemoteTargetContext.put_files}\pysiglinewithargsret{\sphinxbfcode{put\_files}}{\emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}

\index{run\_cmd() (soprano.hpc.submitter.utils.RemoteTargetContext method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.hpc.submitter.utils:soprano.hpc.submitter.utils.RemoteTargetContext.run_cmd}\pysiglinewithargsret{\sphinxbfcode{run\_cmd}}{\emph{cmd}, \emph{cwd=None}, \emph{stdin=None}}{}
Run a command on the remote machine.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] cmd (str): command to run remotely
\item[] cwd (Optional{[}str{]}): working directory in which to run the command
\item[] stdin (Optional{[}str{]}): content to communicate to the command's
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] stdin
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] stdout, stderr (str): string representations of output and error
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] messages from the command
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}


\end{fulllineitems}



\subsubsection{soprano.properties package}
\label{doctree/soprano.properties:module-soprano.properties}\label{doctree/soprano.properties:soprano-properties-package}\label{doctree/soprano.properties::doc}\index{soprano.properties (module)}
Contains classes, modules and functions relevant to Properties,
a catch-all term for things we might want to extract or calculate from
Atoms and AtomsCollections. Some will require running an external ASE
calculator first, some will just work on their own, some will require
some calculations and parameters.


\paragraph{Subpackages}
\label{doctree/soprano.properties:subpackages}

\subparagraph{soprano.properties.basic package}
\label{doctree/soprano.properties.basic:soprano-properties-basic-package}\label{doctree/soprano.properties.basic::doc}\label{doctree/soprano.properties.basic:module-soprano.properties.basic}\index{soprano.properties.basic (module)}
Module containing very basic AtomsProperties (the kind that only require
a couple of lines of code but are still pretty convenient to have at hand)


\subparagraph{Submodules}
\label{doctree/soprano.properties.basic:submodules}

\subparagraph{soprano.properties.basic.basic module}
\label{doctree/soprano.properties.basic.basic::doc}\label{doctree/soprano.properties.basic.basic:module-soprano.properties.basic.basic}\label{doctree/soprano.properties.basic.basic:soprano-properties-basic-basic-module}\index{soprano.properties.basic.basic (module)}
Implementation of some basic AtomsProperty classes
\index{CalcEnergy (class in soprano.properties.basic.basic)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.basic.basic:soprano.properties.basic.basic.CalcEnergy}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.basic.basic.}\sphinxbfcode{CalcEnergy}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Property representing the energy calculated by an ASE calulator

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.basic.basic.CalcEnergy attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.basic.basic:soprano.properties.basic.basic.CalcEnergy.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'calc\_energy'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.basic.basic.CalcEnergy attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.basic.basic:soprano.properties.basic.basic.CalcEnergy.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.basic.basic.CalcEnergy static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.basic.basic:soprano.properties.basic.basic.CalcEnergy.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{LatticeABC (class in soprano.properties.basic.basic)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.basic.basic:soprano.properties.basic.basic.LatticeABC}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.basic.basic.}\sphinxbfcode{LatticeABC}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Property representing the axis-angles form of a structure's lattice

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] shape (tuple): the shape to give to the array
\item[] deg (bool): whether to give the angles in degrees instead of radians
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.basic.basic.LatticeABC attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.basic.basic:soprano.properties.basic.basic.LatticeABC.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'lattice\_abc'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.basic.basic.LatticeABC attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.basic.basic:soprano.properties.basic.basic.LatticeABC.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'shape': (2, 3), u'deg': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.basic.basic.LatticeABC static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.basic.basic:soprano.properties.basic.basic.LatticeABC.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{shape}, \emph{deg}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{LatticeCart (class in soprano.properties.basic.basic)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.basic.basic:soprano.properties.basic.basic.LatticeCart}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.basic.basic.}\sphinxbfcode{LatticeCart}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Property representing the Cartesian form of a structure's lattice

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] shape (tuple): the shape to give to the array
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.basic.basic.LatticeCart attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.basic.basic:soprano.properties.basic.basic.LatticeCart.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'lattice\_cart'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.basic.basic.LatticeCart attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.basic.basic:soprano.properties.basic.basic.LatticeCart.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'shape': (3, 3)\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.basic.basic.LatticeCart static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.basic.basic:soprano.properties.basic.basic.LatticeCart.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{shape}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{NumAtoms (class in soprano.properties.basic.basic)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.basic.basic:soprano.properties.basic.basic.NumAtoms}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.basic.basic.}\sphinxbfcode{NumAtoms}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Property representing the number of atoms in a structure

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.basic.basic.NumAtoms attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.basic.basic:soprano.properties.basic.basic.NumAtoms.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'num\_atoms'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.basic.basic.NumAtoms attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.basic.basic:soprano.properties.basic.basic.NumAtoms.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.basic.basic.NumAtoms static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.basic.basic:soprano.properties.basic.basic.NumAtoms.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}}{}
\end{fulllineitems}


\end{fulllineitems}



\subparagraph{soprano.properties.castep package}
\label{doctree/soprano.properties.castep:module-soprano.properties.castep}\label{doctree/soprano.properties.castep::doc}\label{doctree/soprano.properties.castep:soprano-properties-castep-package}\index{soprano.properties.castep (module)}
Module containing AtomsProperties related specifically to CASTEP calculations.
Some of these can be looked up only in a CASTEP Calculator; others require
passing the path of the .castep file as a parameter and actually parsing its
contents.


\subparagraph{Submodules}
\label{doctree/soprano.properties.castep:submodules}

\subparagraph{soprano.properties.castep.castep module}
\label{doctree/soprano.properties.castep.castep:soprano-properties-castep-castep-module}\label{doctree/soprano.properties.castep.castep::doc}\label{doctree/soprano.properties.castep.castep:module-soprano.properties.castep.castep}\index{soprano.properties.castep.castep (module)}
Implementation of some CASTEP related AtomsProperties
\index{CastepEnthalpy (class in soprano.properties.castep.castep)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.castep.castep:soprano.properties.castep.castep.CastepEnthalpy}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.castep.castep.}\sphinxbfcode{CastepEnthalpy}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Enthalpy as found in the .castep file of a GeometryOptimization
calculation. If not present, this will fall back on the final free energy.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] castep\_path (str): the path in which the .castep file is to be found.
\item[] seedname\_info (str): the Atoms.info key that contains the seedname
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] of the .castep file. By default is `name'.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.castep.castep.CastepEnthalpy attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.castep.castep:soprano.properties.castep.castep.CastepEnthalpy.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'castep\_enthalpy'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.castep.castep.CastepEnthalpy attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.castep.castep:soprano.properties.castep.castep.CastepEnthalpy.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'seedname\_info': u'name', u'castep\_path': u'.'\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.castep.castep.CastepEnthalpy static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.castep.castep:soprano.properties.castep.castep.CastepEnthalpy.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{castep\_path}, \emph{seedname\_info}}{}
\end{fulllineitems}


\end{fulllineitems}



\subparagraph{soprano.properties.labeling package}
\label{doctree/soprano.properties.labeling:module-soprano.properties.labeling}\label{doctree/soprano.properties.labeling::doc}\label{doctree/soprano.properties.labeling:soprano-properties-labeling-package}\index{soprano.properties.labeling (module)}
Module containing AtomsProperties that relate to labeling a system's atoms,
molecules, hydrogen bonds and such based on their chemical properties.


\subparagraph{Submodules}
\label{doctree/soprano.properties.labeling:submodules}

\subparagraph{soprano.properties.labeling.labeling module}
\label{doctree/soprano.properties.labeling.labeling:soprano-properties-labeling-labeling-module}\label{doctree/soprano.properties.labeling.labeling:module-soprano.properties.labeling.labeling}\label{doctree/soprano.properties.labeling.labeling::doc}\index{soprano.properties.labeling.labeling (module)}
Implementation of AtomsProperties that relate to labeling of systems
\index{CarbonHybridationState (class in soprano.properties.labeling.labeling)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.labeling.labeling:soprano.properties.labeling.labeling.CarbonHybridationState}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.labeling.labeling.}\sphinxbfcode{CarbonHybridationState}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Returns an integer indicating the hybridation state of any given carbon
atom in a system, 1, 2, or 3 for sp1, sp2 or sp3, obtained by counting its
bonds. For non-carbon atoms or carbon atoms that can't be identified
returns 0.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] bonds ({[}tuple{]}): if present, use this list of bonds instead of
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] recalculating them (must be formatted like the output
\item[] of the linkage.Bonds property).
\end{DUlineblock}
\item[] save\_info (bool): if True, save the found hybridation states as an
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] array in the Atoms object. By default True.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] hybrid ({[}int{]}): list of integers encoding the hybridation states
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.labeling.labeling.CarbonHybridationState attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.labeling.labeling:soprano.properties.labeling.labeling.CarbonHybridationState.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'carbon\_hybridation\_state'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.labeling.labeling.CarbonHybridationState attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.labeling.labeling:soprano.properties.labeling.labeling.CarbonHybridationState.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'save\_info': True, u'bonds': None\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.labeling.labeling.CarbonHybridationState static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.labeling.labeling:soprano.properties.labeling.labeling.CarbonHybridationState.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{bonds}, \emph{save\_info}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{HydrogenBondTypes (class in soprano.properties.labeling.labeling)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.labeling.labeling:soprano.properties.labeling.labeling.HydrogenBondTypes}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.labeling.labeling.}\sphinxbfcode{HydrogenBondTypes}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Assign MoleculeSites labels to atoms, then characterise existing hydrogen
bonds based on them, and return a list of such bonds detected in a system.
The bonds come in the form `\{0\}\textless{}\{1\},\{2\}\textgreater{}..\{3\}\textless{}\{4\}\textgreater{}', where \{0\} is the name
of the molecule containing the hydrogen, \{2\} is the hydrogen, \{1\} the atom
to which the hydrogen is bonded, \{3\} the name of the other molecule and
\{4\} the atom to which the hydrogen is hydrogen bonded.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always recalculate the molecules even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\item[] save\_info (bool): if True, save the found hydrogen bond types as part
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] of the Atoms object info. By default True.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] hydrogen\_bond\_types (list): A list containing info characterising the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] hydrogen bonds present in the system in a
\item[] detailed way.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.labeling.labeling.HydrogenBondTypes attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.labeling.labeling:soprano.properties.labeling.labeling.HydrogenBondTypes.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'hydrogen\_bond\_types'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.labeling.labeling.HydrogenBondTypes attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.labeling.labeling:soprano.properties.labeling.labeling.HydrogenBondTypes.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False, u'save\_info': True\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.labeling.labeling.HydrogenBondTypes static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.labeling.labeling:soprano.properties.labeling.labeling.HydrogenBondTypes.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{force\_recalc}, \emph{save\_info}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{MoleculeSites (class in soprano.properties.labeling.labeling)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.labeling.labeling:soprano.properties.labeling.labeling.MoleculeSites}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.labeling.labeling.}\sphinxbfcode{MoleculeSites}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Assigns univoque labels to atoms belonging to molecules by exploiting
network topology. Atoms can have the same label, but only if they're
fundamentally indistinguishable in the molecule's chemical context
(for example, three hydrogen atoms on a CH3 group). The molecule will be
described by a characteristic string and by a series of labels in the
format {[}element{]}\_{[}number{]}. These sites will be saved by default and can
be used for better insight when carrying out other analysis.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always recalculate the molecules even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\item[] save\_info (bool): if True, save the found molecular sites as part of
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] the Atoms object info. By default True.
\end{DUlineblock}
\item[] save\_asarray (bool): if True the molecular site names are also saved
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] as an array of the molecule selection.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] molecular\_sites (dict): A dictionary containing info characterising
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] the molecule's chemical sites unequivocally.
\item[] These are a string representation of the
\item[] molecule itself and a dictionary linking
\item[] atomic indices (as found in the molecule in
\item[] AtomSelection form) to site labels.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.labeling.labeling.MoleculeSites attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.labeling.labeling:soprano.properties.labeling.labeling.MoleculeSites.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'molecule\_sites'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.labeling.labeling.MoleculeSites attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.labeling.labeling:soprano.properties.labeling.labeling.MoleculeSites.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False, u'save\_info': True, u'save\_asarray': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.labeling.labeling.MoleculeSites static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.labeling.labeling:soprano.properties.labeling.labeling.MoleculeSites.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{force\_recalc}, \emph{save\_info}, \emph{save\_asarray}}{}
\end{fulllineitems}


\end{fulllineitems}



\subparagraph{soprano.properties.linkage package}
\label{doctree/soprano.properties.linkage::doc}\label{doctree/soprano.properties.linkage:soprano-properties-linkage-package}\label{doctree/soprano.properties.linkage:module-soprano.properties.linkage}\index{soprano.properties.linkage (module)}
Module containing AtomsProperties that relate to linkage properties of a given
system, self-correlation etc.


\subparagraph{Submodules}
\label{doctree/soprano.properties.linkage:submodules}

\subparagraph{soprano.properties.linkage.linkage module}
\label{doctree/soprano.properties.linkage.linkage::doc}\label{doctree/soprano.properties.linkage.linkage:module-soprano.properties.linkage.linkage}\label{doctree/soprano.properties.linkage.linkage:soprano-properties-linkage-linkage-module}\index{soprano.properties.linkage.linkage (module)}
Implementation of AtomsProperties that relate to linkage of atoms
\index{Bonds (class in soprano.properties.linkage.linkage)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.Bonds}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.linkage.linkage.}\sphinxbfcode{Bonds}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array of tuples identifying all bonds existing within the
system (calculated using Van der Waals radii). The tuples are structured
as:

(atom\_1, atom\_2, atom\_2\_cell, bond\_length)

with atom\_1 and atom\_2 being indices and atom\_2\_cell being an array of
integers identifying the unit cell to which atom\_2 belongs with respect
to atom\_1 (which is assumed to be in (0,0,0), the central cell). This is
to account for the possibility of course that the bond exists through the
periodic boundary. WARNING: the possibility of an atom bonding with
another throughout two different periodic boundaries is not accounted for.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] vdw\_set(\{ase, jmol\}): set of Van der Waals radii to use. Default is
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] the one extracted from JMol.
\end{DUlineblock}
\item[] vdw\_scale (float): scaling factor to apply to the base Van der Waals
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] radii values. Values bigger than one make for more
\item[] tolerant bonds.
\end{DUlineblock}
\item[] default\_vdw (float): default Van der Waals radius for species for
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] whom no data is available.
\end{DUlineblock}
\item[] return\_matrix (bool): if True, also return an NxN bonding matrix for
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] all N atoms in the system
\end{DUlineblock}
\item[] save\_info (bool): if True, save the found bonds (and in case matrix)
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] as part of the Atoms object info. By default True.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] bonds({[}tuple{]}): list of bonds in the form of 3-tuples structured as
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] explained above
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.linkage.linkage.Bonds attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.Bonds.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'bonds'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.linkage.linkage.Bonds attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.Bonds.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'default\_vdw': 2.0, u'return\_matrix': False, u'vdw\_scale': 1.0, u'save\_info': True, u'vdw\_set': u'jmol'\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.linkage.linkage.Bonds static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.Bonds.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{vdw\_set}, \emph{vdw\_scale}, \emph{default\_vdw}, \emph{return\_matrix}, \emph{save\_info}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{CoordinationHistogram (class in soprano.properties.linkage.linkage)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.CoordinationHistogram}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.linkage.linkage.}\sphinxbfcode{CoordinationHistogram}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an histogram representing, for each pair of species present in
the system, how many atoms of species 1 have n bonds with species 2, n
being the histogram bins. The histogram is topped at a `maximum
coordination' parameter which is 6 by default but can be user defined;
the last bin represents all higher values (so by default `6 or more').
Two species or lists of species can be given if one wants to restrict the
search; otherwise a full histogram for all pairs of species is returned.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] vdw\_set(\{ase, jmol\}): set of Van der Waals radii to use. Default is
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] the one extracted from JMol.
\end{DUlineblock}
\item[] vdw\_scale (float): scaling factor to apply to the base Van der Waals
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] radii values. Values bigger than one make for more
\item[] tolerant bonds.
\end{DUlineblock}
\item[] default\_vdw (float): default Van der Waals radius for species for
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] whom no data is available.
\end{DUlineblock}
\item[] species\_1 (str or {[}str{]}): list of species to compute the histogram
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] for. By default all of them.
\end{DUlineblock}
\item[] species\_2 (str or {[}str{]}): list of species whose coordination with
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] species\_1 should be checked. By default all
\item[] of them.
\end{DUlineblock}
\item[] max\_coord (int): what should be the largest coordination number
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] considered for an atom (default 6).
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] coord\_hist (dict): dictionary of dictionaries indexed by species\_1
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] followed by species\_2. The elements are arrays of
\item[] integers constituting the histogram.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.linkage.linkage.CoordinationHistogram attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.CoordinationHistogram.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'coord\_histogram'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.linkage.linkage.CoordinationHistogram attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.CoordinationHistogram.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'species\_2': None, u'species\_1': None, u'default\_vdw': 2.0, u'max\_coord': 6, u'vdw\_set': u'jmol', u'vdw\_scale': 1.0\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.linkage.linkage.CoordinationHistogram static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.CoordinationHistogram.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{vdw\_set}, \emph{vdw\_scale}, \emph{default\_vdw}, \emph{species\_1}, \emph{species\_2}, \emph{max\_coord}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{DihedralAngleList (class in soprano.properties.linkage.linkage)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.DihedralAngleList}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.linkage.linkage.}\sphinxbfcode{DihedralAngleList}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces a list of dihedral angles found in the system, identified by
looking for a bonding pattern. The amount of said angles can vary from
zero (if the pattern is not present) to an arbitrary number. They will be
returned sorted from lowest to highest. Periodic boundary conditions are
taken into account. If no pattern is provided, HCCH groups are searched by
default.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] dihedral\_pattern ({[}str{]}*4): a list of four chemical symbols
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] identifying the dihedral pattern to look
\item[] for
\end{DUlineblock}
\item[] bonds\_params (dict): parameters to pass to the Bonds property used to
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] compute bonds. See the Bonds docstring for
\item[] details. If not provided, defaults are used
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] dihedral\_angles (np.ndarray): sorted list of dihedral angles found
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.linkage.linkage.DihedralAngleList attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.DihedralAngleList.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'dihedral\_angle\_list'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.linkage.linkage.DihedralAngleList attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.DihedralAngleList.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'dihedral\_pattern': {[}u'H', u'C', u'C', u'H'{]}, u'bonds\_params': \{\}\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.linkage.linkage.DihedralAngleList static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.DihedralAngleList.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{dihedral\_pattern}, \emph{bonds\_params}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{HydrogenBonds (class in soprano.properties.linkage.linkage)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.HydrogenBonds}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.linkage.linkage.}\sphinxbfcode{HydrogenBonds}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Hydrogen Bonds

Produces a dictionary containing the atom indices defining hydrogen bonds
detected in the system - if required, classified by type. By default only
O and N atoms are considered for hydrogen bonds (OH..O, OH..N and so on).
The type is defined as AH..B where A is the symbol of the atom directly
bonded to the proton and B the one of the hydrogen bonded one.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] vdw\_set(\{ase, jmol\}): set of Van der Waals radii to use. Default is
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] the one extracted from JMol.
\end{DUlineblock}
\item[] vdw\_scale (float): scaling factor to apply to the base Van der Waals
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] radii values. Values bigger than one make for more
\item[] tolerant molecules.
\end{DUlineblock}
\item[] default\_vdw (float): default Van der Waals radius for species for
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] whom no data is available.
\end{DUlineblock}
\item[] hbond\_elems ({[}str{]}): chemical symbols of elements considered capable
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] of forming hydrogen bonds (by default O and N)
\end{DUlineblock}
\item[] max\_length (float): maximum A-B length of the hydrogen bond in
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Angstrom - default is 3.5 Ang
\end{DUlineblock}
\item[] max\_angle (float): maximum A-H/A-B angle in the hydrogen bond in
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] degrees - default is 45 deg
\end{DUlineblock}
\item[] save\_info (bool): if True, save the found hydrogen bonds as part of
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] the Atoms object info. By default True.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] hbondss ({[}dict{]}): list of hydrogen bonds detected
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] in the system by type (can contain empty arrays).
\item[] For each hydrogen bond we give index of the H
\item[] atom, index and unit cell of the A atom (the one
\item[] directly bonded), index and unit cell of the B atom
\item[] (the one that's hydrogen bonded), length and angle
\item[] in degrees.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.linkage.linkage.HydrogenBonds attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.HydrogenBonds.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'hydrogen\_bonds'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.linkage.linkage.HydrogenBonds attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.HydrogenBonds.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'save\_info': True, u'hbond\_elems': {[}u'O', u'N'{]}, u'default\_vdw': 2.0, u'max\_length': 3.5, u'vdw\_set': u'jmol', u'vdw\_scale': 1.0, u'max\_angle': 45.0\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.linkage.linkage.HydrogenBonds static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.HydrogenBonds.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{vdw\_set}, \emph{vdw\_scale}, \emph{default\_vdw}, \emph{hbond\_elems}, \emph{max\_length}, \emph{max\_angle}, \emph{save\_info}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{HydrogenBondsNumber (class in soprano.properties.linkage.linkage)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.HydrogenBondsNumber}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.linkage.linkage.}\sphinxbfcode{HydrogenBondsNumber}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Number of hydrogen bonds detected in this system, classified by type.
By default will use already existing hydrogen bonds if they're present as
a saved array in the system.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always recalculate the hydrogen bonds
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] even if already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] hbonds\_n (int): number of hydrogen bonds found
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.linkage.linkage.HydrogenBondsNumber attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.HydrogenBondsNumber.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'hydrogen\_bonds\_n'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.linkage.linkage.HydrogenBondsNumber attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.HydrogenBondsNumber.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.linkage.linkage.HydrogenBondsNumber static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.HydrogenBondsNumber.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{force\_recalc}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{LinkageList (class in soprano.properties.linkage.linkage)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.LinkageList}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.linkage.linkage.}\sphinxbfcode{LinkageList}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing the atomic pair distances in a system,
reduced to their shortest periodic version and sorted min to max.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] size (int): maximum number of distances to include. If not present,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] all of them will be included. If present, arrays will be
\item[] cut or padded to reach this size.
\end{DUlineblock}
\item[] return\_pairs (bool): if True, return the pairs of atoms to which the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] distances correspond, as a list of tuples of
\item[] indices.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] link\_list ({[}float{]}): sorted list of interatomic linkage distances
\item[] pair\_list ({[}(int, int){]}): only if return\_pairs is True, list of pairs
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] corresponding to the distances
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.linkage.linkage.LinkageList attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.LinkageList.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'linkage\_list'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.linkage.linkage.LinkageList attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.LinkageList.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'return\_pairs': False, u'size': 0\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.linkage.linkage.LinkageList static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.LinkageList.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{size}, \emph{return\_pairs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{MoleculeCOM (class in soprano.properties.linkage.linkage)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeCOM}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.linkage.linkage.}\sphinxbfcode{MoleculeCOM}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

List of centers of mass for the molecules present in the system. By
default will use already existing molecules if they're present as a saved
array in the system.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always recalculate the molecules even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Return:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] mol\_com (np.ndarray): list of centers of mass for the system's
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] molecules
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.linkage.linkage.MoleculeCOM attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeCOM.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'molecule\_com'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.linkage.linkage.MoleculeCOM attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeCOM.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.linkage.linkage.MoleculeCOM static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeCOM.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{force\_recalc}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{MoleculeCOMLinkage (class in soprano.properties.linkage.linkage)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeCOMLinkage}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.linkage.linkage.}\sphinxbfcode{MoleculeCOMLinkage}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Linkage list - following the same criteria as the atomic one - calculated
for the centers of mass of the molecules present in the system. By default
will use already existing molecules if they're present as a saved array in
the system.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always recalculate the molecules even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\item[] size (int): maximum number of distances to include. If not present,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] all of them will be included. If present, arrays will be
\item[] cut or padded to reach this sizeber.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] molecule\_linkage ({[}float{]}): distances between all centers of mass of
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] molecules in the system, sorted.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.linkage.linkage.MoleculeCOMLinkage attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeCOMLinkage.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'molecule\_com\_linkage'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.linkage.linkage.MoleculeCOMLinkage attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeCOMLinkage.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False, u'size': 0\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.linkage.linkage.MoleculeCOMLinkage static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeCOMLinkage.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{force\_recalc}, \emph{size}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{MoleculeMass (class in soprano.properties.linkage.linkage)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeMass}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.linkage.linkage.}\sphinxbfcode{MoleculeMass}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Total mass of each of the molecules detected in this system. By default
will use already existing molecules if they're present as a saved array in
the system.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always recalculate the molecules even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\item[] size (int): maximum number of distances to include. If not present,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] all of them will be included. If present, arrays will be
\item[] cut or padded to reach this sizeber.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] molecule\_m ({[}float{]}): mass of each of the molecules present, sorted.
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.linkage.linkage.MoleculeMass attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeMass.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'molecule\_mass'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.linkage.linkage.MoleculeMass attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeMass.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False, u'size': 0\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.linkage.linkage.MoleculeMass static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeMass.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{force\_recalc}, \emph{size}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{MoleculeNumber (class in soprano.properties.linkage.linkage)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeNumber}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.linkage.linkage.}\sphinxbfcode{MoleculeNumber}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Number of molecules detected in this system. By default will use already
existing molecules if they're present as a saved array in the system.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always recalculate the molecules even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] molecule\_n (int): number of molecules found
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.linkage.linkage.MoleculeNumber attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeNumber.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'molecule\_n'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.linkage.linkage.MoleculeNumber attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeNumber.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.linkage.linkage.MoleculeNumber static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeNumber.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{force\_recalc}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{MoleculeQuaternion (class in soprano.properties.linkage.linkage)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeQuaternion}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.linkage.linkage.}\sphinxbfcode{MoleculeQuaternion}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

A list of quaternions expressing the rotation of the molecule's intertia
tensor principal frame with respect to the cartesian axes.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always recalculate the molecules even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] mol\_quat ({[}ase.Quaternion{]}): list of quaternions
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.linkage.linkage.MoleculeQuaternion attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeQuaternion.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'molecule\_quaternion'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.linkage.linkage.MoleculeQuaternion attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeQuaternion.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.linkage.linkage.MoleculeQuaternion static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeQuaternion.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{force\_recalc}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{MoleculeRelativeRotation (class in soprano.properties.linkage.linkage)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeRelativeRotation}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.linkage.linkage.}\sphinxbfcode{MoleculeRelativeRotation}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

A list of relative rotations between molecules. Uses the inertia tensor
eigenvectors to establish a local frame for each molecule, then uses
quaternions to define a rotational distance between molecules. It then
produces a list of geodesic distances between these quaternions.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always recalculate the molecules even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\item[] size (int): maximum number of distances to include. If not present,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] all of them will be included. If present, arrays will be
\item[] cut or padded to reach this size.
\end{DUlineblock}
\item[] twist\_axis ({[}float{]}): if present, only compare the Twist component of
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] quaternion along the given axis. The Twist/Swing
\item[] decomposition splits a quaternion in a rotation
\item[] around an axis and one around an orthogonal
\item[] direction. Only one between this and swing\_plane
\item[] can be present.
\end{DUlineblock}
\item[] swing\_plane ({[}float{]}): if present, only compare the Swing component of
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] quaternion along the given axis. The Twist/Swing
\item[] decomposition splits a quaternion in a rotation
\item[] around an axis and one around an orthogonal
\item[] direction. Only one between this and twist\_axis
\item[] can be present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] molecule\_relrot ({[}float{]}): list of relative rotations, as quaternion
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] distances, with the required ordering.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.linkage.linkage.MoleculeRelativeRotation attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeRelativeRotation.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'molecule\_rel\_rotation'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.linkage.linkage.MoleculeRelativeRotation attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeRelativeRotation.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False, u'twist\_axis': None, u'swing\_plane': None, u'size': 0\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.linkage.linkage.MoleculeRelativeRotation static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.MoleculeRelativeRotation.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{force\_recalc}, \emph{size}, \emph{swing\_plane}, \emph{twist\_axis}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{Molecules (class in soprano.properties.linkage.linkage)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.Molecules}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.linkage.linkage.}\sphinxbfcode{Molecules}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing multiple AtomSelection objects representing
molecules in the system as found by connecting atoms closer than the half
sum of their Van der Waals radii. It will return the entire unit cell if
the system can not be split in molecules at all.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] vdw\_set(\{ase, jmol\}): set of Van der Waals radii to use. Default is
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] the one extracted from JMol.
\end{DUlineblock}
\item[] vdw\_scale (float): scaling factor to apply to the base Van der Waals
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] radii values. Values bigger than one make for more
\item[] tolerant molecules.
\end{DUlineblock}
\item[] default\_vdw (float): default Van der Waals radius for species for
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] whom no data is available.
\end{DUlineblock}
\item[] save\_info (bool): if True, save the found molecules as part of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Atoms object info. By default True.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] molecules ({[}AtomSelection{]}): list of molecules in the form of
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] AtomSelection objects.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.linkage.linkage.Molecules attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.Molecules.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'molecules'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.linkage.linkage.Molecules attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.Molecules.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'default\_vdw': 2.0, u'vdw\_scale': 1.0, u'save\_info': True, u'vdw\_set': u'jmol'\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.linkage.linkage.Molecules static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.linkage.linkage:soprano.properties.linkage.linkage.Molecules.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{vdw\_set}, \emph{vdw\_scale}, \emph{default\_vdw}, \emph{save\_info}}{}
\end{fulllineitems}


\end{fulllineitems}



\subparagraph{soprano.properties.nmr package}
\label{doctree/soprano.properties.nmr:module-soprano.properties.nmr}\label{doctree/soprano.properties.nmr::doc}\label{doctree/soprano.properties.nmr:soprano-properties-nmr-package}\index{soprano.properties.nmr (module)}
Module containing AtomsProperties that relate to NMR properties of a system.
Some of these are valid only for Atoms objects loaded from a .magres file.


\subparagraph{Submodules}
\label{doctree/soprano.properties.nmr:submodules}

\subparagraph{soprano.properties.nmr.dipolar module}
\label{doctree/soprano.properties.nmr.dipolar:module-soprano.properties.nmr.dipolar}\label{doctree/soprano.properties.nmr.dipolar::doc}\label{doctree/soprano.properties.nmr.dipolar:soprano-properties-nmr-dipolar-module}\index{soprano.properties.nmr.dipolar (module)}
Implementation of AtomsProperties that relate to NMR dipole-dipole
couplings
\index{DipolarCoupling (class in soprano.properties.nmr.dipolar)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.dipolar:soprano.properties.nmr.dipolar.DipolarCoupling}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.dipolar.}\sphinxbfcode{DipolarCoupling}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces a dictionary of dipole-dipole coupling constants for atom pairs
in the system. For each pair, the closest periodic copy will be considered.
The constant for a pair of nuclei i and j is defined as:
\begin{equation*}
\begin{split}d_{ij} = -\frac{\mu_0\hbar\gamma_i\gamma_j}{8\pi^2r_{ij}^3}\end{split}
\end{equation*}
where the gammas represent the gyromagnetic ratios of the nuclei and the
r is their distance. The full tensor of the interaction is then defined as
\begin{equation*}
\begin{split}D_{ij} = 
\begin{bmatrix}
 -\frac{d_{ij}}{2} & 0 & 0 \\
 0 & -\frac{d_{ij}}{2} & 0 \\
 0 & 0 & d_{ij} \\
\end{bmatrix}\end{split}
\end{equation*}
where the z-axis is aligned with \(r_{ij}\) and the other two can be any
directions in the orthogonal plane.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] sel\_i (AtomSelection or {[}int{]}): Selection or list of indices of atoms
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] for which to compute the dipolar
\item[] coupling. By default is None
\item[] (= all of them).
\end{DUlineblock}
\item[] sel\_j (AtomSelection or {[}int{]}): Selection or list of indices of atoms
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] for which to compute the dipolar
\item[] coupling with the ones in sel\_i. By
\item[] default is None (= same as sel\_i).
\end{DUlineblock}
\item[] isotopes (dict): dictionary of specific isotopes to use, by element
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] symbol. If the isotope doesn't exist an error will
\item[] be raised.
\end{DUlineblock}
\item[] isotope\_list (list): list of isotopes, atom-by-atom. To be used if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] different atoms of the same element are supposed
\item[] to be of different isotopes. Where a `None' is
\item[] present will fall back on the previous
\item[] definitions. Where an isotope is present it
\item[] overrides everything else.
\end{DUlineblock}
\item[] self\_coupling (bool): if True, include coupling of a nucleus with its
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] own closest periodic copy. Otherwise excluded.
\item[] Default is False.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns: 
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] dip\_dict (dict): Dictionary of couplings in Hz and r\_\{ij\} versors,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] pointing from i to j, by atomic index pair.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.dipolar.DipolarCoupling attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.dipolar:soprano.properties.nmr.dipolar.DipolarCoupling.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'dip\_coupling'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.dipolar.DipolarCoupling attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.dipolar:soprano.properties.nmr.dipolar.DipolarCoupling.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'isotopes': \{\}, u'sel\_i': None, u'sel\_j': None, u'self\_coupling': False, u'isotope\_list': None\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.dipolar.DipolarCoupling static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.dipolar:soprano.properties.nmr.dipolar.DipolarCoupling.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{sel\_i}, \emph{sel\_j}, \emph{isotopes}, \emph{isotope\_list}, \emph{self\_coupling}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{DipolarDiagonal (class in soprano.properties.nmr.dipolar)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.dipolar:soprano.properties.nmr.dipolar.DipolarDiagonal}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.dipolar.}\sphinxbfcode{DipolarDiagonal}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces a dictionary of dipole-dipole tensors as eigenvalues and
eigenvectors for atom pairs in the system. For each pair, the closest
periodic copy will be considered.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] sel\_i (AtomSelection or {[}int{]}): Selection or list of indices of atoms
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] for which to compute the dipolar
\item[] coupling. By default is None
\item[] (= all of them).
\end{DUlineblock}
\item[] sel\_j (AtomSelection or {[}int{]}): Selection or list of indices of atoms
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] for which to compute the dipolar
\item[] coupling with the ones i sel\_i. By
\item[] default is None (= same as sel\_i).
\end{DUlineblock}
\item[] isotopes (dict): dictionary of specific isotopes to use, by element
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] symbol. If the isotope doesn't exist an error will
\item[] be raised.
\end{DUlineblock}
\item[] isotope\_list (list): list of isotopes, atom-by-atom. To be used if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] different atoms of the same element are supposed
\item[] to be of different isotopes. Where a `None' is
\item[] present will fall back on the previous
\item[] definitions. Where an isotope is present it
\item[] overrides everything else.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns: 
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] dip\_tens\_dict (dict): Dictionary of dipolar eigenvalues (in Hz) and
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] eigenvectors, by atomic index pair.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.dipolar.DipolarDiagonal attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.dipolar:soprano.properties.nmr.dipolar.DipolarDiagonal.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'dip\_diagonal'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.dipolar.DipolarDiagonal attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.dipolar:soprano.properties.nmr.dipolar.DipolarDiagonal.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'isotopes': \{\}, u'sel\_i': None, u'sel\_j': None, u'isotope\_list': None\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.dipolar.DipolarDiagonal static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.dipolar:soprano.properties.nmr.dipolar.DipolarDiagonal.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{sel\_i}, \emph{sel\_j}, \emph{isotopes}, \emph{isotope\_list}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{DipolarRSS (class in soprano.properties.nmr.dipolar)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.dipolar:soprano.properties.nmr.dipolar.DipolarRSS}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.dipolar.}\sphinxbfcode{DipolarRSS}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Compute the Dipolar constant Root Sum Square for each atom in a system,
including periodicity, within a cutoff.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] cutoff (float): cutoff radius in Angstroms at which the sum stops. By
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] default 5 Ang.
\end{DUlineblock}
\item[] isonuclear (bool): if True, only nuclei of the same species will be
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] considered. By default is False.
\end{DUlineblock}
\item[] isotopes (dict): dictionary of specific isotopes to use, by element
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] symbol. If the isotope doesn't exist an error will
\item[] be raised.
\end{DUlineblock}
\item[] isotope\_list (list): list of isotopes, atom-by-atom. To be used if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] different atoms of the same element are supposed
\item[] to be of different isotopes. Where a `None' is
\item[] present will fall back on the previous
\item[] definitions. Where an isotope is present it
\item[] overrides everything else.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] dip\_rss (np.ndarray): dipolar constant RSS for each atom in the system
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.dipolar.DipolarRSS attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.dipolar:soprano.properties.nmr.dipolar.DipolarRSS.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'dip\_rss'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.dipolar.DipolarRSS attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.dipolar:soprano.properties.nmr.dipolar.DipolarRSS.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'isotopes': \{\}, u'cutoff': 5.0, u'isotope\_list': None, u'isonuclear': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.dipolar.DipolarRSS static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.dipolar:soprano.properties.nmr.dipolar.DipolarRSS.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{cutoff}, \emph{isonuclear}, \emph{isotopes}, \emph{isotope\_list}}{}
\end{fulllineitems}


\end{fulllineitems}



\subparagraph{soprano.properties.nmr.efg module}
\label{doctree/soprano.properties.nmr.efg::doc}\label{doctree/soprano.properties.nmr.efg:module-soprano.properties.nmr.efg}\label{doctree/soprano.properties.nmr.efg:soprano-properties-nmr-efg-module}\index{soprano.properties.nmr.efg (module)}
Implementation of AtomsProperties that relate to NMR electric field
gradients
\index{EFGAnisotropy (class in soprano.properties.nmr.efg)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGAnisotropy}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.efg.}\sphinxbfcode{EFGAnisotropy}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing the electric field gradient anisotropies in a
system (au).
Requires the Atoms object to have been loaded from a .magres file
containing the relevant information.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always diagonalise the tensors even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] efg\_list (np.ndarray): list of anisotropies
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.efg.EFGAnisotropy attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGAnisotropy.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'efg\_anisotropy'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.efg.EFGAnisotropy attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGAnisotropy.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.efg.EFGAnisotropy static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGAnisotropy.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{EFGAsymmetry (class in soprano.properties.nmr.efg)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGAsymmetry}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.efg.}\sphinxbfcode{EFGAsymmetry}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing the electric field gradient asymmetries
in a system (adimensional).
Requires the Atoms object to have been loaded from a .magres file
containing the relevant information.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always diagonalise the tensors even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] efg\_list (np.ndarray): list of asymmetries
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.efg.EFGAsymmetry attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGAsymmetry.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'efg\_asymmetry'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.efg.EFGAsymmetry attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGAsymmetry.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.efg.EFGAsymmetry static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGAsymmetry.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{EFGDiagonal (class in soprano.properties.nmr.efg)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGDiagonal}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.efg.}\sphinxbfcode{EFGDiagonal}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing eigenvalues and eigenvectors for the
symmetric part of each EFG tensor in the system. By default
saves them as part of the Atoms' arrays as well.
Requires the Atoms object to have been loaded from a .magres file
containing the relevant information.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] save\_array (bool): if True, save the diagonalised tensors in the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Atoms object as an array. By default True.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] efg\_diag (np.ndarray): list of eigenvalues and eigenvectors
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.efg.EFGDiagonal attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGDiagonal.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'efg\_diagonal'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.efg.EFGDiagonal attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGDiagonal.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'save\_array': True\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.efg.EFGDiagonal static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGDiagonal.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{EFGQuadrupolarConstant (class in soprano.properties.nmr.efg)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGQuadrupolarConstant}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.efg.}\sphinxbfcode{EFGQuadrupolarConstant}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing the quadrupolar constant in Hz for every atom
in a system. The constant will be zero for non-quadrupole active nuclei.
Unless specified otherwise, the quadrupole moment of the most common
NMR-active isotope is used.
For reference: the value returned by this property is defined as
\begin{equation*}
\begin{split}\frac{e^2qQ}{h}\end{split}
\end{equation*}
in Hz. It is important to keep in mind that therefore this represents a
\emph{frequency}; the corresponding `omega' (pulsation) would be the same value
multiplied by 2*pi. This is, for example, exactly the value required as
input in Simpson's SPINSYS section.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always diagonalise the tensors even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\item[] use\_q\_isotopes (bool): if True, always use the most common quadrupole
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] active isotope for each element, if there is
\item[] one.
\end{DUlineblock}
\item[] isotopes (dict): dictionary of specific isotopes to use, by element
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] symbol. If the isotope doesn't exist an error will
\item[] be raised. Overrides use\_q\_isotopes.
\end{DUlineblock}
\item[] isotope\_list (list): list of isotopes, atom-by-atom. To be used if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] different atoms of the same element are supposed
\item[] to be of different isotopes. Where a `None' is
\item[] present will fall back on the previous
\item[] definitions. Where an isotope is present it
\item[] overrides everything else.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] q\_list (np.ndarray): list of quadrupole constants in Hz
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.efg.EFGQuadrupolarConstant attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGQuadrupolarConstant.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'efg\_qconst'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.efg.EFGQuadrupolarConstant attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGQuadrupolarConstant.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False, u'isotopes': \{\}, u'isotope\_list': None, u'use\_q\_isotopes': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.efg.EFGQuadrupolarConstant static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGQuadrupolarConstant.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{EFGQuaternion (class in soprano.properties.nmr.efg)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGQuaternion}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.efg.}\sphinxbfcode{EFGQuaternion}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces a list of ase.Quaternion objects expressing the orientation of
the EFG tensors with respect to the cartesian axes.
Requires the Atoms object to have been loaded from a .magres file
containing the relevant information.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always diagonalise the tensors even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ms\_quat (np.ndarray): list of quaternions
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.efg.EFGQuaternion attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGQuaternion.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'efg\_quats'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.efg.EFGQuaternion attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGQuaternion.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.efg.EFGQuaternion static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGQuaternion.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{EFGReducedAnisotropy (class in soprano.properties.nmr.efg)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGReducedAnisotropy}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.efg.}\sphinxbfcode{EFGReducedAnisotropy}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing the electric field gradient reduced
anisotropies in a system (au).
Requires the Atoms object to have been loaded from a .magres file
containing the relevant information.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always diagonalise the tensors even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] efg\_list (np.ndarray): list of reduced anisotropies
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.efg.EFGReducedAnisotropy attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGReducedAnisotropy.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'efg\_red\_anisotropy'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.efg.EFGReducedAnisotropy attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGReducedAnisotropy.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.efg.EFGReducedAnisotropy static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGReducedAnisotropy.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{EFGSkew (class in soprano.properties.nmr.efg)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGSkew}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.efg.}\sphinxbfcode{EFGSkew}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing the magnetic shielding tensor skew
in a system.
Requires the Atoms object to have been loaded from a .magres file
containing the relevant information.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always diagonalise the tensors even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] efg\_list (np.ndarray): list of skews
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.efg.EFGSkew attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGSkew.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'efg\_skew'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.efg.EFGSkew attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGSkew.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.efg.EFGSkew static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGSkew.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{EFGSpan (class in soprano.properties.nmr.efg)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGSpan}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.efg.}\sphinxbfcode{EFGSpan}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing the electric field gradient tensor span
in a system (au).
Requires the Atoms object to have been loaded from a .magres file
containing the relevant information.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always diagonalise the tensors even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] efg\_list (np.ndarray): list of spans
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.efg.EFGSpan attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGSpan.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'efg\_span'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.efg.EFGSpan attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGSpan.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.efg.EFGSpan static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGSpan.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{EFGVzz (class in soprano.properties.nmr.efg)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGVzz}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.efg.}\sphinxbfcode{EFGVzz}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing the major component of the electric field
gradient in a system (au).
Requires the Atoms object to have been loaded from a .magres file
containing the relevant information.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always diagonalise the tensors even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] efg\_list (np.ndarray): list of Vzz values
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.efg.EFGVzz attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGVzz.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'efg\_vzz'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.efg.EFGVzz attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGVzz.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.efg.EFGVzz static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.efg:soprano.properties.nmr.efg.EFGVzz.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}



\subparagraph{soprano.properties.nmr.ms module}
\label{doctree/soprano.properties.nmr.ms:soprano-properties-nmr-ms-module}\label{doctree/soprano.properties.nmr.ms::doc}\label{doctree/soprano.properties.nmr.ms:module-soprano.properties.nmr.ms}\index{soprano.properties.nmr.ms (module)}
Implementation of AtomsProperties that relate to NMR shieldings/shifts
\index{MSAnisotropy (class in soprano.properties.nmr.ms)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSAnisotropy}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.ms.}\sphinxbfcode{MSAnisotropy}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing the magnetic shielding anisotropies in a
system (ppm).
Requires the Atoms object to have been loaded from a .magres file
containing the relevant information.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always diagonalise the tensors even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ms\_list (np.ndarray): list of anisotropies
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.ms.MSAnisotropy attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSAnisotropy.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'ms\_anisotropy'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.ms.MSAnisotropy attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSAnisotropy.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.ms.MSAnisotropy static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSAnisotropy.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{MSAsymmetry (class in soprano.properties.nmr.ms)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSAsymmetry}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.ms.}\sphinxbfcode{MSAsymmetry}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing the magnetic shielding asymmetries
in a system (adimensional).
Requires the Atoms object to have been loaded from a .magres file
containing the relevant information.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always diagonalise the tensors even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ms\_list (np.ndarray): list of asymmetries
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.ms.MSAsymmetry attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSAsymmetry.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'ms\_asymmetry'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.ms.MSAsymmetry attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSAsymmetry.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.ms.MSAsymmetry static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSAsymmetry.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{MSDiagonal (class in soprano.properties.nmr.ms)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSDiagonal}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.ms.}\sphinxbfcode{MSDiagonal}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing eigenvalues and eigenvectors for the
symmetric part of each magnetic shielding tensor in the system. By default
saves them as part of the Atoms' arrays as well.
Requires the Atoms object to have been loaded from a .magres file
containing the relevant information.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] save\_array (bool): if True, save the diagonalised tensors in the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] Atoms object as an array. By default True.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ms\_diag (np.ndarray): list of eigenvalues and eigenvectors
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.ms.MSDiagonal attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSDiagonal.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'ms\_diagonal'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.ms.MSDiagonal attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSDiagonal.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'save\_array': True\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.ms.MSDiagonal static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSDiagonal.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{MSIsotropy (class in soprano.properties.nmr.ms)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSIsotropy}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.ms.}\sphinxbfcode{MSIsotropy}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing the magnetic shielding isotropies in a system
(ppm, with reference if provided).
Requires the Atoms object to have been loaded from a .magres file
containing the relevant information.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ref (float): reference frequency. If provided, the chemical shift
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] will be returned instead of the magnetic shielding.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ms\_iso (np.ndarray): list of shieldings/shifts
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.ms.MSIsotropy attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSIsotropy.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'ms\_isotropy'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.ms.MSIsotropy attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSIsotropy.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'ref': None\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.ms.MSIsotropy static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSIsotropy.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{MSQuaternion (class in soprano.properties.nmr.ms)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSQuaternion}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.ms.}\sphinxbfcode{MSQuaternion}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces a list of ase.Quaternion objects expressing the orientation of
the MS tensors with respect to the cartesian axes.
Requires the Atoms object to have been loaded from a .magres file
containing the relevant information.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always diagonalise the tensors even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ms\_quat (np.ndarray): list of quaternions
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.ms.MSQuaternion attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSQuaternion.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'ms\_quats'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.ms.MSQuaternion attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSQuaternion.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.ms.MSQuaternion static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSQuaternion.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{MSReducedAnisotropy (class in soprano.properties.nmr.ms)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSReducedAnisotropy}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.ms.}\sphinxbfcode{MSReducedAnisotropy}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing the magnetic shielding reduced anisotropies
in a system (ppm).
Requires the Atoms object to have been loaded from a .magres file
containing the relevant information.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always diagonalise the tensors even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ms\_list (np.ndarray): list of reduced anisotropies
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.ms.MSReducedAnisotropy attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSReducedAnisotropy.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'ms\_red\_anisotropy'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.ms.MSReducedAnisotropy attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSReducedAnisotropy.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.ms.MSReducedAnisotropy static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSReducedAnisotropy.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{MSSkew (class in soprano.properties.nmr.ms)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSSkew}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.ms.}\sphinxbfcode{MSSkew}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing the magnetic shielding tensor skew
in a system.
Requires the Atoms object to have been loaded from a .magres file
containing the relevant information.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always diagonalise the tensors even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ms\_list (np.ndarray): list of skews
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.ms.MSSkew attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSSkew.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'ms\_skew'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.ms.MSSkew attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSSkew.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.ms.MSSkew static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSSkew.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{MSSpan (class in soprano.properties.nmr.ms)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSSpan}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.nmr.ms.}\sphinxbfcode{MSSpan}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Produces an array containing the magnetic shielding tensor span
in a system (ppm).
Requires the Atoms object to have been loaded from a .magres file
containing the relevant information.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] force\_recalc (bool): if True, always diagonalise the tensors even if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] already present.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ms\_list (np.ndarray): list of spans
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.nmr.ms.MSSpan attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSSpan.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'ms\_span'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.nmr.ms.MSSpan attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSSpan.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'force\_recalc': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.nmr.ms.MSSpan static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.nmr.ms:soprano.properties.nmr.ms.MSSpan.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{*args}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}



\subparagraph{soprano.properties.nmr.utils module}
\label{doctree/soprano.properties.nmr.utils:soprano-properties-nmr-utils-module}\label{doctree/soprano.properties.nmr.utils:module-soprano.properties.nmr.utils}\label{doctree/soprano.properties.nmr.utils::doc}\index{soprano.properties.nmr.utils (module)}
Utility functions for NMR-related properties


\subparagraph{soprano.properties.order package}
\label{doctree/soprano.properties.order:module-soprano.properties.order}\label{doctree/soprano.properties.order:soprano-properties-order-package}\label{doctree/soprano.properties.order::doc}\index{soprano.properties.order (module)}
Module containing AtomProperties that pertain to bond order parameters, useful
to define local environment in term of invariants that can be compared across
systems.


\subparagraph{Submodules}
\label{doctree/soprano.properties.order:submodules}

\subparagraph{soprano.properties.order.order module}
\label{doctree/soprano.properties.order.order:module-soprano.properties.order.order}\label{doctree/soprano.properties.order.order::doc}\label{doctree/soprano.properties.order.order:soprano-properties-order-order-module}\index{soprano.properties.order.order (module)}
Implementation of AtomsProperties that relate to bond order parameters
\index{BondOrder (class in soprano.properties.order.order)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.order.order:soprano.properties.order.order.BondOrder}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.order.order.}\sphinxbfcode{BondOrder}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Computes the order parameters defined by Steinhardt et al. {[}PRB 28, 784
(1983){]} for an atom or group of atoms in the system. Here for each atom
all closest periodic copies of the others are used; a sigmoidal cutoff is
used to reduce the impact of those beyond a certain distance while keeping
the behaviour smooth upon small fluctuations.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] l\_channels (list{[}int{]}): list of angular momentum channels to be used
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] for the calculation. Must be integers \textgreater{}= 1.
\item[] Default is all channels 1 to 10.
\end{DUlineblock}
\item[] center\_atoms (AtomSelection): AtomSelection, integer index or list of
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] indices of all atoms around which the
\item[] bond order parameters are to be computed
\item[] and summed over. Default is None, which
\item[] means all atoms of the system.
\end{DUlineblock}
\item[] environment\_atoms (AtomSelection): AtomSelection, integer index or
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] list of indices of all atoms that
\item[] used as environment to compute the
\item[] bond order parameters. For each
\item[] `center' atom, all its links to
\item[] `environment' atoms other than
\item[] itself will be considered. Default
\item[] is None, which means all atoms of
\item[] the system.
\end{DUlineblock}
\item[] cutoff\_radius (float): radius at which to cut the smoothing sigmoid
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] function, in Angstroms. Default is 2.0.
\end{DUlineblock}
\item[] cutoff\_width (float): width parameter of the sigmoid, controlling the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] steepness with which it falls to zero, in 
\item[] Angstroms. Default is 0.05.
\end{DUlineblock}
\item[] compute\_W (bool): whether to also compute the W parameter (third
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] order) besides the Q (second order).
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] bond\_order\_pars (dict): dictionary containing arrays with Q and, if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] required, W for each l in l\_channels.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.order.order.BondOrder attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.order.order:soprano.properties.order.order.BondOrder.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'bond\_order'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.order.order.BondOrder attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.order.order:soprano.properties.order.order.BondOrder.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'cutoff\_width': 0.05, u'center\_atoms': None, u'l\_channels': array({[} 1,  2,  3,  4,  5,  6,  7,  8,  9, 10{]}), u'environment\_atoms': None, u'cutoff\_radius': 2.0, u'compute\_W': False\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.order.order.BondOrder static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.order.order:soprano.properties.order.order.BondOrder.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{l\_channels}, \emph{center\_atoms}, \emph{environment\_atoms}, \emph{cutoff\_radius}, \emph{cutoff\_width}, \emph{compute\_W}}{}
\end{fulllineitems}


\end{fulllineitems}



\subparagraph{soprano.properties.symmetry package}
\label{doctree/soprano.properties.symmetry::doc}\label{doctree/soprano.properties.symmetry:soprano-properties-symmetry-package}\label{doctree/soprano.properties.symmetry:module-soprano.properties.symmetry}\index{soprano.properties.symmetry (module)}
Module containing AtomProperties that pertain to symmetry detection.
Depends on having the Python bindings to SPGLIB installed on the system.


\subparagraph{Submodules}
\label{doctree/soprano.properties.symmetry:submodules}

\subparagraph{soprano.properties.symmetry.symmetry module}
\label{doctree/soprano.properties.symmetry.symmetry:module-soprano.properties.symmetry.symmetry}\label{doctree/soprano.properties.symmetry.symmetry::doc}\label{doctree/soprano.properties.symmetry.symmetry:soprano-properties-symmetry-symmetry-module}\index{soprano.properties.symmetry.symmetry (module)}
Implementation of AtomProperties that relate to symmetry
\index{SymmetryDataset (class in soprano.properties.symmetry.symmetry)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.symmetry.symmetry:soprano.properties.symmetry.symmetry.SymmetryDataset}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.symmetry.symmetry.}\sphinxbfcode{SymmetryDataset}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Extracts SPGLIB's standard symmetry dataset from a given system, including
spacegroup symbol, symmetry operations etc.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] symprec (float): distance tolerance, in Angstroms, applied when
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] searching symmetry.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] symm\_dataset (dict): dictionary of symmetry information
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.symmetry.symmetry.SymmetryDataset attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.symmetry.symmetry:soprano.properties.symmetry.symmetry.SymmetryDataset.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'symmetry\_dataset'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.symmetry.symmetry.SymmetryDataset attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.symmetry.symmetry:soprano.properties.symmetry.symmetry.SymmetryDataset.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'symprec': 1e-05\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.symmetry.symmetry.SymmetryDataset static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.symmetry.symmetry:soprano.properties.symmetry.symmetry.SymmetryDataset.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{symprec}}{}
\end{fulllineitems}


\end{fulllineitems}



\subparagraph{soprano.properties.transform package}
\label{doctree/soprano.properties.transform:soprano-properties-transform-package}\label{doctree/soprano.properties.transform::doc}\label{doctree/soprano.properties.transform:module-soprano.properties.transform}\index{soprano.properties.transform (module)}
Module containing  a special set of AtomsProperties that transform an Atoms
object into another (by translating, rotating or mirroring all or some ions,
and so on). These all accept an Atoms object and some parameters and return
an Atoms object as well. Default behaviour for the .get method in most cases
will be to do nothing at all, these properties are meant to be instantiated.


\subparagraph{Submodules}
\label{doctree/soprano.properties.transform:submodules}

\subparagraph{soprano.properties.transform.transform module}
\label{doctree/soprano.properties.transform.transform:soprano-properties-transform-transform-module}\label{doctree/soprano.properties.transform.transform::doc}\label{doctree/soprano.properties.transform.transform:module-soprano.properties.transform.transform}\index{soprano.properties.transform.transform (module)}
Implementation of AtomsProperties that transform the instance in some
way
\index{Mirror (class in soprano.properties.transform.transform)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.transform.transform:soprano.properties.transform.transform.Mirror}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.transform.transform.}\sphinxbfcode{Mirror}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Returns an Atoms object with some or all the atoms reflected with either a
given center or a given plane. Absolute or scaled coordinates may be used.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] selection (AtomSelection): selection object defining which atoms to
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] act on. By default, all of them.
\end{DUlineblock}
\item[] center ({[}float{]}*3): center around which the reflection should take
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] place. By default the origin of the axes. Can't be
\item[] present at the same time as plane.
\end{DUlineblock}
\item[] plane ({[}float{]}*4): plane with respect to which the reflection should
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] take place, in the form {[}a, b, c, d{]} parameters of
\item[] the plane equation.
\item[] By default is not used. Can't be present at the
\item[] same time as center.
\end{DUlineblock}
\item[] scaled (bool): if True, treat the input vector as expressed in scaled,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] not absolute, coordinates.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] reflected (ase.Atoms): Atoms object with the reflection performed.
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.transform.transform.Mirror attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.transform.transform:soprano.properties.transform.transform.Mirror.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'reflected'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.transform.transform.Mirror attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.transform.transform:soprano.properties.transform.transform.Mirror.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'scaled': False, u'selection': None, u'center': None, u'plane': None\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.transform.transform.Mirror static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.transform.transform:soprano.properties.transform.transform.Mirror.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{selection}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{Regularise (class in soprano.properties.transform.transform)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.transform.transform:soprano.properties.transform.transform.Regularise}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.transform.transform.}\sphinxbfcode{Regularise}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Regularize

Perform a translation by a vector calculated to cancel out the effect of
global translational symmetry. In theory, given two copies of the same
system that only differ by a translation of all atoms in the unit cell,
this should produce two systems that overlap perfectly. Can be used to
compare slightly different systems if they're similar enough. If a
selection is given, only those atoms will be used to calculate the center,
but the translation will still be applied to all atoms. The same atoms
have to be used in all systems for comparisons to make sense (for example
one might use all the heavy atoms and not include hydrogens).

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] selection (AtomSelection): selection object defining which atoms to
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] act on. By default, all of them.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] regularised (ase.Atoms): Atoms object translated by the regularizing
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] vector.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.transform.transform.Regularise attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.transform.transform:soprano.properties.transform.transform.Regularise.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'regularised'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.transform.transform.Regularise attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.transform.transform:soprano.properties.transform.transform.Regularise.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'selection': None\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.transform.transform.Regularise static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.transform.transform:soprano.properties.transform.transform.Regularise.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{selection}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{Rotate (class in soprano.properties.transform.transform)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.transform.transform:soprano.properties.transform.transform.Rotate}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.transform.transform.}\sphinxbfcode{Rotate}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Returns an Atoms object with some or all the atoms rotated by a given
quaternion and with a given center. Absolute or scaled coordinates may be
used.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] selection (AtomSelection): selection object defining which atoms to
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] act on. By default, all of them.
\end{DUlineblock}
\item[] center ({[}float{]}*3): center around which the rotation should take
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] place. By default the origin of the axes.
\end{DUlineblock}
\item[] quaternion (ase.quaternions.Quaternion): quaternion expressing the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] rotation that should be
\item[] applied.
\end{DUlineblock}
\item[] scaled (bool): if True, treat the input vector as expressed in scaled,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] not absolute, coordinates.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] rotated (ase.Atoms): Atoms object with the rotation performed.
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.transform.transform.Rotate attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.transform.transform:soprano.properties.transform.transform.Rotate.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'rotated'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.transform.transform.Rotate attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.transform.transform:soprano.properties.transform.transform.Rotate.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'scaled': False, u'quaternion': None, u'selection': None, u'center': {[}0, 0, 0{]}\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.transform.transform.Rotate static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.transform.transform:soprano.properties.transform.transform.Rotate.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{selection}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}

\index{Translate (class in soprano.properties.transform.transform)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.transform.transform:soprano.properties.transform.transform.Translate}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.transform.transform.}\sphinxbfcode{Translate}}{\emph{name=None}, \emph{**params}}{}
Bases: {\hyperref[doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty]{\sphinxcrossref{\sphinxcode{soprano.properties.atomsproperty.AtomsProperty}}}}

Returns an Atoms object with some or all the atoms translated by a given
vector. Absolute or scaled coordinates may be used.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] selection (AtomSelection): selection object defining which atoms to
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] act on. By default, all of them.
\end{DUlineblock}
\item[] vector ({[}float{]}*3): vector by which to translate the atoms.
\item[] scaled (bool): if True, treat the input vector as expressed in scaled,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] not absolute, coordinates.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] translated (ase.Atoms): Atoms object with the translation performed.
\end{DUlineblock}
\end{DUlineblock}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.transform.transform.Translate attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.transform.transform:soprano.properties.transform.transform.Translate.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'translated'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.transform.transform.Translate attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.transform.transform:soprano.properties.transform.transform.Translate.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{u'vector': {[}0, 0, 0{]}, u'scaled': False, u'selection': None\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.transform.transform.Translate static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.transform.transform:soprano.properties.transform.transform.Translate.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{selection}, \emph{**kwargs}}{}
\end{fulllineitems}


\end{fulllineitems}



\paragraph{Submodules}
\label{doctree/soprano.properties:submodules}

\subparagraph{soprano.properties.atomsproperty module}
\label{doctree/soprano.properties.atomsproperty:module-soprano.properties.atomsproperty}\label{doctree/soprano.properties.atomsproperty:soprano-properties-atomsproperty-module}\label{doctree/soprano.properties.atomsproperty::doc}\index{soprano.properties.atomsproperty (module)}
Definition of AtomsProperty class.

A generic template class that specific Properties will inherit from.
\index{AtomsProperty (class in soprano.properties.atomsproperty)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.properties.atomsproperty.}\sphinxbfcode{AtomsProperty}}{\emph{name=None}, \emph{**params}}{}
Bases: \sphinxcode{object}

Initialize an AtomsProperty and set its parameters.
The AtomsProperty instance can then be called with a structure as its
only argument to get the property with the given parameters.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): a name to give to this specific instance of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property (will be used to store it as array if
\item[] requested)
\end{DUlineblock}
\item[] params: named arguments specific to this type of property
\end{DUlineblock}
\end{DUlineblock}
\index{default\_name (soprano.properties.atomsproperty.AtomsProperty attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty.default_name}\pysigline{\sphinxbfcode{default\_name}\sphinxstrong{ = u'generic\_property'}}
\end{fulllineitems}

\index{default\_params (soprano.properties.atomsproperty.AtomsProperty attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty.default_params}\pysigline{\sphinxbfcode{default\_params}\sphinxstrong{ = \{\}}}
\end{fulllineitems}

\index{extract() (soprano.properties.atomsproperty.AtomsProperty static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty.extract}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{extract}}{\emph{s}, \emph{**params}}{}
Extract the given property with given parameters from an Atoms
object.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] s (ase.Atoms): the structure from which to extract the property
\item[] params: named arguments specific to this type of property
\item[] 
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property: the value of the property for the given structure and
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] parameters
\item[] 
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{get() (soprano.properties.atomsproperty.AtomsProperty class method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.properties.atomsproperty:soprano.properties.atomsproperty.AtomsProperty.get}\pysiglinewithargsret{\sphinxstrong{classmethod }\sphinxbfcode{get}}{\emph{s}, \emph{store\_array=False}}{}
Extract the given property using the default parameters
on an Atoms object s

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] s (ase.Atoms or AtomsCollection): the structure or collection
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] from which to extract the
\item[] property
\end{DUlineblock}
\item[] store\_array (bool): if s is a collection, whether to store the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] resulting data as an array in the collection
\item[] using the default name for this property
\item[] 
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] property: the value of the property for the given structure or
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] a list of values if a collection has been passed
\item[] 
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}


\end{fulllineitems}



\subsection{Submodules}
\label{doctree/soprano:submodules}

\subsubsection{soprano.measure module}
\label{doctree/soprano.measure:soprano-measure-module}\label{doctree/soprano.measure::doc}\label{doctree/soprano.measure:module-soprano.measure}\index{soprano.measure (module)}
measure.py

Contains utility functions for measuring distances and other quantities at
the level of a single ase.Atoms object.
\index{bondDistance() (in module soprano.measure)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.measure:soprano.measure.bondDistance}\pysiglinewithargsret{\sphinxcode{soprano.measure.}\sphinxbfcode{bondDistance}}{\emph{s}, \emph{i}, \emph{j}, \emph{bond\_matrix=None}}{}
Return the distance in number of bonds between two atoms. Returns -1 if
the two atoms are not connected. Requires NetworkX to be installed to
work.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] s (ase.Atoms): the structure on which to compute the distance
\item[] i (int): index of the first atom
\item[] j (int): index of the second atom
\item[] bond\_matrix (np.ndarray): pre-computed bond matrix to use. If not
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] provided, will be calculated with default
\item[] parameters
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] r (int): computed bond distance
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{euclideanDistance() (in module soprano.measure)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.measure:soprano.measure.euclideanDistance}\pysiglinewithargsret{\sphinxcode{soprano.measure.}\sphinxbfcode{euclideanDistance}}{\emph{s}, \emph{i}, \emph{j}, \emph{periodic=True}}{}
Return the distance between two atoms, in Angstroms.

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] s (ase.Atoms): the structure on which to compute the distance
\item[] i (int): index of the first atom
\item[] j (int): index of the second atom
\item[] periodic (bool): whether to account for periodic boundaries when 
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] computing the distance; default is True
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] r (float): computed distance
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}



\subsubsection{soprano.optional module}
\label{doctree/soprano.optional:module-soprano.optional}\label{doctree/soprano.optional::doc}\label{doctree/soprano.optional:soprano-optional-module}\index{soprano.optional (module)}
optional.py

Contains imports for libraries considered optional, and decorators to include
checks for them.
\index{requireNetworkX() (in module soprano.optional)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.optional:soprano.optional.requireNetworkX}\pysiglinewithargsret{\sphinxcode{soprano.optional.}\sphinxbfcode{requireNetworkX}}{\emph{import\_name=u'networkx'}}{}
\end{fulllineitems}

\index{requireScikitLearn() (in module soprano.optional)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.optional:soprano.optional.requireScikitLearn}\pysiglinewithargsret{\sphinxcode{soprano.optional.}\sphinxbfcode{requireScikitLearn}}{\emph{import\_name=u'sklearn'}}{}
\end{fulllineitems}

\index{requireSpglib() (in module soprano.optional)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.optional:soprano.optional.requireSpglib}\pysiglinewithargsret{\sphinxcode{soprano.optional.}\sphinxbfcode{requireSpglib}}{\emph{import\_name=u'spglib'}}{}
\end{fulllineitems}



\subsubsection{soprano.selection module}
\label{doctree/soprano.selection:module-soprano.selection}\label{doctree/soprano.selection::doc}\label{doctree/soprano.selection:soprano-selection-module}\index{soprano.selection (module)}
selection.py

Contains the definition of an AtomSelection class,
namely a group of selected atoms for a given structure,
and methods to build it.
\index{AtomSelection (class in soprano.selection)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.selection:soprano.selection.AtomSelection}\pysiglinewithargsret{\sphinxstrong{class }\sphinxcode{soprano.selection.}\sphinxbfcode{AtomSelection}}{\emph{atoms}, \emph{sel\_indices}, \emph{authenticate=True}}{}
Bases: \sphinxcode{object}

AtomSelection object.

An AtomSelection represents a group of atoms from an ASE Atoms object.
It keeps track of them and can be used to perform operations on them
(for example geometrical transformation or extraction of specific
properties).
It does not keep track of the original Atoms object it's been created
from, but can be ``authenticated'' to verify that it is indeed operating
consistently on the same structure. It also provides a series of static
methods to build selections with various criteria.

Initialize the AtomSelection.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] atoms (ase.Atoms): the atoms object on which the selection is
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] applied
\end{DUlineblock}
\item[] sel\_indices (list{[}int{]}): the list of indices of the atoms that
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] are to be selected
\end{DUlineblock}
\item[] authenticate (Optional{[}bool{]}): whether to use hashing to confirm
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] the identity of the atoms object
\item[] we're operating with
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}
\index{all() (soprano.selection.AtomSelection static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.selection:soprano.selection.AtomSelection.all}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{all}}{\emph{atoms}}{}
Generate a selection for the given Atoms object of all atoms.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] atoms (ase.Atoms): Atoms object on which to perform selection
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] selection (AtomSelection)
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{from\_box() (soprano.selection.AtomSelection static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.selection:soprano.selection.AtomSelection.from_box}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{from\_box}}{\emph{atoms}, \emph{abc0}, \emph{abc1}, \emph{periodic=False}, \emph{scaled=False}}{}
Generate a selection for the given Atoms object of all atoms within
a given box volume.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] atoms (ase.Atoms): Atoms object on which to perform selection
\item[] abc0 ({[}float, float, float{]}): bottom corner of box
\item[] abc1 ({[}float, float, float{]}): top corner of box
\item[] periodic (Optional{[}bool{]}): if True, include periodic copies of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] atoms
\end{DUlineblock}
\item[] scaled (Optional{[}bool{]}): if True, consider scaled (fractional)
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] coordinates instead of absolute ones
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] selection (AtomSelection)
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{from\_element() (soprano.selection.AtomSelection static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.selection:soprano.selection.AtomSelection.from_element}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{from\_element}}{\emph{atoms}, \emph{element}}{}
Generate a selection for the given Atoms object of all atoms of a
specific element.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] atoms (ase.Atoms): Atoms object on which to perform selection
\item[] element (str): symbol of the element to select
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] selection (AtomSelection)
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{from\_sphere() (soprano.selection.AtomSelection static method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.selection:soprano.selection.AtomSelection.from_sphere}\pysiglinewithargsret{\sphinxstrong{static }\sphinxbfcode{from\_sphere}}{\emph{atoms}, \emph{center}, \emph{r}, \emph{periodic=False}, \emph{scaled=False}}{}
Generate a selection for the given Atoms object of all atoms within
a given spherical volume.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] atoms (ase.Atoms): Atoms object on which to perform selection
\item[] center ({[}float, float, float{]}): center of the sphere
\item[] r (float): radius of the sphere
\item[] periodic (Optional{[}bool{]}): if True, include periodic copies of the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] atoms
\end{DUlineblock}
\item[] scaled (Optional{[}bool{]}): if True, consider scaled (fractional)
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] coordinates instead of absolute ones
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] selection (AtomSelection)
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{get\_array() (soprano.selection.AtomSelection method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.selection:soprano.selection.AtomSelection.get_array}\pysiglinewithargsret{\sphinxbfcode{get\_array}}{\emph{name}}{}
Retrieve a previously stored data array.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): name of the array to be set or created
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] array (np.ndarray): array of data to be saved
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{indices (soprano.selection.AtomSelection attribute)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.selection:soprano.selection.AtomSelection.indices}\pysigline{\sphinxbfcode{indices}}
\end{fulllineitems}

\index{set\_array() (soprano.selection.AtomSelection method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.selection:soprano.selection.AtomSelection.set_array}\pysiglinewithargsret{\sphinxbfcode{set\_array}}{\emph{name}, \emph{array}}{}
Save an array of given name containing arbitraty information
tied to the selected atoms.
This must match the length of the selection and will be passed on to
any Atoms objects created with .subset.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] name (str): name of the array to be set or created
\item[] array (np.ndarray): array of data to be saved
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{subset() (soprano.selection.AtomSelection method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.selection:soprano.selection.AtomSelection.subset}\pysiglinewithargsret{\sphinxbfcode{subset}}{\emph{atoms}}{}
Generate an Atoms object containing only the selected atoms.

\end{fulllineitems}

\index{validate() (soprano.selection.AtomSelection method)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.selection:soprano.selection.AtomSelection.validate}\pysiglinewithargsret{\sphinxbfcode{validate}}{\emph{atoms}}{}
Check that the given Atoms object validates with this selection.

\end{fulllineitems}


\end{fulllineitems}



\subsubsection{soprano.utils module}
\label{doctree/soprano.utils:soprano-utils-module}\label{doctree/soprano.utils:module-soprano.utils}\label{doctree/soprano.utils::doc}\index{soprano.utils (module)}
utils.py

Contains package-wide useful routines that don't fall under any specific
category. Many of these handle common operations involving periodicity,
conversions between different representations etc.
\index{abc2cart() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.abc2cart}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{abc2cart}}{\emph{abc}}{}
Transforms an axes and angles representation of lattice parameters
into a Cartesian one

\end{fulllineitems}

\index{all\_periodic() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.all_periodic}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{all\_periodic}}{\emph{v}, \emph{latt\_cart}, \emph{max\_r}}{}
Find all the periodic equivalent vectors for a list of vectors and a
given lattice falling within a given length.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] v (np.ndarray): list of 3-vectors representing points or vectors to
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] produce periodic versions of
\end{DUlineblock}
\item[] latt\_cart (np.ndarray): unit cell in cartesian form
\item[] max\_r (float): maximum length of periodic copies of vectors
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] v\_period (np.ndarray): array with the same shape as v, containing the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] vectors in periodic reduced form
\end{DUlineblock}
\item[] v\_index (np.ndarray): indices (referring to the original array v) of
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] the array of which the corresponding element of
\item[] v\_period is a copy
\end{DUlineblock}
\item[] v\_cells (np.ndarray): array of triples of ints, corresponding to the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] cells from which the various periodic copies of
\item[] the vectors were taken. For an unchanged vector
\item[] will be all {[}0,0,0{]}
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{cart2abc() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.cart2abc}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{cart2abc}}{\emph{cart}}{}
Transforms a Cartesian representation of lattice parameters
into an axes and angles one

\end{fulllineitems}

\index{clebsch\_gordan() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.clebsch_gordan}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{clebsch\_gordan}}{\emph{j}, \emph{m}, \emph{j1}, \emph{m1}, \emph{j2}, \emph{m2}}{}
Clebsch-Gordan cohefficients for given quantum numbers:
j, m, j1, m1, j2, m2

The numbers passed can be arrays (just make sure they're the
same size).

\end{fulllineitems}

\index{hkl2d2\_matgen() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.hkl2d2_matgen}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{hkl2d2\_matgen}}{\emph{abc}}{}
Generate a matrix that turns hkl indices into inverse crystal
plane distances for a given lattice in ABC form

\end{fulllineitems}

\index{import\_module() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.import_module}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{import\_module}}{\emph{mpath}}{}
\end{fulllineitems}

\index{inspect\_args() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.inspect_args}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{inspect\_args}}{\emph{f}}{}
\end{fulllineitems}

\index{inv\_plane\_dist() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.inv_plane_dist}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{inv\_plane\_dist}}{\emph{hkl}, \emph{hkl2d2}}{}
Calculate inverse planar distance for a given set of
Miller indices h, k, l.

\end{fulllineitems}

\index{is\_string() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.is_string}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{is\_string}}{\emph{s}}{}
Checks whether s is a string, with Python 2 and 3 compatibility

\end{fulllineitems}

\index{list\_distance() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.list_distance}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{list\_distance}}{\emph{l1}, \emph{l2}}{}
Return an integer distance between two lists (number of differing
elements)

\end{fulllineitems}

\index{max\_distance\_in\_cell() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.max_distance_in_cell}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{max\_distance\_in\_cell}}{\emph{cell}}{}
Maximum distance between two points achievable inside a single unit 
cell.
Relies on the fact that the isosurface for equal distance in cartesian
space is an ellipsoid, meaning that the extreme has to be one of the 8
corners of the cube of side 1 in fractional space.

\end{fulllineitems}

\index{minimum\_periodic() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.minimum_periodic}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{minimum\_periodic}}{\emph{v}, \emph{latt\_cart}, \emph{exclude\_self=False}}{}
Find the shortest periodic equivalent vector for a list of vectors and a
given lattice.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] v (np.ndarray): list of 3-vectors representing points or vectors to
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] reduce to their closest periodic version
\end{DUlineblock}
\item[] latt\_cart (np.ndarray): unit cell in cartesian form
\item[] exclude\_self (bool): if True, any vector that is equal to zero will be
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] excluded, and its closest non-zero periodic
\item[] version will be considered instead. Default is
\item[] False
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] v\_period (np.ndarray): array with the same shape as v, containing the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] vectors in periodic reduced form
\end{DUlineblock}
\item[] v\_cells (np.ndarray): array of triples of ints, corresponding to the
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] cells from which the various periodic copies of
\item[] the vectors were taken. For an unchanged vector
\item[] will be all {[}0,0,0{]}
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{minimum\_supcell() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.minimum_supcell}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{minimum\_supcell}}{\emph{max\_r, latt\_cart=None, r\_matrix=None, pbc={[}True, True, True{]}}}{}
Generate the bounds for a supercell containing a sphere
of given radius, knowing the unit cell.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] max\_r (float): radius of the sphere contained in the supercell
\item[] latt\_cart (np.ndarray): unit cell in cartesian form
\item[] r\_matrix (np.ndarray): matrix for the quadratic form returning
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] r\textasciicircum{}2 for this supercell.
\item[] Alternative to latt\_cart, for a direct
\item[] space cell would be equal to
\item[] np.dot(latt\_cart, latt\_cart.T)
\end{DUlineblock}
\item[] pbc ({[}bool, bool, bool{]}): periodic boundary conditions - if
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] a boundary is not periodic the
\item[] range returned will always be zero
\item[] in that dimension
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] shape (tuple{[}int{]}):  shape of the supercell to be built.
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Raises:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ValueError: if some of the arguments are invalid
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{periodic\_bridson() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.periodic_bridson}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{periodic\_bridson}}{\emph{cell}, \emph{rmin}, \emph{max\_attempts=30}, \emph{prepoints=None}, \emph{prepoints\_cuts=None}}{}
Periodic version of the Bridson algorithm for generation of Poisson
sphere distributions of points. This returns a generator.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] cell (np.ndarray): periodic cell in which to create the points.
\item[] rmin (float): minimum distance between each generated point.
\item[] max\_attempts (int): maximum number of candidate neighbours generated
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] for each point.
\end{DUlineblock}
\item[] prepoints (np.ndarray or list): pre-existing points to avoid during
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] generation. These must be in
\item[] fractional coordinates.
\end{DUlineblock}
\item[] prepoints\_cuts (np.ndarray or list): custom cutoffs for each prepoint.
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] If not included defaults to rmin.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] bridsonGen (generator): an iterator producing Poisson-sphere like
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] distributed points in cell until space runs
\item[] out or enough attempts fail.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{periodic\_center() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.periodic_center}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{periodic\_center}}{\emph{v\_frac}}{}
Alright, how does this work?
Basically, we're looking for the point, inside the unit cell, which
minimizes the sum of the squared distance from all ions.
Of course we need to consider the periodic boundaries. So the distance
on a single axis isn't simply abs(x), but a triangular wave.
Fun times! A triangular wave can be represented as a Fourier series. And
we can truncate that series to the first term because the minimum
basically stays the same and get:
sum((x-x\_i)**2) \textasciitilde{} sum((4/pi**2*sin(2*pi*(x-x\_i-1/4))+0.5)**2)
All the factors depend on the fact that we need to move the triangular
wave to the interval {[}0,1{]} and center it so that it's 0 for x-x\_i == 0.
It gets better! We take the derivative of this thing and look for a spot
where it becomes zero. The derivative is kind of a trigonometric
monstrosity but we can solve the equation by setting t = e\textasciicircum{}(2*pi*1.0j*x)
and then replacing cosines and sines with it. As a result, we get an
equation of 4th degree in t. And then we solve that with numpy.roots, take
the phase, turn that into a coordinate, find the one corresponding to the
absolute minimum.
All of which we can perform independently on each of the three axes
because the function is just the sum of the three components:
sum((r-r\_i)**2) = sum((x-x\_i)**2) + sum((y-y\_i)**2) + sum((z-z\_i)**2).
And there you go! Problem solved.

\end{fulllineitems}

\index{progbar() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.progbar}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{progbar}}{\emph{i}, \emph{i\_max}, \emph{bar\_len=20}, \emph{spinner=True}, \emph{spin\_rate=3.0}}{}
A textual progress bar for the command line

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] i (int): current progress index
\item[] max\_i (int): final progress index
\item[] bar\_len (Optional{[}int{]}): length in characters of the bar (no brackets)
\item[] spinner (Optional{[}bool{]}): show a spinner at the end
\item[] spin\_rate (Optional{[}float{]}): spinner rotation speed (turns per full
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] progress)
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] bar (str): a progress bar formatted as requested
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{rep\_alg() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.rep_alg}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{rep\_alg}}{\emph{v}, \emph{iters=1000}, \emph{attempts=10}, \emph{step=0.1}, \emph{simtol=1e-05}}{}
Repulsion algorithm, begins with a series of vectors v, finds a new one
that is as far as possible, angle-wise, from all of them.
The process is that of treating the tips of the vectors as particles on a
sphere which repel each other. Of course, it's possible that multiple
equilibrium positions exist, which is why multiple attempts can be made,
and are judged identical or not base on a tolerance parameter

\begin{DUlineblock}{0em}
\item[] Parameters:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] v (np.ndarray): list of fixed vectors to avoid
\item[] iters (int): number of iterations, default is 1000
\item[] attempts (int): number of independent attempts with randomised starts,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] default is 10
\end{DUlineblock}
\item[] step (float): step by which the `particle' describing the vector will
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] be displaced at each iteration during the search.
\item[] Default is 1e-1.
\end{DUlineblock}
\item[] simtol (float): tolerance based on which two attempts are considered to
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] be effectively the same, checking if 1-v1.v2 \textless{} simtol.
\item[] Default is 1e-5.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] out\_v ({[}np.ndarray{]}): list of unit vectors of maximal distance from
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] the ones in v
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{replace\_folder() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.replace_folder}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{replace\_folder}}{\emph{path}, \emph{new\_folder}}{}
Replace the folder of the given path with a new one

\end{fulllineitems}

\index{safe\_communicate() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.safe_communicate}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{safe\_communicate}}{\emph{subproc}, \emph{stdin=u'`}}{}
Executes a Popen.communicate and returns output in a way that is
compatible with Python 2 \& 3 keeping input and output as strings (since
Python 3 requires bytes objects otherwise)

\end{fulllineitems}

\index{seedname() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.seedname}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{seedname}}{\emph{path}}{}
Get the filename (with no extension) from a full path

\end{fulllineitems}

\index{silence\_stdio() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.silence_stdio}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{silence\_stdio}}{\emph{*args}, \emph{**kwds}}{}
Useful stdout/err silencer

\end{fulllineitems}

\index{supcell\_gridgen() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.supcell_gridgen}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{supcell\_gridgen}}{\emph{latt\_cart}, \emph{shape}}{}
Generate a full linearized grid for a supercell with r\_bounds
and a base unit cell in Cartesian form.

\begin{DUlineblock}{0em}
\item[] Args:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] latt\_cart (np.ndarray): unit cell in cartesian form
\item[] shape (tuple{[}int{]}):  shape of the supercell to be built,
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] as returned by minimum\_supcell.
\end{DUlineblock}
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Returns:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] neigh\_i\_grid (np.ndarray): supercell grid in fractional coordinates
\item[] neigh\_grid (np.ndarray): supercell grid in cartesian coordinates
\end{DUlineblock}
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Raises:
\item[]
\begin{DUlineblock}{\DUlineblockindent}
\item[] ValueError: if some of the arguments are invalid
\end{DUlineblock}
\end{DUlineblock}

\end{fulllineitems}

\index{swing\_twist\_decomp() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.swing_twist_decomp}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{swing\_twist\_decomp}}{\emph{quat}, \emph{axis}}{}
Perform a Swing*Twist decomposition of a Quaternion. This splits the
quaternion in two: one containing the rotation around axis (Twist), the
other containing the rotation around a vector parallel to axis (Swing).

Returns two quaternions: Swing, Twist.

\end{fulllineitems}

\index{wigner\_3j() (in module soprano.utils)}

\begin{fulllineitems}
\phantomsection\label{doctree/soprano.utils:soprano.utils.wigner_3j}\pysiglinewithargsret{\sphinxcode{soprano.utils.}\sphinxbfcode{wigner\_3j}}{\emph{j1}, \emph{m1}, \emph{j2}, \emph{m2}, \emph{j3}, \emph{m3}}{}
Wigner 3j symbols for given quantum numbers:

/                     \textbar{} j1    j2     j3 \textbar{}
\textbar{} m1    m2     m3 \textbar{}
                /

The numbers passed can be arrays (just make sure they're the
same size).

\end{fulllineitems}

\phantomsection\label{index:module-soprano}\index{soprano (module)}
Soprano 0.7.1

A Python library to crack crystals
by Simone Sturniolo

Copyright (C) 2016 - Science and Technology Facility Council

Soprano is free software: you can redistribute it and/or modify
it under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

Soprano is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public License
along with this program.  If not, see \textless{}\url{http://www.gnu.org/licenses/}\textgreater{}.


\chapter{Indices and tables}
\label{index:indices-and-tables}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}


\renewcommand{\indexname}{Python Module Index}
\begin{theindex}
\def\bigletter#1{{\Large\sffamily#1}\nopagebreak\vspace{1mm}}
\bigletter{s}
\item {\texttt{soprano}}, \pageref{doctree/soprano:module-soprano}
\item {\texttt{soprano.analyse}}, \pageref{doctree/soprano.analyse:module-soprano.analyse}
\item {\texttt{soprano.analyse.phylogen}}, \pageref{doctree/soprano.analyse.phylogen:module-soprano.analyse.phylogen}
\item {\texttt{soprano.analyse.phylogen.genes}}, \pageref{doctree/soprano.analyse.phylogen.genes:module-soprano.analyse.phylogen.genes}
\item {\texttt{soprano.analyse.phylogen.mapping}}, \pageref{doctree/soprano.analyse.phylogen.mapping:module-soprano.analyse.phylogen.mapping}
\item {\texttt{soprano.analyse.phylogen.phylogenclust}}, \pageref{doctree/soprano.analyse.phylogen.phylogenclust:module-soprano.analyse.phylogen.phylogenclust}
\item {\texttt{soprano.calculate}}, \pageref{doctree/soprano.calculate:module-soprano.calculate}
\item {\texttt{soprano.calculate.gulp}}, \pageref{doctree/soprano.calculate.gulp:module-soprano.calculate.gulp}
\item {\texttt{soprano.calculate.gulp.charges}}, \pageref{doctree/soprano.calculate.gulp.charges:module-soprano.calculate.gulp.charges}
\item {\texttt{soprano.calculate.gulp.w99}}, \pageref{doctree/soprano.calculate.gulp.w99:module-soprano.calculate.gulp.w99}
\item {\texttt{soprano.calculate.nmr}}, \pageref{doctree/soprano.calculate.nmr:module-soprano.calculate.nmr}
\item {\texttt{soprano.calculate.nmr.nmr}}, \pageref{doctree/soprano.calculate.nmr.nmr:module-soprano.calculate.nmr.nmr}
\item {\texttt{soprano.calculate.nmr.powder}}, \pageref{doctree/soprano.calculate.nmr.powder:module-soprano.calculate.nmr.powder}
\item {\texttt{soprano.calculate.nmr.simpson}}, \pageref{doctree/soprano.calculate.nmr.simpson:module-soprano.calculate.nmr.simpson}
\item {\texttt{soprano.calculate.xrd}}, \pageref{doctree/soprano.calculate.xrd:module-soprano.calculate.xrd}
\item {\texttt{soprano.calculate.xrd.sel\_rules}}, \pageref{doctree/soprano.calculate.xrd.sel_rules:module-soprano.calculate.xrd.sel_rules}
\item {\texttt{soprano.calculate.xrd.xrd}}, \pageref{doctree/soprano.calculate.xrd.xrd:module-soprano.calculate.xrd.xrd}
\item {\texttt{soprano.collection}}, \pageref{doctree/soprano.collection:module-soprano.collection}
\item {\texttt{soprano.collection.collection}}, \pageref{doctree/soprano.collection.collection:module-soprano.collection.collection}
\item {\texttt{soprano.collection.generate}}, \pageref{doctree/soprano.collection.generate:module-soprano.collection.generate}
\item {\texttt{soprano.collection.generate.airss}}, \pageref{doctree/soprano.collection.generate.airss:module-soprano.collection.generate.airss}
\item {\texttt{soprano.collection.generate.defect}}, \pageref{doctree/soprano.collection.generate.defect:module-soprano.collection.generate.defect}
\item {\texttt{soprano.collection.generate.linspace}}, \pageref{doctree/soprano.collection.generate.linspace:module-soprano.collection.generate.linspace}
\item {\texttt{soprano.collection.generate.rattle}}, \pageref{doctree/soprano.collection.generate.rattle:module-soprano.collection.generate.rattle}
\item {\texttt{soprano.collection.generate.transform}}, \pageref{doctree/soprano.collection.generate.transform:module-soprano.collection.generate.transform}
\item {\texttt{soprano.hpc}}, \pageref{doctree/soprano.hpc:module-soprano.hpc}
\item {\texttt{soprano.hpc.submitter}}, \pageref{doctree/soprano.hpc.submitter:module-soprano.hpc.submitter}
\item {\texttt{soprano.hpc.submitter.castep}}, \pageref{doctree/soprano.hpc.submitter.castep:module-soprano.hpc.submitter.castep}
\item {\texttt{soprano.hpc.submitter.debug}}, \pageref{doctree/soprano.hpc.submitter.debug:module-soprano.hpc.submitter.debug}
\item {\texttt{soprano.hpc.submitter.debug.debugqueue}}, \pageref{doctree/soprano.hpc.submitter.debug.debugqueue:module-soprano.hpc.submitter.debug.debugqueue}
\item {\texttt{soprano.hpc.submitter.queues}}, \pageref{doctree/soprano.hpc.submitter.queues:module-soprano.hpc.submitter.queues}
\item {\texttt{soprano.hpc.submitter.submit}}, \pageref{doctree/soprano.hpc.submitter.submit:module-soprano.hpc.submitter.submit}
\item {\texttt{soprano.hpc.submitter.utils}}, \pageref{doctree/soprano.hpc.submitter.utils:module-soprano.hpc.submitter.utils}
\item {\texttt{soprano.measure}}, \pageref{doctree/soprano.measure:module-soprano.measure}
\item {\texttt{soprano.optional}}, \pageref{doctree/soprano.optional:module-soprano.optional}
\item {\texttt{soprano.properties}}, \pageref{doctree/soprano.properties:module-soprano.properties}
\item {\texttt{soprano.properties.atomsproperty}}, \pageref{doctree/soprano.properties.atomsproperty:module-soprano.properties.atomsproperty}
\item {\texttt{soprano.properties.basic}}, \pageref{doctree/soprano.properties.basic:module-soprano.properties.basic}
\item {\texttt{soprano.properties.basic.basic}}, \pageref{doctree/soprano.properties.basic.basic:module-soprano.properties.basic.basic}
\item {\texttt{soprano.properties.castep}}, \pageref{doctree/soprano.properties.castep:module-soprano.properties.castep}
\item {\texttt{soprano.properties.castep.castep}}, \pageref{doctree/soprano.properties.castep.castep:module-soprano.properties.castep.castep}
\item {\texttt{soprano.properties.labeling}}, \pageref{doctree/soprano.properties.labeling:module-soprano.properties.labeling}
\item {\texttt{soprano.properties.labeling.labeling}}, \pageref{doctree/soprano.properties.labeling.labeling:module-soprano.properties.labeling.labeling}
\item {\texttt{soprano.properties.linkage}}, \pageref{doctree/soprano.properties.linkage:module-soprano.properties.linkage}
\item {\texttt{soprano.properties.linkage.linkage}}, \pageref{doctree/soprano.properties.linkage.linkage:module-soprano.properties.linkage.linkage}
\item {\texttt{soprano.properties.nmr}}, \pageref{doctree/soprano.properties.nmr:module-soprano.properties.nmr}
\item {\texttt{soprano.properties.nmr.dipolar}}, \pageref{doctree/soprano.properties.nmr.dipolar:module-soprano.properties.nmr.dipolar}
\item {\texttt{soprano.properties.nmr.efg}}, \pageref{doctree/soprano.properties.nmr.efg:module-soprano.properties.nmr.efg}
\item {\texttt{soprano.properties.nmr.ms}}, \pageref{doctree/soprano.properties.nmr.ms:module-soprano.properties.nmr.ms}
\item {\texttt{soprano.properties.nmr.utils}}, \pageref{doctree/soprano.properties.nmr.utils:module-soprano.properties.nmr.utils}
\item {\texttt{soprano.properties.order}}, \pageref{doctree/soprano.properties.order:module-soprano.properties.order}
\item {\texttt{soprano.properties.order.order}}, \pageref{doctree/soprano.properties.order.order:module-soprano.properties.order.order}
\item {\texttt{soprano.properties.symmetry}}, \pageref{doctree/soprano.properties.symmetry:module-soprano.properties.symmetry}
\item {\texttt{soprano.properties.symmetry.symmetry}}, \pageref{doctree/soprano.properties.symmetry.symmetry:module-soprano.properties.symmetry.symmetry}
\item {\texttt{soprano.properties.transform}}, \pageref{doctree/soprano.properties.transform:module-soprano.properties.transform}
\item {\texttt{soprano.properties.transform.transform}}, \pageref{doctree/soprano.properties.transform.transform:module-soprano.properties.transform.transform}
\item {\texttt{soprano.selection}}, \pageref{doctree/soprano.selection:module-soprano.selection}
\item {\texttt{soprano.utils}}, \pageref{doctree/soprano.utils:module-soprano.utils}
\end{theindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}
